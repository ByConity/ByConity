Migrated from internal with modification.