FROM debian:11.9-slim
RUN apt-get update && apt-get install -y gcc g++ cppcheck libfuse2 git cmake ninja-build openssh-client libmsgpack-dev libevent-dev libidn11-dev libaprutil1-dev libapr1-dev libp11-kit-dev swig libicu-dev zlib1g-dev ccache libbz2-dev unzip python-dev openssh-server libunwind8-dev libssl-dev libsnappy-dev zlib1g gzip adduser apt base-files base-passwd bash binfmt-support binutils binutils-common:amd64 binutils-x86-64-linux-gnu bsdutils bzip2 ca-certificates cmake-data coreutils dash debconf debian-archive-keyring debianutils diffutils dpkg e2fsprogs file findutils gcc-10-base:amd64 gpgv grep hostname init-system-helpers less lib32gcc-s1 lib32stdc++6 libacl1:amd64 libapt-pkg6.0:amd64 libarchive13:amd64 libasan6:amd64 libatomic1:amd64 libattr1:amd64 libaudit-common libaudit1:amd64 libbinutils:amd64 libblkid1:amd64 libbrotli1:amd64 libbsd0:amd64 libbz2-1.0:amd64 libc-bin libc-dev-bin libc6-dev:amd64 libc6-i386 libc6:amd64 libcap-ng0:amd64 libcom-err2:amd64 libcrypt-dev:amd64 libcrypt1:amd64 libctf-nobfd0:amd64 libctf0:amd64 libcurl3-gnutls:amd64 libcurl4:amd64 libdb5.3:amd64 libdebconfclient0:amd64 libdeflate0:amd64 libedit2:amd64 liberror-perl libexpat1:amd64 libext2fs2:amd64 libffi-dev:amd64 libffi7:amd64 libfreetype6:amd64 libfuse2:amd64 libgc1:amd64 libgcc-10-dev:amd64 libgcc-s1:amd64 libgcrypt20:amd64 libgdbm-compat4:amd64 libgdbm6:amd64 libgmp10:amd64 libgnutls30:amd64 libgomp1:amd64 libgpg-error0:amd64 libgpm2:amd64 libgssapi-krb5-2:amd64 libhogweed6:amd64 libicu67:amd64 libidn2-0:amd64 libitm1:amd64 libjbig0:amd64 libjpeg62-turbo:amd64 libjsoncpp24:amd64 libk5crypto3:amd64 libkeyutils1:amd64 libkrb5-3:amd64 libkrb5support0:amd64 libldap-2.4-2:amd64 libldap-common liblsan0:amd64 liblz4-1:amd64 liblzma5:amd64 libmagic-mgc libmagic1:amd64 libmd0:amd64 libmount1:amd64 libmpdec3:amd64 libncurses-dev:amd64 libncurses6:amd64 libncursesw6:amd64 libnettle8:amd64 libnghttp2-14:amd64 libnsl-dev:amd64 libnsl2:amd64 libobjc-10-dev:amd64 libobjc4:amd64 libp11-kit0:amd64 libpam-modules-bin libpam-modules:amd64 libpam-runtime libpam0g:amd64 libpcre2-8-0:amd64 libpcre3:amd64 libperl5.32:amd64 libpfm4:amd64 libpipeline1:amd64 libpng16-16:amd64 libprocps8:amd64 libpsl5:amd64 libpython3-stdlib:amd64 libpython3.9-minimal:amd64 libpython3.9-stdlib:amd64 libquadmath0:amd64 libreadline8:amd64 librhash0:amd64 librtmp1:amd64 libsasl2-2:amd64 libsasl2-modules-db:amd64 libsasl2-modules:amd64 libseccomp2:amd64 libselinux1:amd64 libsemanage-common libsemanage1:amd64 libsepol1:amd64 libsmartcols1:amd64 libsqlite3-0:amd64 libss2:amd64 libssh2-1:amd64 libssl1.1:amd64 libstdc++-10-dev:amd64 libstdc++6:amd64 libsystemd0:amd64 libtasn1-6:amd64 libtiff5:amd64 libtinfo6:amd64 libtinyxml2-8:amd64 libtirpc-common libtirpc-dev:amd64 libtirpc3:amd64 libtsan0:amd64 libubsan1:amd64 libudev1:amd64 libunistring2:amd64 libuuid1:amd64 libuv1:amd64 libwebp6:amd64 libx11-6:amd64 libx11-data libxau6:amd64 libxcb1:amd64 libxdmcp6:amd64 libxml2:amd64 libxpm4:amd64 libxxhash0:amd64 libyaml-0-2:amd64 libz3-4:amd64 libz3-dev:amd64 libzstd1:amd64 linux-libc-dev:amd64 login logsave lsb-base mailcap make mawk media-types mime-support mount ncurses-base ncurses-bin netbase openssl passwd patch perl perl-base perl-modules-5.32 procps psmisc python3 python3-minimal python3-pkg-resources python3-pygments python3-yaml python3.9 python3.9-minimal readline-common sed sysvinit-utils tar tzdata util-linux xz-utils zlib1g:amd64 default-jre default-jdk wget curl moreutils pip gnupg autoconf automake m4 bison flex
WORKDIR /home
RUN apt-get install -y clang-16 llvm-16 lld-16 && ln -s /usr/bin/lld-16 /usr/bin/lld && ln -s /usr/bin/clang-16 /usr/bin/clang && ln -s /usr/bin/clang++-16 /usr/bin/clang++
COPY foundationdb-clients_7.1.27-1_amd64.deb ./
RUN dpkg -i foundationdb-clients_7.1.27-1_amd64.deb
COPY build.sh /
CMD ["/bin/bash", "/build.sh"]
