1.test projection rewrite
Projection Est. ? rows
│     Expressions: [sum(k)], divide(sum(salary), 100):=`sum(salary)` / 100, plus(deptno, 1):=deptno + 1
└─ Gather Exchange Est. ? rows
   └─ TableScan mv_data Est. ? rows
            Outputs: [deptno, sum(k), sum(salary)]
note: Materialized Views is applied for 1 times: mv_data.
11	285	300
21	80	100
1.2 test duplicate names
Projection est. ? rows
│     Expressions: [deptno], commission:=`sum(commission)`, salary:=`sum(salary)`
└─ Gather Exchange est. ? rows
   └─ Projection est. ? rows
      │     Expressions: [deptno, sum(commission), sum(salary)]
      └─ TableScan test.mv_data est. ? rows
               Outputs: [deptno, sum(commission), sum(salary)]
note: Materialized Views is applied for 1 times: test.mv_data.
2-1. test filter rewrite
Projection Est. ? rows
│     Expressions: [name], x:=empid
└─ Gather Exchange Est. ? rows
   └─ Filter Est. ? rows
      │     Condition: deptno = 10
      └─ TableScan mv_data Est. ? rows
               Outputs: [deptno, empid, name]
note: Materialized Views is applied for 1 times: mv_data.
100	Bill
110	Theodore
150	Sebastian
2-2. test filter rewrite
Projection Est. ? rows
│     Expressions: [name], x:=empid
└─ Gather Exchange Est. ? rows
   └─ Filter Est. ? rows
      │     Condition: empid > 120
      └─ TableScan mv_data Est. ? rows
               Outputs: [empid, name]
note: Materialized Views is applied for 1 times: mv_data.
150	Sebastian
200	Eric
3. test rollup aggregate rewrite
Projection Est. ? rows
│     Expressions: c:=`sum()(c)` + 1, deptno:=deptno_2
└─ Gather Exchange Est. ? rows
   └─ MergingAggregated Est. ? rows
      └─ Repartition Exchange Est. ? rows
         │     Partition by: {deptno_2}
         └─ Aggregating Est. ? rows
            │     Group by: {deptno_2}
            │     Aggregates: sum()(c):=sum(c)
            └─ Projection Est. ? rows
               │     Expressions: [c], deptno_2:=deptno
               └─ TableScan mv_data Est. ? rows
                        Outputs: [c, deptno]
note: Materialized Views is applied for 1 times: mv_data.
4	10
2	20
4. test rollup aggregate rewrite
Projection Est. ? rows
│     Expressions: c:=`countMerge()(c)`, deptno:=deptno_2
└─ Gather Exchange Est. ? rows
   └─ MergingAggregated Est. ? rows
      └─ Repartition Exchange Est. ? rows
         │     Partition by: {deptno_2}
         └─ Aggregating Est. ? rows
            │     Group by: {deptno_2}
            │     Aggregates: countMerge()(c):=countMerge(c)
            └─ Projection Est. ? rows
               │     Expressions: [c], deptno_2:=deptno
               └─ TableScan mv_data Est. ? rows
                        Outputs: [c, deptno]
note: Materialized Views is applied for 1 times: mv_data.
3	10
1	20
5-2. test rollup aggregate rewrite with filter
Projection Est. ? rows
│     Expressions: [a, c, deptno, empid]
└─ Gather Exchange Est. ? rows
   └─ Filter Est. ? rows
      │     Condition: empid = 150
      └─ TableScan mv_data Est. ? rows
               Outputs: [a, c, deptno, empid]
note: Materialized Views is applied for 1 times: mv_data.
1	7000	150	10
