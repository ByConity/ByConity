CREATE DATABASE IF NOT EXISTS aeolus_data_db_aeolus_bp_edu_202007;
DROP TABLE IF EXISTS aeolus_data_db_aeolus_bp_edu_202007.aeolus_data_table_56294_prod;
CREATE TABLE aeolus_data_db_aeolus_bp_edu_202007.aeolus_data_table_56294_prod (`row_id_kmtq3k` Int64 ,`p_date` Date ,`hour` String ,`order_id` Nullable(Int64) ,`parent_order_id` Nullable(Int64) ,`user_id` Nullable(Int64) ,`xiaoban_id` Nullable(Int64) ,`banke_id` Nullable(Int64) ,`banke_name` Nullable(String) ,`subject` Nullable(Int32) ,`subject_name` Nullable(String) ,`grade` Nullable(String) ,`grade_name` Nullable(String) ,`segment` Nullable(String) ,`years` Nullable(Int32) ,`term` Nullable(Int32) ,`term_name` Nullable(String) ,`batch` Nullable(Int32) ,`category` Nullable(Int32) ,`category_name` Nullable(String) ,`banke_start_time` Nullable(String) ,`banke_end_time` Nullable(String) ,`banke_cycle_name` Nullable(String) ,`banke_teach_time` Nullable(String) ,`banke_abbr` Nullable(String) ,`tutor_emp_id` Nullable(Int64) ,`tutor_teacher_id` Nullable(Int64) ,`tutor_name` Nullable(String) ,`lector_emp_id` Nullable(Int64) ,`lector_teacher_id` Nullable(Int64) ,`lector_name` Nullable(String) ,`is_hujing_add_wechat` Nullable(Int32) ,`hujing_add_time` Nullable(String) ,`is_hujing_enhance_add_wechat` Nullable(Int32) ,`is_manual_add_wechat` Nullable(Int32) ,`manual_add_time` Nullable(String) ,`is_activation` Nullable(Int32) ,`activation_time` Nullable(String) ,`is_submit_survey` Nullable(Int32) ,`survey_submit_time` Nullable(String) ,`express_count` Nullable(Int64) ,`express_success_count` Nullable(Int64) ,`call_success_ucnt` Nullable(Int64) ,`leader_id` Nullable(Int64) ,`leader_name` Nullable(String) ,`group_id` Nullable(String) ,`group_name` Nullable(String) ,`base_id` Nullable(String) ,`base_name` Nullable(String) ,`date` Nullable(String) ,`hour[dm_dali_dwm_operation_tutor_by_order_hf]` Nullable(String) ,`is_first_tutor_term` Nullable(Int32) ,`banxing_name` Nullable(String) ,`banxing_id` Nullable(Int64) ,`pay_amount` Nullable(Int32) ,`lector_teacher_id_list` Nullable(String) ,`lector_emp_id_list` Nullable(String) ,`lector_name_list` Nullable(String) ,`subject_name_list` Nullable(String) ,`subject_list` Nullable(String) ,`assign_name` Nullable(String) ,`assign_id` Nullable(Int64) ,`section_id` Nullable(String) ,`section_name` Nullable(String) ,`branch_id` Nullable(String) ,`branch_name` Nullable(String) ,`aladdin_teaching_status` Nullable(String) ,`start_is_has_light` Nullable(String) ,`end_is_has_light` Nullable(String) ) ENGINE = CnchMergeTree() PARTITION BY (p_date,hour) ORDER BY (`row_id_kmtq3k`,intHash64(`row_id_kmtq3k`)) SAMPLE BY intHash64(`row_id_kmtq3k`);
INSERT INTO aeolus_data_db_aeolus_bp_edu_202007.aeolus_data_table_56294_prod FORMAT CSV INFILE '/data01/xinghe.shangguan/cnch-sql-cases/tools/certificate_builder/certificate_aeolus_bp_edu/tables_info/aeolus_data_db_aeolus_bp_edu_202007.aeolus_data_table_56294_prod.csv' SETTINGS input_format_skip_unknown_fields = 1, skip_nullinput_notnull_col = 1;
