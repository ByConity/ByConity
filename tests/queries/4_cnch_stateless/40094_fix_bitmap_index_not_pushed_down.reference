Projection Est. 1000 rows, cost 1.507500e+02
│     Expressions: _1700031876736:=`expr#count()`, _1700031897102:=`expr#CAST(avg(multiIf(greaterOrEquals(mapElement(model_label, \'staytime\'), 30000), 1, 0)), \'Nullable(Float64)\')`, _1700046658469:=`expr#if(arraySetCheck(vids, \'8683112\'), \'8683112\', if(arraySetCheck(vids, \'8683113\'), \'8683113\', \'other\'))`, _1700047638968:=`expr#CAST(avg(multiIf(greaterOrEquals(mapElement(model_label, \'staytime\'), 60000), 1, 0)), \'Nullable(Float64)\')`, _avg_1700031876697_4700826bc6c9c490e9a7756937dd1f6e:=`expr#avg(mapElement(model_label, \'staytime\'))`, _countdistinct_1700031876715:=`expr#uniqExact(uid)`, _sum_1700046657800:=`expr#sum(multiIf(greater(arrayElement(label, 31), 0), 1, 0))`, _sum_1700046657811:=`expr#sum(multiIf(greaterOrEquals(arrayElement(label, 1), 1), 1, 0))`, _sum_1700046657910:=`expr#sum(arrayElement(label, 32))`
└─ Projection Est. 1000 rows, cost 7.675000e+01
   │     Expressions: [expr#avg(mapElement(model_label, \'staytime\')), expr#count(), expr#if(arraySetCheck(vids, \'8683112\'), \'8683112\', if(arraySetCheck(vids, \'8683113\'), \'8683113\', \'other\')), expr#sum(arrayElement(label, 32)), expr#sum(multiIf(greater(arrayElement(label, 31), 0), 1, 0)), expr#sum(multiIf(greaterOrEquals(arrayElement(label, 1), 1), 1, 0)), expr#uniqExact(uid)], expr#CAST(avg(multiIf(greaterOrEquals(mapElement(model_label, \'staytime\'), 30000), 1, 0)), \'Nullable(Float64)\'):=CAST(`expr#avg(multiIf(greaterOrEquals(mapElement(model_label, \'staytime\'), 30000), 1, 0))`, \'Nullable(Float64)\'), expr#CAST(avg(multiIf(greaterOrEquals(mapElement(model_label, \'staytime\'), 60000), 1, 0)), \'Nullable(Float64)\'):=CAST(`expr#avg(multiIf(greaterOrEquals(mapElement(model_label, \'staytime\'), 60000), 1, 0))`, \'Nullable(Float64)\')
   └─ Limit Est. 1000 rows, cost 2.750000e+00
      │     Limit: 1000
      └─ Gather Exchange Est. 1000 rows, cost 2.750000e+00
         └─ Limit Est. 1000 rows, cost 2.750000e+00
            │     Limit: 1000
            └─ MergingAggregated Est. ? rows, cost 2.750000e+00
               └─ Repartition Exchange Est. ? rows, cost 2.750000e+00
                  │     Partition by: {expr#if(arraySetCheck(vids, \'8683112\'), \'8683112\', if(arraySetCheck(vids, \'8683113\'), \'8683113\', \'other\'))}
                  └─ Aggregating Est. ? rows, cost 1.250000e+00
                     │     Group by: {expr#if(arraySetCheck(vids, \'8683112\'), \'8683112\', if(arraySetCheck(vids, \'8683113\'), \'8683113\', \'other\'))}
                     │     Aggregates: expr#sum(multiIf(greater(arrayElement(label, 31), 0), 1, 0)):=AggNull(anyIf)(expr#sum(multiIf(greater(arrayElement(label, 31), 0), 1, 0)),group_id_mask), expr#sum(arrayElement(label, 32)):=AggNull(anyIf)(expr#sum(arrayElement(label, 32)),group_id_mask), expr#sum(multiIf(greaterOrEquals(arrayElement(label, 1), 1), 1, 0)):=AggNull(anyIf)(expr#sum(multiIf(greaterOrEquals(arrayElement(label, 1), 1), 1, 0)),group_id_mask), expr#count():=AggNull(anyIf)(expr#count(),group_id_mask), expr#uniqExact(uid):=AggNull(countIf)(uid,group_id_mask_1), expr#avg(mapElement(model_label, \'staytime\')):=AggNull(anyIf)(expr#avg(mapElement(model_label, \'staytime\')),group_id_mask), expr#avg(multiIf(greaterOrEquals(mapElement(model_label, \'staytime\'), 30000), 1, 0)):=AggNull(anyIf)(expr#avg(multiIf(greaterOrEquals(mapElement(model_label, \'staytime\'), 30000), 1, 0)),group_id_mask), expr#avg(multiIf(greaterOrEquals(mapElement(model_label, \'staytime\'), 60000), 1, 0)):=AggNull(anyIf)(expr#avg(multiIf(greaterOrEquals(mapElement(model_label, \'staytime\'), 60000), 1, 0)),group_id_mask)
                     └─ Projection Est. ? rows, cost 1.250000e+00
                        │     Expressions: [expr#avg(mapElement(model_label, \'staytime\')), expr#avg(multiIf(greaterOrEquals(mapElement(model_label, \'staytime\'), 30000), 1, 0)), expr#avg(multiIf(greaterOrEquals(mapElement(model_label, \'staytime\'), 60000), 1, 0)), expr#count(), expr#if(arraySetCheck(vids, \'8683112\'), \'8683112\', if(arraySetCheck(vids, \'8683113\'), \'8683113\', \'other\')), expr#sum(arrayElement(label, 32)), expr#sum(multiIf(greater(arrayElement(label, 31), 0), 1, 0)), expr#sum(multiIf(greaterOrEquals(arrayElement(label, 1), 1), 1, 0)), uid], group_id_mask:=group_id = 0, group_id_mask_1:=group_id = 1
                        └─ MergingAggregated Est. ? rows, cost 1.250000e+00
                           └─ Repartition Exchange Est. ? rows, cost 1.250000e+00
                              │     Partition by: {expr#if(arraySetCheck(vids, \'8683112\'), \'8683112\', if(arraySetCheck(vids, \'8683113\'), \'8683113\', \'other\')), group_id, uid}
                              └─ Aggregating Est. ? rows, cost 0.000000e+00
                                 │     Group by: {expr#if(arraySetCheck(vids, \'8683112\'), \'8683112\', if(arraySetCheck(vids, \'8683113\'), \'8683113\', \'other\')), group_id, uid}
                                 │     Aggregates: expr#sum(multiIf(greater(arrayElement(label, 31), 0), 1, 0)):=AggNull(sum)(expr#multiIf(greater(arrayElement(label, 31), 0), 1, 0)), expr#sum(arrayElement(label, 32)):=AggNull(sum)(expr#arrayElement(label, 32)), expr#sum(multiIf(greaterOrEquals(arrayElement(label, 1), 1), 1, 0)):=AggNull(sum)(expr#multiIf(greaterOrEquals(arrayElement(label, 1), 1), 1, 0)), expr#count():=AggNull(count)(), expr#avg(mapElement(model_label, \'staytime\')):=AggNull(avg)(__model_label__\'staytime\'), expr#avg(multiIf(greaterOrEquals(mapElement(model_label, \'staytime\'), 30000), 1, 0)):=AggNull(avg)(expr#multiIf(greaterOrEquals(mapElement(model_label, \'staytime\'), 30000), 1, 0)), expr#avg(multiIf(greaterOrEquals(mapElement(model_label, \'staytime\'), 60000), 1, 0)):=AggNull(avg)(expr#multiIf(greaterOrEquals(mapElement(model_label, \'staytime\'), 60000), 1, 0))
                                 └─ Expand Est. ? rows, cost 0.000000e+00
                                    └─ Projection Est. ? rows, cost 0.000000e+00
                                       │     Expressions: [__model_label__\'staytime\', uid], expr#arrayElement(label, 32):=label[32], expr#if(arraySetCheck(vids, \'8683112\'), \'8683112\', if(arraySetCheck(vids, \'8683113\'), \'8683113\', \'other\')):=if(`arraySetCheck(vids, \'8683112\')`, \'8683112\', if(`arraySetCheck(vids, \'8683113\')`, \'8683113\', \'other\')), expr#multiIf(greater(arrayElement(label, 31), 0), 1, 0):=multiIf((label[31]) > 0, 1, 0), expr#multiIf(greaterOrEquals(arrayElement(label, 1), 1), 1, 0):=multiIf((label[1]) >= 1, 1, 0), expr#multiIf(greaterOrEquals(mapElement(model_label, \'staytime\'), 30000), 1, 0):=multiIf(`__model_label__\'staytime\'` >= 30000, 1, 0), expr#multiIf(greaterOrEquals(mapElement(model_label, \'staytime\'), 60000), 1, 0):=multiIf(`__model_label__\'staytime\'` >= 60000, 1, 0)
                                       └─ Filter Est. ? rows, cost 0.000000e+00
                                          │     Condition: `expr#arrayJoin(assumeNotNull(split(mapElement(string_params, \'g_recall_reasons\'), \',\')))` = \'aaebvr\'
                                          └─ Projection Est. ? rows, cost 0.000000e+00
                                             │     Expressions: [__model_label__\'staytime\', arraySetCheck(vids, \'8683112\'), arraySetCheck(vids, \'8683113\'), label, uid], expr#arrayJoin(assumeNotNull(split(mapElement(string_params, \'g_recall_reasons\'), \',\'))):=arrayJoin(assumeNotNull(split(`__string_params__\'g_recall_reasons\'`, \',\')))
                                             └─ Filter Est. ? rows, cost 0.000000e+00
                                                │     Condition: (if(`arraySetCheck(vids, \'8683112\')`, \'8683112\', if(`arraySetCheck(vids, \'8683113\')`, \'8683113\', \'other\')) IN (\'8683112\', \'8683113\')) AND (toDateTime(req_time) >= cast(1712869200, \'DateTime\')) AND (toDateTime(req_time) <= cast(1712905199, \'DateTime\')) AND (app_id = \'13\') AND (`__string_params__\'chnid\'` = \'94349560412\') AND (toDate(req_time) = cast(19825, \'Date\'))
                                                └─ TableScan test.t40094_bitmap_index Est. ? rows, cost 0.000000e+00
                                                         Where: (toDateTime(req_time) >= cast(1712869200, \'DateTime\')) AND (toDateTime(req_time) <= cast(1712905199, \'DateTime\')) AND (app_id = \'13\') AND (`__string_params__\'chnid\'` = \'94349560412\') AND (toDate(req_time) = cast(19825, \'Date\'))
                                                         Inline expressions: [arraySetCheck(vids, \'8683112\'):=arraySetCheck(vids, \'8683112\'), arraySetCheck(vids, \'8683113\'):=arraySetCheck(vids, \'8683113\')]
                                                         Outputs: [req_time, uid, app_id, __model_label__\'staytime\', label, __string_params__\'g_recall_reasons\', __string_params__\'chnid\']
