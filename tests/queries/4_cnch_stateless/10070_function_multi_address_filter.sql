DROP TABLE IF EXISTS test_geo;

CREATE TABLE test_geo
(
    `lat` Float64,
    `lng` Float64
) ENGINE = CnchMergeTree() ORDER BY (lng, lat);

INSERT INTO test_geo values (27.792, 114.423);
INSERT INTO test_geo values (31.331, 121.438);
INSERT INTO test_geo values (27.992, 114.423);

SELECT count()
FROM test_geo
WHERE multiAddressFilter(lng, lat, 10000., 121.43816, 31.331795, 121.43514, 31.3313, 121.43514, 31.3313, 121.48925, 31.36923, 121.37214, 31.304865, 121.35593, 31.342611, 121.36656, 31.343304, 121.413704, 31.277784, 121.37939, 31.320835, 121.37828, 31.320465, 121.416855, 31.275894, 121.42935, 31.340282, 121.37373, 31.31642, 121.43515, 31.335121, 121.43515, 31.335121, 121.43515, 31.335121, 121.42491, 31.330359, 121.46938, 31.32282, 121.42792, 31.33075, 121.39792, 31.291466, 121.3494, 31.31851, 121.39768, 31.327576, 121.39767, 31.331053, 121.43078, 31.330173, 121.37441, 31.310963, 121.408875, 31.28083, 121.34909, 31.405277, 121.40263, 31.289183, 121.49802, 31.345123, 121.39896, 31.289522, 121.47651, 31.339855, 121.42949, 31.372677, 121.48986, 31.334856, 121.4921, 31.335382, 121.472084, 31.40668, 121.390656, 31.306492, 121.47789, 31.32898, 121.49087, 31.339235, 121.4763, 31.325846, 121.34732, 31.405, 121.42437, 31.33372, 121.427315, 31.333887, 121.40465, 31.292652, 121.40465, 31.292652, 121.40465, 31.292652, 121.49885, 31.399855, 121.48636, 31.312473, 121.23957, 31.349768, 121.26655, 31.359303, 121.17721, 31.267237, 121.36577, 31.255178, 121.274055, 31.334593, 121.274055, 31.334593, 121.35693, 31.24411, 121.342735, 31.266657, 121.348206, 31.265944, 121.34813, 31.26588, 121.23734, 31.348452, 121.34396, 31.260738);

DROP TABLE IF EXISTS test_geo;

