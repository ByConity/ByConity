SELECT ADDTIME(DATE '2022-01-01','01:01:01');
SELECT ADDTIME(TIME '01:02:03', '04:05:06');
SELECT ADDTIME(DATETIME '2022-01-01 01:02:03', '04:05:06');
SELECT ADDTIME(TIMESTAMP '2022-01-01 01:02:03', '04:05:06');
SELECT ADDTIME(TIME '23:59:59', '00:00:01');
SELECT ADDTIME('2022-01-01'::DATE32,'01:01:01');
SELECT ADDTIME('2022-01-01 01:02:03'::DATETIME64, '04:05:06');

-- fractional
SELECT ADDTIME(DATE '2022-01-01','01:01:01.123');
SELECT ADDTIME(DATE '2022-01-01','01:01:01.12'::TIME(2));
SELECT ADDTIME(DATE '2022-01-01','01:01:01.123456789'::TIME(9));
SELECT ADDTIME(DATE32 '2022-01-01','01:01:01.123');
SELECT ADDTIME(DATE32 '2022-01-01','01:01:01.12'::TIME(2));
SELECT ADDTIME(DATE32 '2022-01-01','01:01:01.123456789'::TIME(9));
SELECT ADDTIME(DATETIME '2022-01-01 10:23:13','01:01:01.123');
SELECT ADDTIME(DATETIME '2022-01-01 10:23:13','01:01:01.12'::TIME(2));
SELECT ADDTIME(DATETIME '2022-01-01 10:23:13','01:01:01.123456789'::TIME(9));
SELECT ADDTIME('2022-01-01 10:23:13.12'::DATETIME64(2),'01:01:01.123');
SELECT ADDTIME('2022-01-01 10:23:13.123456789'::DATETIME64(9),'01:01:01.12'::TIME(2));
SELECT ADDTIME('2022-01-01 10:23:13'::DATETIME64(),'01:01:01.123456789'::TIME(9));

-- overflow
SELECT ADDTIME(DATETIME '2022-12-31 23:02:03', '04:05:06');
SELECT ADDTIME(TIME '23:02:03', '04:05:06');
SELECT ADDTIME('2022-01-01 10:23:13.9'::DATETIME64(),'01:01:01.123456789'::TIME(9));
SELECT ADDTIME('2022-01-01 10:23:13.999999999'::DATETIME64(9),'01:01:01.999999999'::TIME(9));


SELECT SUBTIME(DATE '2022-01-01','01:01:01');
SELECT SUBTIME(TIME '01:02:03', '04:05:06');
SELECT SUBTIME(DATETIME '2022-01-01 01:02:03', '04:05:06');
SELECT SUBTIME(TIMESTAMP '2022-01-01 01:02:03', '04:05:06');
SELECT SUBTIME(TIME '23:59:59', '00:00:01');
SELECT SUBTIME('2022-01-01'::DATE32,'01:01:01');
SELECT SUBTIME('2022-01-01 01:02:03'::DATETIME64, '04:05:06');

-- fractional
SELECT SUBTIME(DATE '2022-01-01','01:01:01.123');
SELECT SUBTIME(DATE '2022-01-01','01:01:01.12'::TIME(2));
SELECT SUBTIME(DATE '2022-01-01','01:01:01.123456789'::TIME(9));
SELECT SUBTIME(DATE32 '2022-01-01','01:01:01.123');
SELECT SUBTIME(DATE32 '2022-01-01','01:01:01.12'::TIME(2));
SELECT SUBTIME(DATE32 '2022-01-01','01:01:01.123456789'::TIME(9));
SELECT SUBTIME(DATETIME '2022-01-01 10:23:13','01:01:01.123');
SELECT SUBTIME(DATETIME '2022-01-01 10:23:13','01:01:01.12'::TIME(2));
SELECT SUBTIME(DATETIME '2022-01-01 10:23:13','01:01:01.123456789'::TIME(9));
SELECT SUBTIME('2022-01-01 10:23:13.12'::DATETIME64(2),'01:01:01.123');
SELECT SUBTIME('2022-01-01 10:23:13.123456789'::DATETIME64(9),'01:01:01.12'::TIME(2));
SELECT SUBTIME('2022-01-01 10:23:13'::DATETIME64(),'01:01:01.123456789'::TIME(9));

-- overflow
SELECT SUBTIME(DATETIME '2022-12-31 23:02:03', '04:05:06');
SELECT SUBTIME(TIME '23:02:03', '04:05:06');
SELECT SUBTIME('2022-01-01 10:23:13.9'::DATETIME64(),'01:01:01.123456789'::TIME(9));
SELECT SUBTIME('2022-01-01 10:23:13.999999999'::DATETIME64(9),'01:01:01.999999999'::TIME(9));

SELECT ADDTIME(DATE '2022-12-31', '24:00:00'); -- { serverError 6 }
SELECT ADDTIME(DATE '2022-01-01', '25:00:00'); -- { serverError 6 }
SELECT SUBTIME(DATE '2022-12-31', '24:00:00');  -- { serverError 6 }
SELECT SUBTIME(DATE '2022-01-01', '25:00:00');  -- { serverError 6 }

DROP TABLE IF EXISTS time_table;
CREATE TABLE time_table
(
    val1 UInt64, 
    val2 TIME,
    val3 DATE,
    val4 DATETIME
) ENGINE=CnchMergeTree() ORDER BY val1;

INSERT INTO time_table VALUES(0, '01:02:03', '2022-01-01', '2022-01-01 00:00:00');
INSERT INTO time_table VALUES(1, '23:02:03', '2022-01-01', '2022-12-31 23:00:00');
INSERT INTO time_table VALUES(2, '23:02:03', '2022-01-01', '2022-01-01 00:00:00');
SELECT val1, ADDTIME(val2, val2), ADDTIME(val3, val2), ADDTIME(val4, val2) FROM time_table ORDER BY val1 ASC;
SELECT val1, SUBTIME(val2, val2), SUBTIME(val3, val2), SUBTIME(val4, val2) FROM time_table ORDER BY val1 ASC;
DROP TABLE time_table;


