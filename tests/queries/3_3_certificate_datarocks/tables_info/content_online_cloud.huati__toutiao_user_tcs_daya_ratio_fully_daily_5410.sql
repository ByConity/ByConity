CREATE DATABASE IF NOT EXISTS content_online_cloud;
DROP TABLE IF EXISTS content_online_cloud.huati__toutiao_user_tcs_daya_ratio_fully_daily_5410;
CREATE TABLE IF NOT EXISTS content_online_cloud.huati__toutiao_user_tcs_daya_ratio_fully_daily_5410 (`wenda_chushen_daya_ratio_2` Nullable(Float64), `short_video_chushen_daya_ratio_2` Nullable(Float64), `chushen_cnt` Nullable(Int64), `weitoutiao_fawen_cnt` Nullable(Int64), `wenda_chushen_daya_ratio_1` Nullable(Float64), `weitoutiao_fushen_daya_cnt` Nullable(Int64), `wenda_chushen_cnt` Nullable(Int64), `uid` Int64, `tuwen_chushen_cnt` Nullable(Int64), `short_video_fushen_daya_ratio_2` Nullable(Float64), `fushen_daya_cnt` Nullable(Int64), `author_user_id` Nullable(Int64), `author_user_id_2` Nullable(Int64), `tuwen_fushen_daya_cnt` Nullable(Int64), `short_video_chushen_cnt` Nullable(Int64), `short_video_fushen_daya_ratio_1` Nullable(Float64), `chushen_daya_ratio_1` Nullable(Float64), `video_grade` Nullable(Int64), `ugc_grade` Nullable(Int64), `author_global_quality` Nullable(String), `tuwen_fushen_cnt` Nullable(Int64), `short_video_chushen_daya_ratio_1` Nullable(Float64), `chushen_daya_cnt` Nullable(Int64), `short_video_fawen_cnt` Nullable(Int64), `short_video_chushen_daya_cnt` Nullable(Int64), `weitoutiao_fushen_daya_ratio_2` Nullable(Float64), `chushen_jinshen_ratio` Nullable(Float64), `xigua_grade` Nullable(Int64), `pgc_grade` Nullable(Int64), `tuwen_fushen_daya_ratio_1` Nullable(Float64), `tuwen_chushen_daya_ratio_2` Float64, `wenda_chushen_daya_cnt` Nullable(Int64), `wenda_fushen_daya_ratio_1` Nullable(Float64), `tuwen_chushen_daya_cnt` Nullable(Int64), `tuwen_chushen_daya_ratio_1` Nullable(Float64), `weitoutiao_chushen_cnt` Nullable(Int64), `wenda_fushen_daya_cnt` Nullable(Int64), `weitoutiao_fushen_daya_ratio_1` Nullable(Float64), `wenda_fawen_cnt` Nullable(Int64), `chushen_daya_ratio_2` Nullable(Float64), `fushen_jinshen_ratio` Nullable(Float64), `fushen_daya_ratio_2` Nullable(Float64), `author_user_id_1` Nullable(Int64), `tuwen_fawen_cnt` Nullable(Int64), `wenda_chushen_shanchu_ratio` Nullable(Float64), `zhanghao_type` Nullable(String), `weitoutiao_chushen_daya_ratio_2` Nullable(Float64), `fushen_cnt` Nullable(Int64), `weitoutiao_chushen_daya_ratio_1` Nullable(Float64), `wenda_fushen_cnt` Nullable(Int64), `wenda_fushen_daya_ratio_2` Nullable(Float64), `short_video_fushen_daya_cnt` Nullable(Int64), `author_user_id_4` Nullable(Int64), `weitoutiao_chushen_shanchu_ratio` Nullable(Float64), `short_video_chushen_shanchu_ratio` Nullable(Float64), `yuanchuang_type` Nullable(String), `tuwen_fushen_daya_ratio_2` Nullable(Float64), `tuwen_chushen_shanchu_ratio` Nullable(Float64), `hybrid_grade` Nullable(Int64), `author_user_id_3` Nullable(Int64), `renzheng_type` Nullable(String), `weitoutiao_chushen_daya_cnt` Nullable(Int64), `short_video_fushen_cnt` Nullable(Int64), `fawen_cnt` Nullable(Int64), `fushen_daya_ratio_1` Nullable(Float64), `ban_status` Nullable(Int32), `wenda_grade` Nullable(Int64), `weitoutiao_fushen_cnt` Nullable(Int64), `p_date` Date) ENGINE = CnchMergeTree() PARTITION BY p_date ORDER BY (uid, tuwen_chushen_daya_ratio_2, intHash64(uid)) SAMPLE BY intHash64(uid) SETTINGS index_granularity = 8192;
INSERT INTO content_online_cloud.huati__toutiao_user_tcs_daya_ratio_fully_daily_5410 FORMAT CSV INFILE '/data01/jiaxiang.yu/cnch-sql-cases/tools/certificate_builder/certificate_datarocks/tables_info/content_online_cloud.huati__toutiao_user_tcs_daya_ratio_fully_daily_5410.csv' SETTINGS input_format_skip_unknown_fields = 1, skip_nullinput_notnull_col = 1;
