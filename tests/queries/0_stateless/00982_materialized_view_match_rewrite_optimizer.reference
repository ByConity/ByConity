1.test projection rewrite
Projection est. ? rows
│     Expressions: [sum(k)], divide(sum(salary), 100):=`sum(salary)` / 100, plus(deptno, 1):=deptno + 1
└─ Gather Exchange est. ? rows
   └─ Filter est. ? rows
      │     Condition: 1
      └─ TableScan test.mv_data est. ? rows
               Outputs: [deptno, sum(k), sum(salary)]
note: Materialized Views is applied for 1 times: test.mv_define.
11	285	300
21	80	100
1.2 test duplicate names
Projection est. ? rows
│     Expressions: [deptno], commission:=`sum(commission)`, salary:=`sum(salary)`
└─ Gather Exchange est. ? rows
   └─ Projection est. ? rows
      │     Expressions: [deptno, sum(commission), sum(salary)]
      └─ TableScan test.mv_data est. ? rows
               Outputs: [deptno, sum(commission), sum(salary)]
note: Materialized Views is applied for 1 times: test.mv_data.
2-1. test filter rewrite
Projection est. ? rows
│     Expressions: [name], x:=empid
└─ Gather Exchange est. ? rows
   └─ Filter est. ? rows
      │     Condition: deptno = 10
      └─ TableScan test.mv_data est. ? rows
               Outputs: [deptno, empid, name]
note: Materialized Views is applied for 1 times: test.mv_define.
100	Bill
110	Theodore
150	Sebastian
2-2. test filter rewrite
Projection est. ? rows
│     Expressions: [name], x:=empid
└─ Gather Exchange est. ? rows
   └─ Filter est. ? rows
      │     Condition: empid > 120
      └─ TableScan test.mv_data est. ? rows
               Outputs: [empid, name]
note: Materialized Views is applied for 1 times: test.mv_define.
150	Sebastian
200	Eric
3. test rollup aggregate rewrite
Projection est. ? rows
│     Expressions: c:=`expr#sum()(c)` + 1, deptno:=`expr#deptno`
└─ Gather Exchange est. ? rows
   └─ MergingAggregated est. ? rows
      └─ Repartition Exchange est. ? rows
         │     Partition by: {expr#deptno}
         └─ Aggregating est. ? rows
            │     Group by: {expr#deptno}
            │     Aggregates: expr#sum()(c):=AggNull(sum)(expr#c)
            └─ Projection est. ? rows
               │     Expressions: expr#c:=c, expr#deptno:=deptno
               └─ Filter est. ? rows
                  │     Condition: 1
                  └─ TableScan test.mv_data est. ? rows
                           Outputs: [c, deptno]
note: Materialized Views is applied for 1 times: test.mv_define.
4	10
2	20
4. test rollup aggregate rewrite
Projection est. ? rows
│     Expressions: c:=`expr#countMerge()(c)`, deptno:=`expr#deptno`
└─ Gather Exchange est. ? rows
   └─ MergingAggregated est. ? rows
      └─ Repartition Exchange est. ? rows
         │     Partition by: {expr#deptno}
         └─ Aggregating est. ? rows
            │     Group by: {expr#deptno}
            │     Aggregates: expr#countMerge()(c):=AggNull(countMerge)(expr#c)
            └─ Projection est. ? rows
               │     Expressions: expr#c:=c, expr#deptno:=deptno
               └─ Filter est. ? rows
                  │     Condition: 1
                  └─ TableScan test.mv_data est. ? rows
                           Outputs: [c, deptno]
note: Materialized Views is applied for 1 times: test.mv_define.
3	10
1	20
5-2. test rollup aggregate rewrite with filter
Projection est. ? rows
│     Expressions: [a, c, deptno, empid]
└─ Gather Exchange est. ? rows
   └─ Filter est. ? rows
      │     Condition: empid = 150
      └─ TableScan test.mv_data est. ? rows
               Outputs: [a, c, deptno, empid]
note: Materialized Views is applied for 1 times: test.mv_define.
1	7000	150	10
