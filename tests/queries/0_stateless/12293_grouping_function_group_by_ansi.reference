-- { echoOn }
SELECT
    number,
    grouping(number, number % 2) = 0
FROM remote('127.0.0.{2,3}', numbers(10))
GROUP BY
    number,
    number % 2
ORDER BY number;
0	1
1	1
2	1
3	1
4	1
5	1
6	1
7	1
8	1
9	1
SELECT
    number,
    grouping(number),
    GROUPING(number % 2)
FROM remote('127.0.0.{2,3}', numbers(10))
GROUP BY
    number,
    number % 2
ORDER BY number;
0	0	0
1	0	0
2	0	0
3	0	0
4	0	0
5	0	0
6	0	0
7	0	0
8	0	0
9	0	0
SELECT
    number,
    grouping(number, number % 2) AS gr
FROM remote('127.0.0.{2,3}', numbers(10))
GROUP BY
    number,
    number % 2
WITH ROLLUP
ORDER BY
    number, gr;
0	0
0	1
1	0
1	1
2	0
2	1
3	0
3	1
4	0
4	1
5	0
5	1
6	0
6	1
7	0
7	1
8	0
8	1
9	0
9	1
\N	3
SELECT
    number,
    grouping(number, number % 2) AS gr
FROM remote('127.0.0.{2,3}', numbers(10))
GROUP BY
    ROLLUP(number, number % 2)
ORDER BY
    number, gr;
0	0
0	1
1	0
1	1
2	0
2	1
3	0
3	1
4	0
4	1
5	0
5	1
6	0
6	1
7	0
7	1
8	0
8	1
9	0
9	1
\N	3
SELECT
    number,
    grouping(number, number % 2) AS gr
FROM remote('127.0.0.{2,3}', numbers(10))
GROUP BY
    number,
    number % 2
WITH CUBE
ORDER BY
    number, gr;
0	0
0	1
1	0
1	1
2	0
2	1
3	0
3	1
4	0
4	1
5	0
5	1
6	0
6	1
7	0
7	1
8	0
8	1
9	0
9	1
\N	2
\N	2
\N	3
SELECT
    number,
    grouping(number, number % 2) AS gr
FROM remote('127.0.0.{2,3}', numbers(10))
GROUP BY
    CUBE(number, number % 2)
ORDER BY
    number, gr;
0	0
0	1
1	0
1	1
2	0
2	1
3	0
3	1
4	0
4	1
5	0
5	1
6	0
6	1
7	0
7	1
8	0
8	1
9	0
9	1
\N	2
\N	2
\N	3
SELECT
    number,
    grouping(number, number % 2) + 3 as gr
FROM remote('127.0.0.{2,3}', numbers(10))
GROUP BY
    CUBE(number, number % 2)
HAVING grouping(number) != 1
ORDER BY
    number, gr;
0	3
0	4
1	3
1	4
2	3
2	4
3	3
3	4
4	3
4	4
5	3
5	4
6	3
6	4
7	3
7	4
8	3
8	4
9	3
9	4
SELECT
    number,
    grouping(number, number % 2) as gr
FROM remote('127.0.0.{2,3}', numbers(10))
GROUP BY
    CUBE(number, number % 2) WITH TOTALS
ORDER BY
    number, gr;
0	0
0	1
1	0
1	1
2	0
2	1
3	0
3	1
4	0
4	1
5	0
5	1
6	0
6	1
7	0
7	1
8	0
8	1
9	0
9	1
\N	2
\N	2
\N	3

\N	3
SELECT
    number,
    grouping(number, number % 2) as gr
FROM remote('127.0.0.{2,3}', numbers(10))
GROUP BY
    ROLLUP(number, number % 2) WITH TOTALS
ORDER BY
    number, gr;
0	0
0	1
1	0
1	1
2	0
2	1
3	0
3	1
4	0
4	1
5	0
5	1
6	0
6	1
7	0
7	1
8	0
8	1
9	0
9	1
\N	3

\N	3
