CREATE DATABASE IF NOT EXISTS aeolus_data_db_aeolus_delta_202005;
DROP TABLE IF EXISTS aeolus_data_db_aeolus_delta_202005.aeolus_data_table_45701_prod;
CREATE TABLE aeolus_data_db_aeolus_delta_202005.aeolus_data_table_45701_prod (`row_id_kmtq3k` Int64 ,`p_date` Date ,`source` Nullable(String) ,`doc_site` Nullable(String) ,`app_name` Nullable(String) ,`ala_src` Nullable(String) ,`user_id` Nullable(Int64) ,`user_type` Nullable(Int32) ,`device_id` Nullable(Int64) ,`device_platform` Nullable(String) ,`device_module` Nullable(String) ,`os_version` Nullable(String) ,`city_name` Nullable(String) ,`province_name` Nullable(String) ,`activation_date` Nullable(String) ,`city_level` Nullable(String) ,`gender` Nullable(String) ,`age` Nullable(String) ,`device_model_level` Nullable(String) ,`version_code` Nullable(Int32) ,`user_activeness` Nullable(Int32) ,`manual_uniq_search_pv` Nullable(Int64) ,`all_uniq_search_pv` Nullable(Int64) ,`raw_doc_title` Nullable(String) ,`doc_title` Nullable(String) ,`doc_url` Nullable(String) ,`is_baike` Nullable(String) ,`baike_type` Nullable(String) ,`doc_rank` Nullable(Int32) ,`stay_page_time_sum` Nullable(Float64) ,`result_type` Nullable(String) ,`search_query` Nullable(String) ,`search_id` Nullable(String) ,`search_type` Nullable(Int64) ,`page_count` Nullable(Int64) ,`query_tags` Array(Nullable(String)) ,`client_click` Nullable(Int32) ,`client_click_ts` Nullable(Int64) ,`click_order` Nullable(Int32) ,`click_order_natural` Nullable(Int32) ,`is_last_click` Nullable(Int32) ,`is_last_natural_click` Nullable(Int32) ,`date` Nullable(String) ,`client_show` Nullable(Int32) ,`baike_categorytwo` Nullable(String) ,`baike_categoryone` Nullable(String) ,`baike_itemname` Nullable(String) ,`baike_doc_id` Nullable(String) ,`baike_categorythr` Nullable(String) ,`baike_doc_title` Nullable(String) ,`baike_doc_url` Nullable(String) ,`baike_intent_score` Nullable(Float32) ,`baike_categoryfifth` Nullable(String) ,`baike_categoryfourth` Nullable(String) ,`wiki_doc_id` Nullable(String) ) ENGINE = CnchMergeTree() PARTITION BY p_date ORDER BY (`row_id_kmtq3k`,intHash64(`row_id_kmtq3k`)) SAMPLE BY intHash64(`row_id_kmtq3k`);
INSERT INTO aeolus_data_db_aeolus_delta_202005.aeolus_data_table_45701_prod FORMAT CSV INFILE '/data01/xinghe.shangguan/cnch-sql-cases/tools/certificate_builder/certificate_aeolus_delta/tables_info/aeolus_data_db_aeolus_delta_202005.aeolus_data_table_45701_prod.csv' SETTINGS input_format_skip_unknown_fields = 1, skip_nullinput_notnull_col = 1;
