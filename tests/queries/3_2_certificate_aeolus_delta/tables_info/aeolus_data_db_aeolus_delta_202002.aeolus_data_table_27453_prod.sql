CREATE DATABASE IF NOT EXISTS aeolus_data_db_aeolus_delta_202002;
DROP TABLE IF EXISTS aeolus_data_db_aeolus_delta_202002.aeolus_data_table_27453_prod;
CREATE TABLE aeolus_data_db_aeolus_delta_202002.aeolus_data_table_27453_prod (`row_id_kmtq3k` Int64 ,`p_date` Date ,`hour` String ,`ad_source` Nullable(Int32) ,`creative_id` Nullable(Int64) ,`ad_id` Nullable(Int64) ,`campain_id` Nullable(Int64) ,`rit` Nullable(Int32) ,`orit` Nullable(Int64) ,`classify` Nullable(Int32) ,`pricing` Nullable(Int32) ,`landing_type` Nullable(Int32) ,`image_mode` Nullable(Int32) ,`flow_control_mode` Nullable(Int64) ,`advanced_creative_type` Nullable(String) ,`query` Nullable(String) ,`search_id` Nullable(String) ,`search_type` Nullable(String) ,`search_source` Nullable(String) ,`search_tab` Nullable(String) ,`offset` Nullable(String) ,`relevance` Nullable(String) ,`display_type` Nullable(String) ,`bid_word_id` Nullable(String) ,`bid_word_recall_type` Nullable(String) ,`bid_word_version` Nullable(String) ,`utm_source` Nullable(String) ,`uid` Nullable(Int64) ,`req_id` Nullable(String) ,`platform` Nullable(String) ,`app_version` Nullable(String) ,`g_pos` Nullable(String) ,`tag` Nullable(String) ,`refer` Nullable(String) ,`ml_label` Nullable(String) ,`label` Nullable(String) ,`external_action` Nullable(String) ,`ecpm_thres` Nullable(Float64) ,`vid` Nullable(String) ,`external_json` Nullable(String) ,`send_cnt` Nullable(Int64) ,`show_cnt` Nullable(Int64) ,`click_cnt` Nullable(Int64) ,`convert_cnt` Nullable(Int64) ,`click_start_cnt` Nullable(Int64) ,`download_finish_count` Nullable(Int64) ,`install_finish_count` Nullable(Int64) ,`cost` Nullable(Int64) ,`ectr` Nullable(Float64) ,`ecvr` Nullable(Float64) ,`ecpm` Nullable(Float64) ,`last_ecpm` Nullable(Int64) ,`sorted_ecpm` Nullable(Float64) ,`bid` Nullable(Float64) ,`rank_bid` Nullable(Float64) ,`recall_ectr` Nullable(Float64) ,`recall_ecvr` Nullable(Float64) ,`sati_ectr` Nullable(Float64) ,`advertiser_id` Nullable(Int64) ,`uuid` Nullable(String) ,`ad_extra_data` Nullable(String) ,`did` Nullable(Int64) ,`city_id` Nullable(Int32) ,`content_type` Nullable(Int32) ,`app_code` Nullable(Int64) ,`campaign_type` Nullable(Int64) ,`predict_relevance` Nullable(String) ,`rerank_detail` Nullable(String) ,`is_dpa` Nullable(Int64) ,`second_ad_agent_name` Nullable(String) ,`first_ad_agent_id` Nullable(Int64) ,`advertiser_name` Nullable(String) ,`first_ad_agent_name` Nullable(String) ,`second_industry_id` Nullable(Int64) ,`first_industry_id` Nullable(Int64) ,`ad_agent_id` Nullable(Int64) ,`ad_agent_name` Nullable(String) ,`second_ad_agent_id` Nullable(Int64) ,`business_type` Nullable(Int64) ,`first_industry_name` Nullable(String) ,`customer_id` Nullable(Int64) ,`customer_name` Nullable(String) ,`second_industry_name` Nullable(String) ,`city_name` Nullable(String) ,`gender` Nullable(String) ,`age` Nullable(Int64) ,`province_name` Nullable(String) ,`audit_second_industry` Nullable(Int64) ,`audit_third_indsutry_name` Nullable(String) ,`audit_first_industry` Nullable(Int64) ,`audit_third_industry` Nullable(Int64) ,`audit_first_indsutry_name` Nullable(String) ,`audit_second_indsutry_name` Nullable(String) ,`shadow_ad_id` Nullable(Int64) ,`shadow_strategy_version` Nullable(String) ,`shadow_advertiser_id` Nullable(Int64) ,`shadow_campaign_id` Nullable(Int64) ,`shadow_creative_id` Nullable(Int64) ) ENGINE = CnchMergeTree() PARTITION BY (p_date,hour) ORDER BY intHash64(`row_id_kmtq3k`) SAMPLE BY intHash64(`row_id_kmtq3k`);
INSERT INTO aeolus_data_db_aeolus_delta_202002.aeolus_data_table_27453_prod FORMAT CSV INFILE '/data01/xinghe.shangguan/cnch-sql-cases/tools/certificate_builder/certificate_aeolus_delta/tables_info/aeolus_data_db_aeolus_delta_202002.aeolus_data_table_27453_prod.csv' SETTINGS input_format_skip_unknown_fields = 1, skip_nullinput_notnull_col = 1;
