CREATE DATABASE IF NOT EXISTS aeolus_data_db_aeolus_delta_202002;
DROP TABLE IF EXISTS aeolus_data_db_aeolus_delta_202002.aeolus_data_table_28785_prod;
CREATE TABLE aeolus_data_db_aeolus_delta_202002.aeolus_data_table_28785_prod (`row_id_kmtq3k` Int64 ,`p_date` Date ,`automation_id` Nullable(Int64) ,`automation_type` Nullable(Int64) ,`task_id` Nullable(Int64) ,`qualification_id` Nullable(Int64) ,`automation_status` Nullable(Int64) ,`automation_is_apply` Nullable(Int64) ,`automation_create_time` Nullable(Int64) ,`qualification_code` Nullable(String) ,`qualification_category` Nullable(Int64) ,`qualification_subcategory` Nullable(Int64) ,`account_id` Nullable(Int64) ,`platform` Nullable(Int64) ,`industry1_id` Nullable(Int64) ,`industry2_id` Nullable(Int64) ,`industry3_id` Nullable(Int64) ,`manual_create_time` Nullable(Int64) ,`manual_status` Nullable(Int64) ,`adv_create_time` Nullable(String) ,`advertiser_role` Nullable(Int64) ,`advertiser_origin` Nullable(Int64) ,`adv_system_origin` Nullable(Int64) ,`advertiser_customer_type` Nullable(Int64) ,`date` Nullable(String) ,`automation_passed_validators` Nullable(String) ,`manual_reject_reasons` Nullable(String) ,`automation_reject_reasons` Nullable(String) ,`manual_remark` Nullable(String) ,`automation_reject_validators` Nullable(String) ,`zephyr_task_id` Nullable(String) ,`scene_id` Nullable(Int64) ,`is_online` Nullable(Int64) ,`audit_material` Nullable(String) ,`business_type` Nullable(String) ,`ca_qua_category` Nullable(Int64) ,`second_industry_id` Nullable(Int64) ,`agent_name` Nullable(String) ,`direct_salesman_name` Nullable(String) ,`customer_source` Nullable(Int64) ,`advertiser_status` Nullable(Int64) ,`growth_sales_id` Nullable(String) ,`growth_sales_department_id` Nullable(String) ,`cus_first_industry_name` Nullable(String) ,`create_time` Nullable(String) ,`growth_sales_department_name` Nullable(String) ,`first_ad_agent_id` Nullable(Int64) ,`channel_salesman_department_name` Nullable(String) ,`cus_second_industry_name` Nullable(String) ,`customer_name` Nullable(String) ,`first_ad_agent_name` Nullable(String) ,`advertiser_customer_id` Nullable(Int64) ,`company_id` Nullable(Int64) ,`ad_agent_id` Nullable(Int64) ,`company_name` Nullable(String) ,`advertiser_customer_type[dm_ad_audit_dim_advertisers]` Nullable(Int64) ,`customer_id` Nullable(Int64) ,`is_luban` Nullable(Int64) ,`customer_formated_name` Nullable(String) ,`adv_business_type_strategy` Nullable(String) ,`advertiser_role[dm_ad_audit_dim_advertisers]` Nullable(Int64) ,`direct_salesman_department_id` Nullable(Int64) ,`first_industry_id` Nullable(Int64) ,`adv_business_type` Nullable(Int64) ,`channel_salesman_name` Nullable(String) ,`channel_salesman_id` Nullable(Int64) ,`direct_salesman_department_name` Nullable(String) ,`date[dm_ad_audit_dim_advertisers]` Nullable(String) ,`cus_department_id` Nullable(Int64) ,`advertiser_id` Nullable(Int64) ,`cus_sales_name` Nullable(String) ,`channel_salesman_department_id` Nullable(Int64) ,`advertiser_origin[dm_ad_audit_dim_advertisers]` Nullable(Int64) ,`adv_system_origin[dm_ad_audit_dim_advertisers]` Nullable(Int64) ,`direct_salesman_id` Nullable(Int64) ,`advertiser_tags` Array(Nullable(Int64)) ,`adv_channel_sales` Nullable(String) ,`adv_sales_team` Nullable(String) ,`cus_team_name` Nullable(String) ,`adv_sales` Nullable(String) ,`adv_channel_sales_team` Nullable(String) ,`growth_sales_name` Nullable(String) ,`cus_department_name` Nullable(String) ,`is_gray` Nullable(Int64) ,`app_id` Nullable(String) ) ENGINE = CnchMergeTree() PARTITION BY p_date ORDER BY intHash64(`row_id_kmtq3k`) SAMPLE BY intHash64(`row_id_kmtq3k`);
INSERT INTO aeolus_data_db_aeolus_delta_202002.aeolus_data_table_28785_prod FORMAT CSV INFILE '/data01/xinghe.shangguan/cnch-sql-cases/tools/certificate_builder/certificate_aeolus_delta/tables_info/aeolus_data_db_aeolus_delta_202002.aeolus_data_table_28785_prod.csv' SETTINGS input_format_skip_unknown_fields = 1, skip_nullinput_notnull_col = 1;
