CREATE DATABASE IF NOT EXISTS mct;
DROP TABLE IF EXISTS mct.business_dwd_user_profile_daily;
CREATE TABLE mct.business_dwd_user_profile_daily (`simple_score` String ,`career` String ,`energetic_score` String ,`costbased_level` String ,`is_own_car` String ,`social_level` String ,`ad_preference` Array(String) ,`p_date` String ,`natural_level` String ,`technological_level` String ,`car_configure` Array(String) ,`budget` Array(String) ,`car_function` Array(String) ,`trend_level` String ,`series_follow` Array(String) ,`device_id` Int64 ,`natural_score` String ,`leisure_style` Array(String) ,`pragmatism_score` String ,`series_follow_names` Array(String) ,`marriage_status` String ,`content_preference` Array(String) ,`location_province` String ,`edu` String ,`brand_follow` Array(String) ,`social_score` String ,`traditional_level` String ,`technological_score` String ,`gender` String ,`pragmatism_level` String ,`kid_stage` String ,`wordofmouth_score` String ,`respectable_level` String ,`home_level` String ,`energetic_level` String ,`aggressive_score` String ,`trend_score` String ,`simple_level` String ,`location_city` String ,`commute_distance` String ,`luxurious_score` String ,`arts_score` String ,`car_usage` Array(String) ,`home_score` String ,`location_city_label` String ,`aggressive_level` String ,`brand_follow_names` Array(String) ,`job_style` Array(String) ,`convenience_level` String ,`stage` String ,`traditional_score` String ,`luxurious_level` String ,`arts_level` String ,`respectable_score` String ,`wordofmouth_level` String ,`costbased_score` String ,`convenience_score` String ,`is_own_house` String ,`age` String ,`car_series_type` Array(String) ,`consumption_level` String ,`main_cat` String ,`car_brand_country` Array(String) ,`device_brand_general` String ,`lk_category1_1` Array(String) ,`phone_launch_price_general` String ) ENGINE = CnchMergeTree() PARTITION BY p_date ORDER BY (device_id,intHash64(device_id)) SAMPLE BY intHash64(device_id);
INSERT INTO mct.business_dwd_user_profile_daily FORMAT CSV INFILE '/data01/liulanyi/cnch-sql-cases/tools/certificate_builder/certificate_motor_dzx/tables_info/mct.business_dwd_user_profile_daily.csv' SETTINGS input_format_skip_unknown_fields = 1, skip_nullinput_notnull_col = 1;
