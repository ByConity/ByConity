CREATE DATABASE IF NOT EXISTS dzx;
DROP TABLE IF EXISTS dzx.dwa_traffic_perfro_compare_di;
CREATE TABLE dzx.dwa_traffic_perfro_compare_di (`third_contact` String ,`chance_impr_cnt` Float64 ,`radi_play_cnt` Float64 ,`interact_cnt` Int64 ,`radi_clk_uv` Float64 ,`radi_impr_cnt` Float64 ,`clk_uv` Int64 ,`core_read_uv` Float64 ,`read_uv` Int64 ,`read_cnt` Int64 ,`core_impr_uv` Float64 ,`impr_uv` Int64 ,`p_date` String ,`second_contact` String ,`chance_clk_uv` Float64 ,`chance_impr_uv` Float64 ,`core_play_cnt` Float64 ,`core_read_cnt` Float64 ,`account_name` String ,`core_play_uv` Float64 ,`play_uv` Int64 ,`series_name` String ,`chance_interact_cnt` Float64 ,`play_cnt` Int64 ,`chance_play_uv` Float64 ,`interact_uv` Int64 ,`core_clk_uv` Float64 ,`impr_cnt` Int64 ,`radi_read_uv` Float64 ,`chance_read_cnt` Float64 ,`radi_play_uv` Float64 ,`clk_cnt` Int64 ,`core_clk_cnt` Float64 ,`radi_interact_cnt` Float64 ,`radi_impr_uv` Float64 ,`core_impr_cnt` Float64 ,`chance_clk_cnt` Float64 ,`core_interact_cnt` Float64 ,`series_id` Int64 ,`chance_read_uv` Float64 ,`radi_interact_uv` Float64 ,`core_interact_uv` Float64 ,`account_id` Int64 ,`chance_play_cnt` Float64 ,`radi_clk_cnt` Float64 ,`chance_interact_uv` Float64 ,`radi_read_cnt` Float64 ,`first_contact` String ) ENGINE = CnchMergeTree() PARTITION BY p_date ORDER BY (series_id,account_id,first_contact,second_contact,third_contact,cityHash64(third_contact)) SAMPLE BY cityHash64(third_contact);
INSERT INTO dzx.dwa_traffic_perfro_compare_di FORMAT CSV INFILE '/data01/liulanyi/cnch-sql-cases/tools/certificate_builder/certificate_motor_dzx/tables_info/dzx.dwa_traffic_perfro_compare_di.csv' SETTINGS input_format_skip_unknown_fields = 1, skip_nullinput_notnull_col = 1;
