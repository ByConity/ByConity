<?xml version="1.0"?>
<!--
  NOTE: User and query level settings are set up in "users.xml" file.
--><yandex>
    <logger>
        <!-- Possible levels: https://github.com/pocoproject/poco/blob/develop/Foundation/include/Poco/Logger.h#L105 -->
        <level>trace</level>
        <log>/test_output/resource-manager/resource-manager.log</log>
        <errorlog>/test_output/resource-manager/resource-manager.err.log</errorlog>
        <testlog>/test_output/resource-manager/resource-manager.test.log</testlog>
        <size>1000M</size>
        <count>10</count>
        <!-- <console>1</console> --> <!-- Default behavior is autodetection (log to console if not daemon mode and is tty) -->
    </logger>
    <!--display_name>production</display_name--> <!-- It is the name that will be shown in the client -->

    <cnch_data_retention_time_in_sec>60</cnch_data_retention_time_in_sec>
    <background_schedule_pool_size>10</background_schedule_pool_size>

    <!-- Path to data directory, with trailing slash. -->
    <path>/clickhouse/cnch_test/server/</path>

    <catalog>
        <name_space>ci_baseline_backward_compability</name_space>
    </catalog>

    <catalog_service>
        <!--Metastore storage type, support `bytekv` and `fdb`-->
        <type>bytekv</type>
        <bytekv>
            <service_name>bytedance.bytekv.bytekv_default</service_name>
            <cluster_name>bytekv_default</cluster_name>
            <name_space>bytekv_cnch_dev</name_space>
            <table_name>cnch_metastore_hz_dev</table_name>
        </bytekv>
    </catalog_service>

    <service_discovery>
        <!--Service Discovery local/consul/dns -->
        <mode>local</mode>
        <cluster>default</cluster>
        <disable_cache>false</disable_cache>
        <cache_timeout>5</cache_timeout>
        <server>
            <psm>data.cnch.server</psm>
            <!-- For dns -->
            <service>cnch-server</service>
            <headless_service>cnch-server-headless</headless_service>
            <!-- For local test -->
            <node>
                <host>ip_address_replace_me</host>
                <hostname>server0</hostname>
                <ports>
                    <!-- TCP/Primary -->
                    <port><name>PORT0</name><value>9000</value></port>
                    <!-- RPC -->
                    <port><name>PORT1</name><value>8223</value></port>
                    <!-- HTTP -->
                    <port><name>PORT2</name><value>8123</value></port>
                    <!-- TCP_SECURE -->
                    <port><name>PORT3</name><value>9002</value></port>
                    <!-- HTTPS_PORT -->
                    <port><name>PORT4</name><value>8125</value></port>
                    <!-- Exchange Stream Port-->
                    <port><name>PORT5</name><value>9400</value></port>
                    <!-- Exchange Status Port-->
                    <port><name>PORT6</name><value>9500</value></port>
                </ports>
            </node>
        </server>
        <tso>
            <psm>data.cnch.tso</psm>
            <!-- For dns -->
            <service>cnch-tso</service>
            <headless_service>cnch-tso-headless</headless_service>
            <!-- For local test -->
            <node>
                <host>ip_address_replace_me</host>
                <hostname>tso0</hostname>
                <ports>
                    <!-- RPC/Primary -->
                    <port><name>PORT0</name><value>8080</value></port>
                </ports>
            </node>
        </tso>
        <daemon_manager>
            <psm>data.cnch.daemon_manager</psm>
            <!-- For dns -->
            <service>cnch-daemonmanager</service>
            <headless_service>cnch-daemonmanager-headless</headless_service>
            <!-- For local test -->
            <node>
                <host>ip_address_replace_me</host>
                <hostname>dm0</hostname>
                <ports>
                    <!-- RPC/Primary -->
                    <port><name>PORT0</name><value>8090</value></port>
                </ports>
            </node>
        </daemon_manager>
        <resource_manager>
            <psm>data.cnch.resource_manager</psm>
            <!-- For dns -->
            <service>cnch-resourcemanager</service>
            <headless_service>cnch-resourcemanager-headless</headless_service>
            <!-- For local test -->
            <node>
                <host>ip_address_replace_me</host>
                <hostname>rm0</hostname>
                <ports>
                    <!-- RPC/Primary -->
                    <port><name>PORT0</name><value>8989</value></port>
                </ports>
            </node>
            <!-- <node>
                <host>ip_address_replace_me</host>
                <hostname>rm0</hostname>
                <ports>
                    <port><name>PORT0</name><value>8990</value></port>
                </ports>
            </node> -->
        </resource_manager>
        <vw>
            <psm>data.cnch.vw_default</psm>
            <!-- For local test -->
            <node>
                <vw_name>vw_default</vw_name>
                <host>ip_address_replace_me</host>
                <hostname>vw_default0</hostname>
                <ports>
                    <!-- TCP/Primary -->
                    <port><name>PORT0</name><value>9001</value></port>
                    <!-- RPC -->
                    <port><name>PORT1</name><value>8224</value></port>
                    <!-- HTTP -->
                    <port><name>PORT2</name><value>8124</value></port>
                    <!-- TCP_SECURE -->
                    <port><name>PORT3</name><value>9003</value></port>
                    <!-- HTTPS_PORT -->
                    <port><name>PORT4</name><value>8126</value></port>
                    <!-- Exchange Stream Port-->
                    <port><name>PORT5</name><value>9410</value></port>
                    <!-- Exchange Status Port-->
                    <port><name>PORT6</name><value>9510</value></port>
                </ports>
            </node>
            <node>
                <vw_name>vw_write</vw_name>
                <host>ip_address_replace_me</host>
                <hostname>vw_write0</hostname>
                <ports>
                    <!-- TCP/Primary -->
                    <port><name>PORT0</name><value>9001</value></port>
                    <!-- RPC -->
                    <port><name>PORT1</name><value>8224</value></port>
                    <!-- HTTP -->
                    <port><name>PORT2</name><value>8124</value></port>
                    <!-- TCP_SECURE -->
                    <port><name>PORT3</name><value>9003</value></port>
                    <!-- HTTPS_PORT -->
                    <port><name>PORT4</name><value>8126</value></port>
                    <!-- Exchange Stream Port-->
                    <port><name>PORT5</name><value>9410</value></port>
                    <!-- Exchange Status Port-->
                    <port><name>PORT6</name><value>9510</value></port>
                </ports>
            </node>
        </vw>
    </service_discovery>

    <resource_manager>
        <port>8989</port>
        <vws>
           <vw>
               <name>vw_default</name>
               <type>Default</type>
               <num_workers>1</num_workers>
               <worker_groups>
                   <worker_group>
                       <name>default</name>
                       <type>Physical</type>
                   </worker_group>
               </worker_groups>
           </vw>
           <vw>
               <name>vw_write</name>
               <type>Write</type>
               <num_workers>1</num_workers>
               <worker_groups>
                   <worker_group>
                       <name>write</name>
                       <type>Physical</type>
                   </worker_group>
               </worker_groups>
           </vw>
        </vws>
    </resource_manager>

</yandex>
