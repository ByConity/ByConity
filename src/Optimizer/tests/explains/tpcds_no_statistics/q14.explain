Projection est. 100 rows
└─ Limit est. 100 rows
   └─ MergingSorted est. ? rows
      └─ MergeSorting est. ? rows
         └─ PartialSorting est. ? rows
            └─ Aggregating est. ? rows
               │     Group by: {expr#'store'_1, i_brand_id_21, i_category_id_21, i_class_id_21}
               └─ Gather Exchange est. ? rows
                  └─ Union est. ? rows
                     ├─ Projection est. ? rows
                     │  └─ Inner Join est. ? rows
                     │     │     Condition: 
                     │     │     Filter: `expr#sum(multiply(ss_quantity, ss_list_price))` > `expr#avg(multiply(quantity, list_price))`
                     │     ├─ MergingAggregated est. ? rows
                     │     │  └─ Repartition Exchange est. ? rows
                     │     │     │     Partition by: {i_brand_id, i_category_id, i_class_id}
                     │     │     └─ Aggregating est. ? rows
                     │     │        │     Group by: {i_brand_id, i_category_id, i_class_id}
                     │     │        └─ Projection est. ? rows
                     │     │           └─ Inner Join est. ? rows
                     │     │              │     Condition: i_item_sk == i_item_sk_1
                     │     │              ├─ Repartition Exchange est. ? rows
                     │     │              │  │     Partition by: {i_item_sk}
                     │     │              │  └─ Inner Join est. ? rows
                     │     │              │     │     Condition: ss_sold_date_sk == d_date_sk
                     │     │              │     ├─ Repartition Exchange est. ? rows
                     │     │              │     │  │     Partition by: {ss_sold_date_sk}
                     │     │              │     │  └─ Inner Join est. ? rows
                     │     │              │     │     │     Condition: ss_item_sk == i_item_sk
                     │     │              │     │     ├─ Repartition Exchange est. ? rows
                     │     │              │     │     │  │     Partition by: {ss_item_sk}
                     │     │              │     │     │  └─ Filter est. ? rows
                     │     │              │     │     │     │     isNotNull(ss_item_sk)
                     │     │              │     │     │     └─ TableScan tpcds.store_sales est. ? rows
                     │     │              │     │     └─ Repartition Exchange est. ? rows
                     │     │              │     │        │     Partition by: {i_item_sk}
                     │     │              │     │        └─ Filter est. ? rows
                     │     │              │     │           │     isNotNull(i_item_sk)
                     │     │              │     │           └─ TableScan tpcds.item est. ? rows
                     │     │              │     └─ Repartition Exchange est. ? rows
                     │     │              │        │     Partition by: {d_date_sk}
                     │     │              │        └─ Filter est. ? rows
                     │     │              │           │     (d_moy = 11) AND (d_year = cast(2001, 'UInt32'))
                     │     │              │           └─ TableScan tpcds.date_dim est. ? rows
                     │     │              └─ MergingAggregated est. ? rows
                     │     │                 └─ Repartition Exchange est. ? rows
                     │     │                    │     Partition by: {i_item_sk_1}
                     │     │                    └─ Aggregating est. ? rows
                     │     │                       │     Group by: {i_item_sk_1}
                     │     │                       └─ Inner Join est. ? rows
                     │     │                          │     Condition: i_brand_id_1 == i_brand_id_6, i_category_id_1 == i_category_id_6, i_class_id_1 == i_class_id_6
                     │     │                          ├─ Repartition Exchange est. ? rows
                     │     │                          │  │     Partition by: {i_brand_id_1, i_category_id_1, i_class_id_1}
                     │     │                          │  └─ Filter est. ? rows
                     │     │                          │     │     isNotNull(i_item_sk_1)
                     │     │                          │     └─ TableScan tpcds.item est. ? rows
                     │     │                          └─ Repartition Exchange est. ? rows
                     │     │                             │     Partition by: {i_brand_id_6, i_category_id_6, i_class_id_6}
                     │     │                             └─ Filter est. ? rows
                     │     │                                │     (sum_2 >= 1) AND (sum_1 >= 1) AND (sum >= 1)
                     │     │                                └─ MergingAggregated est. ? rows
                     │     │                                   └─ Repartition Exchange est. ? rows
                     │     │                                      │     Partition by: {i_brand_id_6, i_category_id_6, i_class_id_6}
                     │     │                                      └─ Aggregating est. ? rows
                     │     │                                         │     Group by: {i_brand_id_6, i_category_id_6, i_class_id_6}
                     │     │                                         └─ Union est. ? rows
                     │     │                                            ├─ Projection est. ? rows
                     │     │                                            │  └─ Inner Join est. ? rows
                     │     │                                            │     │     Condition: ss_sold_date_sk_1 == d_date_sk_1
                     │     │                                            │     ├─ Repartition Exchange est. ? rows
                     │     │                                            │     │  │     Partition by: {ss_sold_date_sk_1}
                     │     │                                            │     │  └─ Inner Join est. ? rows
                     │     │                                            │     │     │     Condition: ss_item_sk_1 == i_item_sk_2
                     │     │                                            │     │     ├─ Repartition Exchange est. ? rows
                     │     │                                            │     │     │  │     Partition by: {ss_item_sk_1}
                     │     │                                            │     │     │  └─ TableScan tpcds.store_sales est. ? rows
                     │     │                                            │     │     └─ Repartition Exchange est. ? rows
                     │     │                                            │     │        │     Partition by: {i_item_sk_2}
                     │     │                                            │     │        └─ TableScan tpcds.item est. ? rows
                     │     │                                            │     └─ Repartition Exchange est. ? rows
                     │     │                                            │        │     Partition by: {d_date_sk_1}
                     │     │                                            │        └─ Filter est. ? rows
                     │     │                                            │           │     (d_year_1 <= cast(2001, 'UInt32')) AND (d_year_1 >= 1999)
                     │     │                                            │           └─ TableScan tpcds.date_dim est. ? rows
                     │     │                                            ├─ Projection est. ? rows
                     │     │                                            │  └─ Inner Join est. ? rows
                     │     │                                            │     │     Condition: cs_sold_date_sk == d_date_sk_2
                     │     │                                            │     ├─ Repartition Exchange est. ? rows
                     │     │                                            │     │  │     Partition by: {cs_sold_date_sk}
                     │     │                                            │     │  └─ Inner Join est. ? rows
                     │     │                                            │     │     │     Condition: cs_item_sk == i_item_sk_3
                     │     │                                            │     │     ├─ Repartition Exchange est. ? rows
                     │     │                                            │     │     │  │     Partition by: {cs_item_sk}
                     │     │                                            │     │     │  └─ TableScan tpcds.catalog_sales est. ? rows
                     │     │                                            │     │     └─ Repartition Exchange est. ? rows
                     │     │                                            │     │        │     Partition by: {i_item_sk_3}
                     │     │                                            │     │        └─ TableScan tpcds.item est. ? rows
                     │     │                                            │     └─ Repartition Exchange est. ? rows
                     │     │                                            │        │     Partition by: {d_date_sk_2}
                     │     │                                            │        └─ Filter est. ? rows
                     │     │                                            │           │     (d_year_2 >= 1999) AND (d_year_2 <= cast(2001, 'UInt32'))
                     │     │                                            │           └─ TableScan tpcds.date_dim est. ? rows
                     │     │                                            └─ Projection est. ? rows
                     │     │                                               └─ Inner Join est. ? rows
                     │     │                                                  │     Condition: ws_sold_date_sk == d_date_sk_3
                     │     │                                                  ├─ Repartition Exchange est. ? rows
                     │     │                                                  │  │     Partition by: {ws_sold_date_sk}
                     │     │                                                  │  └─ Inner Join est. ? rows
                     │     │                                                  │     │     Condition: ws_item_sk == i_item_sk_4
                     │     │                                                  │     ├─ Repartition Exchange est. ? rows
                     │     │                                                  │     │  │     Partition by: {ws_item_sk}
                     │     │                                                  │     │  └─ TableScan tpcds.web_sales est. ? rows
                     │     │                                                  │     └─ Repartition Exchange est. ? rows
                     │     │                                                  │        │     Partition by: {i_item_sk_4}
                     │     │                                                  │        └─ TableScan tpcds.item est. ? rows
                     │     │                                                  └─ Repartition Exchange est. ? rows
                     │     │                                                     │     Partition by: {d_date_sk_3}
                     │     │                                                     └─ Filter est. ? rows
                     │     │                                                        │     (d_year_3 >= 1999) AND (d_year_3 <= cast(2001, 'UInt32'))
                     │     │                                                        └─ TableScan tpcds.date_dim est. ? rows
                     │     └─ Broadcast Exchange est. ? rows
                     │        └─ MergingAggregated est. ? rows
                     │           └─ Gather Exchange est. ? rows
                     │              └─ Aggregating est. ? rows
                     │                 │     Group by: {}
                     │                 └─ Projection est. ? rows
                     │                    └─ Union est. ? rows
                     │                       ├─ Inner Join est. ? rows
                     │                       │  │     Condition: ss_sold_date_sk_2 == d_date_sk_4
                     │                       │  ├─ Repartition Exchange est. ? rows
                     │                       │  │  │     Partition by: {ss_sold_date_sk_2}
                     │                       │  │  └─ TableScan tpcds.store_sales est. ? rows
                     │                       │  └─ Repartition Exchange est. ? rows
                     │                       │     │     Partition by: {d_date_sk_4}
                     │                       │     └─ Filter est. ? rows
                     │                       │        │     (d_year_4 >= 1999) AND (d_year_4 <= cast(2001, 'UInt32'))
                     │                       │        └─ TableScan tpcds.date_dim est. ? rows
                     │                       ├─ Inner Join est. ? rows
                     │                       │  │     Condition: cs_sold_date_sk_1 == d_date_sk_5
                     │                       │  ├─ Repartition Exchange est. ? rows
                     │                       │  │  │     Partition by: {cs_sold_date_sk_1}
                     │                       │  │  └─ TableScan tpcds.catalog_sales est. ? rows
                     │                       │  └─ Repartition Exchange est. ? rows
                     │                       │     │     Partition by: {d_date_sk_5}
                     │                       │     └─ Filter est. ? rows
                     │                       │        │     (d_year_5 <= cast(2001, 'UInt32')) AND (d_year_5 >= 1999)
                     │                       │        └─ TableScan tpcds.date_dim est. ? rows
                     │                       └─ Inner Join est. ? rows
                     │                          │     Condition: ws_sold_date_sk_1 == d_date_sk_6
                     │                          ├─ Repartition Exchange est. ? rows
                     │                          │  │     Partition by: {ws_sold_date_sk_1}
                     │                          │  └─ TableScan tpcds.web_sales est. ? rows
                     │                          └─ Repartition Exchange est. ? rows
                     │                             │     Partition by: {d_date_sk_6}
                     │                             └─ Filter est. ? rows
                     │                                │     (d_year_6 <= cast(2001, 'UInt32')) AND (d_year_6 >= 1999)
                     │                                └─ TableScan tpcds.date_dim est. ? rows
                     ├─ Projection est. ? rows
                     │  └─ Inner Join est. ? rows
                     │     │     Condition: 
                     │     │     Filter: `expr#sum(multiply(cs_quantity, cs_list_price))` > `expr#avg(multiply(quantity, list_price))_1`
                     │     ├─ MergingAggregated est. ? rows
                     │     │  └─ Repartition Exchange est. ? rows
                     │     │     │     Partition by: {i_brand_id_7, i_category_id_7, i_class_id_7}
                     │     │     └─ Aggregating est. ? rows
                     │     │        │     Group by: {i_brand_id_7, i_category_id_7, i_class_id_7}
                     │     │        └─ Projection est. ? rows
                     │     │           └─ Inner Join est. ? rows
                     │     │              │     Condition: cs_item_sk_2 == i_item_sk_6
                     │     │              ├─ Repartition Exchange est. ? rows
                     │     │              │  │     Partition by: {cs_item_sk_2}
                     │     │              │  └─ Inner Join est. ? rows
                     │     │              │     │     Condition: cs_sold_date_sk_2 == d_date_sk_7
                     │     │              │     ├─ Repartition Exchange est. ? rows
                     │     │              │     │  │     Partition by: {cs_sold_date_sk_2}
                     │     │              │     │  └─ Inner Join est. ? rows
                     │     │              │     │     │     Condition: cs_item_sk_2 == i_item_sk_5
                     │     │              │     │     ├─ Repartition Exchange est. ? rows
                     │     │              │     │     │  │     Partition by: {cs_item_sk_2}
                     │     │              │     │     │  └─ Filter est. ? rows
                     │     │              │     │     │     │     isNotNull(cs_item_sk_2)
                     │     │              │     │     │     └─ TableScan tpcds.catalog_sales est. ? rows
                     │     │              │     │     └─ Repartition Exchange est. ? rows
                     │     │              │     │        │     Partition by: {i_item_sk_5}
                     │     │              │     │        └─ Filter est. ? rows
                     │     │              │     │           │     isNotNull(i_item_sk_5)
                     │     │              │     │           └─ TableScan tpcds.item est. ? rows
                     │     │              │     └─ Repartition Exchange est. ? rows
                     │     │              │        │     Partition by: {d_date_sk_7}
                     │     │              │        └─ Filter est. ? rows
                     │     │              │           │     (d_moy_7 = 11) AND (d_year_7 = cast(2001, 'UInt32'))
                     │     │              │           └─ TableScan tpcds.date_dim est. ? rows
                     │     │              └─ MergingAggregated est. ? rows
                     │     │                 └─ Repartition Exchange est. ? rows
                     │     │                    │     Partition by: {i_item_sk_6}
                     │     │                    └─ Aggregating est. ? rows
                     │     │                       │     Group by: {i_item_sk_6}
                     │     │                       └─ Inner Join est. ? rows
                     │     │                          │     Condition: i_brand_id_8 == i_brand_id_13, i_category_id_8 == i_category_id_13, i_class_id_8 == i_class_id_13
                     │     │                          ├─ Repartition Exchange est. ? rows
                     │     │                          │  │     Partition by: {i_brand_id_8, i_category_id_8, i_class_id_8}
                     │     │                          │  └─ Filter est. ? rows
                     │     │                          │     │     isNotNull(i_item_sk_6)
                     │     │                          │     └─ TableScan tpcds.item est. ? rows
                     │     │                          └─ Repartition Exchange est. ? rows
                     │     │                             │     Partition by: {i_brand_id_13, i_category_id_13, i_class_id_13}
                     │     │                             └─ Filter est. ? rows
                     │     │                                │     (sum_4 >= 1) AND (sum_3 >= 1) AND (sum_5 >= 1)
                     │     │                                └─ MergingAggregated est. ? rows
                     │     │                                   └─ Repartition Exchange est. ? rows
                     │     │                                      │     Partition by: {i_brand_id_13, i_category_id_13, i_class_id_13}
                     │     │                                      └─ Aggregating est. ? rows
                     │     │                                         │     Group by: {i_brand_id_13, i_category_id_13, i_class_id_13}
                     │     │                                         └─ Union est. ? rows
                     │     │                                            ├─ Projection est. ? rows
                     │     │                                            │  └─ Inner Join est. ? rows
                     │     │                                            │     │     Condition: ss_sold_date_sk_3 == d_date_sk_8
                     │     │                                            │     ├─ Repartition Exchange est. ? rows
                     │     │                                            │     │  │     Partition by: {ss_sold_date_sk_3}
                     │     │                                            │     │  └─ Inner Join est. ? rows
                     │     │                                            │     │     │     Condition: ss_item_sk_3 == i_item_sk_7
                     │     │                                            │     │     ├─ Repartition Exchange est. ? rows
                     │     │                                            │     │     │  │     Partition by: {ss_item_sk_3}
                     │     │                                            │     │     │  └─ TableScan tpcds.store_sales est. ? rows
                     │     │                                            │     │     └─ Repartition Exchange est. ? rows
                     │     │                                            │     │        │     Partition by: {i_item_sk_7}
                     │     │                                            │     │        └─ TableScan tpcds.item est. ? rows
                     │     │                                            │     └─ Repartition Exchange est. ? rows
                     │     │                                            │        │     Partition by: {d_date_sk_8}
                     │     │                                            │        └─ Filter est. ? rows
                     │     │                                            │           │     (d_year_8 <= cast(2001, 'UInt32')) AND (d_year_8 >= 1999)
                     │     │                                            │           └─ TableScan tpcds.date_dim est. ? rows
                     │     │                                            ├─ Projection est. ? rows
                     │     │                                            │  └─ Inner Join est. ? rows
                     │     │                                            │     │     Condition: cs_sold_date_sk_3 == d_date_sk_9
                     │     │                                            │     ├─ Repartition Exchange est. ? rows
                     │     │                                            │     │  │     Partition by: {cs_sold_date_sk_3}
                     │     │                                            │     │  └─ Inner Join est. ? rows
                     │     │                                            │     │     │     Condition: cs_item_sk_3 == i_item_sk_8
                     │     │                                            │     │     ├─ Repartition Exchange est. ? rows
                     │     │                                            │     │     │  │     Partition by: {cs_item_sk_3}
                     │     │                                            │     │     │  └─ TableScan tpcds.catalog_sales est. ? rows
                     │     │                                            │     │     └─ Repartition Exchange est. ? rows
                     │     │                                            │     │        │     Partition by: {i_item_sk_8}
                     │     │                                            │     │        └─ TableScan tpcds.item est. ? rows
                     │     │                                            │     └─ Repartition Exchange est. ? rows
                     │     │                                            │        │     Partition by: {d_date_sk_9}
                     │     │                                            │        └─ Filter est. ? rows
                     │     │                                            │           │     (d_year_9 >= 1999) AND (d_year_9 <= cast(2001, 'UInt32'))
                     │     │                                            │           └─ TableScan tpcds.date_dim est. ? rows
                     │     │                                            └─ Projection est. ? rows
                     │     │                                               └─ Inner Join est. ? rows
                     │     │                                                  │     Condition: ws_sold_date_sk_2 == d_date_sk_10
                     │     │                                                  ├─ Repartition Exchange est. ? rows
                     │     │                                                  │  │     Partition by: {ws_sold_date_sk_2}
                     │     │                                                  │  └─ Inner Join est. ? rows
                     │     │                                                  │     │     Condition: ws_item_sk_2 == i_item_sk_9
                     │     │                                                  │     ├─ Repartition Exchange est. ? rows
                     │     │                                                  │     │  │     Partition by: {ws_item_sk_2}
                     │     │                                                  │     │  └─ TableScan tpcds.web_sales est. ? rows
                     │     │                                                  │     └─ Repartition Exchange est. ? rows
                     │     │                                                  │        │     Partition by: {i_item_sk_9}
                     │     │                                                  │        └─ TableScan tpcds.item est. ? rows
                     │     │                                                  └─ Repartition Exchange est. ? rows
                     │     │                                                     │     Partition by: {d_date_sk_10}
                     │     │                                                     └─ Filter est. ? rows
                     │     │                                                        │     (d_year_10 <= cast(2001, 'UInt32')) AND (d_year_10 >= 1999)
                     │     │                                                        └─ TableScan tpcds.date_dim est. ? rows
                     │     └─ Broadcast Exchange est. ? rows
                     │        └─ MergingAggregated est. ? rows
                     │           └─ Gather Exchange est. ? rows
                     │              └─ Aggregating est. ? rows
                     │                 │     Group by: {}
                     │                 └─ Projection est. ? rows
                     │                    └─ Union est. ? rows
                     │                       ├─ Inner Join est. ? rows
                     │                       │  │     Condition: ss_sold_date_sk_4 == d_date_sk_11
                     │                       │  ├─ Repartition Exchange est. ? rows
                     │                       │  │  │     Partition by: {ss_sold_date_sk_4}
                     │                       │  │  └─ TableScan tpcds.store_sales est. ? rows
                     │                       │  └─ Repartition Exchange est. ? rows
                     │                       │     │     Partition by: {d_date_sk_11}
                     │                       │     └─ Filter est. ? rows
                     │                       │        │     (d_year_11 >= 1999) AND (d_year_11 <= cast(2001, 'UInt32'))
                     │                       │        └─ TableScan tpcds.date_dim est. ? rows
                     │                       ├─ Inner Join est. ? rows
                     │                       │  │     Condition: cs_sold_date_sk_4 == d_date_sk_12
                     │                       │  ├─ Repartition Exchange est. ? rows
                     │                       │  │  │     Partition by: {cs_sold_date_sk_4}
                     │                       │  │  └─ TableScan tpcds.catalog_sales est. ? rows
                     │                       │  └─ Repartition Exchange est. ? rows
                     │                       │     │     Partition by: {d_date_sk_12}
                     │                       │     └─ Filter est. ? rows
                     │                       │        │     (d_year_12 <= cast(2001, 'UInt32')) AND (d_year_12 >= 1999)
                     │                       │        └─ TableScan tpcds.date_dim est. ? rows
                     │                       └─ Inner Join est. ? rows
                     │                          │     Condition: ws_sold_date_sk_3 == d_date_sk_13
                     │                          ├─ Repartition Exchange est. ? rows
                     │                          │  │     Partition by: {ws_sold_date_sk_3}
                     │                          │  └─ TableScan tpcds.web_sales est. ? rows
                     │                          └─ Repartition Exchange est. ? rows
                     │                             │     Partition by: {d_date_sk_13}
                     │                             └─ Filter est. ? rows
                     │                                │     (d_year_13 >= 1999) AND (d_year_13 <= cast(2001, 'UInt32'))
                     │                                └─ TableScan tpcds.date_dim est. ? rows
                     └─ Projection est. ? rows
                        └─ Inner Join est. ? rows
                           │     Condition: 
                           │     Filter: `expr#sum(multiply(ws_quantity, ws_list_price))` > `expr#avg(multiply(quantity, list_price))_2`
                           ├─ MergingAggregated est. ? rows
                           │  └─ Repartition Exchange est. ? rows
                           │     │     Partition by: {i_brand_id_14, i_category_id_14, i_class_id_14}
                           │     └─ Aggregating est. ? rows
                           │        │     Group by: {i_brand_id_14, i_category_id_14, i_class_id_14}
                           │        └─ Projection est. ? rows
                           │           └─ Inner Join est. ? rows
                           │              │     Condition: i_item_sk_10 == i_item_sk_11
                           │              ├─ Repartition Exchange est. ? rows
                           │              │  │     Partition by: {i_item_sk_10}
                           │              │  └─ Inner Join est. ? rows
                           │              │     │     Condition: ws_sold_date_sk_4 == d_date_sk_14
                           │              │     ├─ Repartition Exchange est. ? rows
                           │              │     │  │     Partition by: {ws_sold_date_sk_4}
                           │              │     │  └─ Inner Join est. ? rows
                           │              │     │     │     Condition: ws_item_sk_4 == i_item_sk_10
                           │              │     │     ├─ Repartition Exchange est. ? rows
                           │              │     │     │  │     Partition by: {ws_item_sk_4}
                           │              │     │     │  └─ Filter est. ? rows
                           │              │     │     │     │     isNotNull(ws_item_sk_4)
                           │              │     │     │     └─ TableScan tpcds.web_sales est. ? rows
                           │              │     │     └─ Repartition Exchange est. ? rows
                           │              │     │        │     Partition by: {i_item_sk_10}
                           │              │     │        └─ Filter est. ? rows
                           │              │     │           │     isNotNull(i_item_sk_10)
                           │              │     │           └─ TableScan tpcds.item est. ? rows
                           │              │     └─ Repartition Exchange est. ? rows
                           │              │        │     Partition by: {d_date_sk_14}
                           │              │        └─ Filter est. ? rows
                           │              │           │     (d_moy_14 = 11) AND (d_year_14 = cast(2001, 'UInt32'))
                           │              │           └─ TableScan tpcds.date_dim est. ? rows
                           │              └─ MergingAggregated est. ? rows
                           │                 └─ Repartition Exchange est. ? rows
                           │                    │     Partition by: {i_item_sk_11}
                           │                    └─ Aggregating est. ? rows
                           │                       │     Group by: {i_item_sk_11}
                           │                       └─ Inner Join est. ? rows
                           │                          │     Condition: i_brand_id_15 == i_brand_id_20, i_category_id_15 == i_category_id_20, i_class_id_15 == i_class_id_20
                           │                          ├─ Repartition Exchange est. ? rows
                           │                          │  │     Partition by: {i_brand_id_15, i_category_id_15, i_class_id_15}
                           │                          │  └─ Filter est. ? rows
                           │                          │     │     isNotNull(i_item_sk_11)
                           │                          │     └─ TableScan tpcds.item est. ? rows
                           │                          └─ Repartition Exchange est. ? rows
                           │                             │     Partition by: {i_brand_id_20, i_category_id_20, i_class_id_20}
                           │                             └─ Filter est. ? rows
                           │                                │     (sum_7 >= 1) AND (sum_8 >= 1) AND (sum_6 >= 1)
                           │                                └─ MergingAggregated est. ? rows
                           │                                   └─ Repartition Exchange est. ? rows
                           │                                      │     Partition by: {i_brand_id_20, i_category_id_20, i_class_id_20}
                           │                                      └─ Aggregating est. ? rows
                           │                                         │     Group by: {i_brand_id_20, i_category_id_20, i_class_id_20}
                           │                                         └─ Union est. ? rows
                           │                                            ├─ Projection est. ? rows
                           │                                            │  └─ Inner Join est. ? rows
                           │                                            │     │     Condition: ss_sold_date_sk_5 == d_date_sk_15
                           │                                            │     ├─ Repartition Exchange est. ? rows
                           │                                            │     │  │     Partition by: {ss_sold_date_sk_5}
                           │                                            │     │  └─ Inner Join est. ? rows
                           │                                            │     │     │     Condition: ss_item_sk_5 == i_item_sk_12
                           │                                            │     │     ├─ Repartition Exchange est. ? rows
                           │                                            │     │     │  │     Partition by: {ss_item_sk_5}
                           │                                            │     │     │  └─ TableScan tpcds.store_sales est. ? rows
                           │                                            │     │     └─ Repartition Exchange est. ? rows
                           │                                            │     │        │     Partition by: {i_item_sk_12}
                           │                                            │     │        └─ TableScan tpcds.item est. ? rows
                           │                                            │     └─ Repartition Exchange est. ? rows
                           │                                            │        │     Partition by: {d_date_sk_15}
                           │                                            │        └─ Filter est. ? rows
                           │                                            │           │     (d_year_15 >= 1999) AND (d_year_15 <= cast(2001, 'UInt32'))
                           │                                            │           └─ TableScan tpcds.date_dim est. ? rows
                           │                                            ├─ Projection est. ? rows
                           │                                            │  └─ Inner Join est. ? rows
                           │                                            │     │     Condition: cs_sold_date_sk_5 == d_date_sk_16
                           │                                            │     ├─ Repartition Exchange est. ? rows
                           │                                            │     │  │     Partition by: {cs_sold_date_sk_5}
                           │                                            │     │  └─ Inner Join est. ? rows
                           │                                            │     │     │     Condition: cs_item_sk_5 == i_item_sk_13
                           │                                            │     │     ├─ Repartition Exchange est. ? rows
                           │                                            │     │     │  │     Partition by: {cs_item_sk_5}
                           │                                            │     │     │  └─ TableScan tpcds.catalog_sales est. ? rows
                           │                                            │     │     └─ Repartition Exchange est. ? rows
                           │                                            │     │        │     Partition by: {i_item_sk_13}
                           │                                            │     │        └─ TableScan tpcds.item est. ? rows
                           │                                            │     └─ Repartition Exchange est. ? rows
                           │                                            │        │     Partition by: {d_date_sk_16}
                           │                                            │        └─ Filter est. ? rows
                           │                                            │           │     (d_year_16 >= 1999) AND (d_year_16 <= cast(2001, 'UInt32'))
                           │                                            │           └─ TableScan tpcds.date_dim est. ? rows
                           │                                            └─ Projection est. ? rows
                           │                                               └─ Inner Join est. ? rows
                           │                                                  │     Condition: ws_sold_date_sk_5 == d_date_sk_17
                           │                                                  ├─ Repartition Exchange est. ? rows
                           │                                                  │  │     Partition by: {ws_sold_date_sk_5}
                           │                                                  │  └─ Inner Join est. ? rows
                           │                                                  │     │     Condition: ws_item_sk_5 == i_item_sk_14
                           │                                                  │     ├─ Repartition Exchange est. ? rows
                           │                                                  │     │  │     Partition by: {ws_item_sk_5}
                           │                                                  │     │  └─ TableScan tpcds.web_sales est. ? rows
                           │                                                  │     └─ Repartition Exchange est. ? rows
                           │                                                  │        │     Partition by: {i_item_sk_14}
                           │                                                  │        └─ TableScan tpcds.item est. ? rows
                           │                                                  └─ Repartition Exchange est. ? rows
                           │                                                     │     Partition by: {d_date_sk_17}
                           │                                                     └─ Filter est. ? rows
                           │                                                        │     (d_year_17 >= 1999) AND (d_year_17 <= cast(2001, 'UInt32'))
                           │                                                        └─ TableScan tpcds.date_dim est. ? rows
                           └─ Broadcast Exchange est. ? rows
                              └─ MergingAggregated est. ? rows
                                 └─ Gather Exchange est. ? rows
                                    └─ Aggregating est. ? rows
                                       │     Group by: {}
                                       └─ Projection est. ? rows
                                          └─ Union est. ? rows
                                             ├─ Inner Join est. ? rows
                                             │  │     Condition: ss_sold_date_sk_6 == d_date_sk_18
                                             │  ├─ Repartition Exchange est. ? rows
                                             │  │  │     Partition by: {ss_sold_date_sk_6}
                                             │  │  └─ TableScan tpcds.store_sales est. ? rows
                                             │  └─ Repartition Exchange est. ? rows
                                             │     │     Partition by: {d_date_sk_18}
                                             │     └─ Filter est. ? rows
                                             │        │     (d_year_18 >= 1999) AND (d_year_18 <= cast(2001, 'UInt32'))
                                             │        └─ TableScan tpcds.date_dim est. ? rows
                                             ├─ Inner Join est. ? rows
                                             │  │     Condition: cs_sold_date_sk_6 == d_date_sk_19
                                             │  ├─ Repartition Exchange est. ? rows
                                             │  │  │     Partition by: {cs_sold_date_sk_6}
                                             │  │  └─ TableScan tpcds.catalog_sales est. ? rows
                                             │  └─ Repartition Exchange est. ? rows
                                             │     │     Partition by: {d_date_sk_19}
                                             │     └─ Filter est. ? rows
                                             │        │     (d_year_19 >= 1999) AND (d_year_19 <= cast(2001, 'UInt32'))
                                             │        └─ TableScan tpcds.date_dim est. ? rows
                                             └─ Inner Join est. ? rows
                                                │     Condition: ws_sold_date_sk_6 == d_date_sk_20
                                                ├─ Repartition Exchange est. ? rows
                                                │  │     Partition by: {ws_sold_date_sk_6}
                                                │  └─ TableScan tpcds.web_sales est. ? rows
                                                └─ Repartition Exchange est. ? rows
                                                   │     Partition by: {d_date_sk_20}
                                                   └─ Filter est. ? rows
                                                      │     (d_year_20 >= 1999) AND (d_year_20 <= cast(2001, 'UInt32'))
                                                      └─ TableScan tpcds.date_dim est. ? rows
Projection est. 100 rows
└─ Limit est. 100 rows
   └─ MergingSorted est. ? rows
      └─ MergeSorting est. ? rows
         └─ PartialSorting est. ? rows
            └─ Gather Exchange est. ? rows
               └─ MergeSorting est. ? rows
                  └─ PartialSorting est. ? rows
                     └─ Inner Join est. ? rows
                        │     Condition: 
                        │     Filter: `expr#sum(multiply(ss_quantity, ss_list_price))_3` > `expr#avg(multiply(quantity, list_price))_4`
                        ├─ Inner Join est. ? rows
                        │  │     Condition: 
                        │  │     Filter: `expr#sum(multiply(ss_quantity, ss_list_price))_2` > `expr#avg(multiply(quantity, list_price))_3`
                        │  ├─ Inner Join est. ? rows
                        │  │  │     Condition: i_brand_id_22 == i_brand_id_29, i_category_id_22 == i_category_id_29, i_class_id_22 == i_class_id_29
                        │  │  ├─ Repartition Exchange est. ? rows
                        │  │  │  │     Partition by: {i_brand_id_22, i_category_id_22, i_class_id_22}
                        │  │  │  └─ Projection est. ? rows
                        │  │  │     └─ MergingAggregated est. ? rows
                        │  │  │        └─ Repartition Exchange est. ? rows
                        │  │  │           │     Partition by: {i_brand_id_22, i_category_id_22, i_class_id_22}
                        │  │  │           └─ Aggregating est. ? rows
                        │  │  │              │     Group by: {i_brand_id_22, i_category_id_22, i_class_id_22}
                        │  │  │              └─ Projection est. ? rows
                        │  │  │                 └─ Inner Join est. ? rows
                        │  │  │                    │     Condition: i_item_sk_15 == i_item_sk_16
                        │  │  │                    ├─ Repartition Exchange est. ? rows
                        │  │  │                    │  │     Partition by: {i_item_sk_15}
                        │  │  │                    │  └─ Inner Join est. ? rows
                        │  │  │                    │     │     Condition: d_week_seq_21 == d_week_seq_22
                        │  │  │                    │     ├─ Repartition Exchange est. ? rows
                        │  │  │                    │     │  │     Partition by: {d_week_seq_21}
                        │  │  │                    │     │  └─ Inner Join est. ? rows
                        │  │  │                    │     │     │     Condition: ss_sold_date_sk_7 == d_date_sk_21
                        │  │  │                    │     │     ├─ Repartition Exchange est. ? rows
                        │  │  │                    │     │     │  │     Partition by: {ss_sold_date_sk_7}
                        │  │  │                    │     │     │  └─ Inner Join est. ? rows
                        │  │  │                    │     │     │     │     Condition: ss_item_sk_7 == i_item_sk_15
                        │  │  │                    │     │     │     ├─ Repartition Exchange est. ? rows
                        │  │  │                    │     │     │     │  │     Partition by: {ss_item_sk_7}
                        │  │  │                    │     │     │     │  └─ Filter est. ? rows
                        │  │  │                    │     │     │     │     │     isNotNull(ss_item_sk_7)
                        │  │  │                    │     │     │     │     └─ TableScan tpcds.store_sales est. ? rows
                        │  │  │                    │     │     │     └─ Repartition Exchange est. ? rows
                        │  │  │                    │     │     │        │     Partition by: {i_item_sk_15}
                        │  │  │                    │     │     │        └─ Filter est. ? rows
                        │  │  │                    │     │     │           │     isNotNull(i_item_sk_15)
                        │  │  │                    │     │     │           └─ TableScan tpcds.item est. ? rows
                        │  │  │                    │     │     └─ Repartition Exchange est. ? rows
                        │  │  │                    │     │        │     Partition by: {d_date_sk_21}
                        │  │  │                    │     │        └─ TableScan tpcds.date_dim est. ? rows
                        │  │  │                    │     └─ Repartition Exchange est. ? rows
                        │  │  │                    │        │     Partition by: {d_week_seq_22}
                        │  │  │                    │        └─ EnforceSingleRow est. ? rows
                        │  │  │                    │           └─ Union est. ? rows
                        │  │  │                    │              └─ Gather Exchange est. ? rows
                        │  │  │                    │                 └─ Projection est. ? rows
                        │  │  │                    │                    └─ Filter est. ? rows
                        │  │  │                    │                       │     (d_year_22 = cast(2000, 'UInt32')) AND (d_moy_22 = 12) AND (d_dom_22 = 11)
                        │  │  │                    │                       └─ TableScan tpcds.date_dim est. ? rows
                        │  │  │                    └─ MergingAggregated est. ? rows
                        │  │  │                       └─ Repartition Exchange est. ? rows
                        │  │  │                          │     Partition by: {i_item_sk_16}
                        │  │  │                          └─ Aggregating est. ? rows
                        │  │  │                             │     Group by: {i_item_sk_16}
                        │  │  │                             └─ Inner Join est. ? rows
                        │  │  │                                │     Condition: i_brand_id_23 == i_brand_id_28, i_category_id_23 == i_category_id_28, i_class_id_23 == i_class_id_28
                        │  │  │                                ├─ Repartition Exchange est. ? rows
                        │  │  │                                │  │     Partition by: {i_brand_id_23, i_category_id_23, i_class_id_23}
                        │  │  │                                │  └─ Filter est. ? rows
                        │  │  │                                │     │     isNotNull(i_item_sk_16)
                        │  │  │                                │     └─ TableScan tpcds.item est. ? rows
                        │  │  │                                └─ Repartition Exchange est. ? rows
                        │  │  │                                   │     Partition by: {i_brand_id_28, i_category_id_28, i_class_id_28}
                        │  │  │                                   └─ Filter est. ? rows
                        │  │  │                                      │     (sum_9 >= 1) AND (sum_11 >= 1) AND (sum_10 >= 1)
                        │  │  │                                      └─ MergingAggregated est. ? rows
                        │  │  │                                         └─ Repartition Exchange est. ? rows
                        │  │  │                                            │     Partition by: {i_brand_id_28, i_category_id_28, i_class_id_28}
                        │  │  │                                            └─ Aggregating est. ? rows
                        │  │  │                                               │     Group by: {i_brand_id_28, i_category_id_28, i_class_id_28}
                        │  │  │                                               └─ Union est. ? rows
                        │  │  │                                                  ├─ Projection est. ? rows
                        │  │  │                                                  │  └─ Inner Join est. ? rows
                        │  │  │                                                  │     │     Condition: ss_sold_date_sk_8 == d_date_sk_23
                        │  │  │                                                  │     ├─ Repartition Exchange est. ? rows
                        │  │  │                                                  │     │  │     Partition by: {ss_sold_date_sk_8}
                        │  │  │                                                  │     │  └─ Inner Join est. ? rows
                        │  │  │                                                  │     │     │     Condition: ss_item_sk_8 == i_item_sk_17
                        │  │  │                                                  │     │     ├─ Repartition Exchange est. ? rows
                        │  │  │                                                  │     │     │  │     Partition by: {ss_item_sk_8}
                        │  │  │                                                  │     │     │  └─ TableScan tpcds.store_sales est. ? rows
                        │  │  │                                                  │     │     └─ Repartition Exchange est. ? rows
                        │  │  │                                                  │     │        │     Partition by: {i_item_sk_17}
                        │  │  │                                                  │     │        └─ TableScan tpcds.item est. ? rows
                        │  │  │                                                  │     └─ Repartition Exchange est. ? rows
                        │  │  │                                                  │        │     Partition by: {d_date_sk_23}
                        │  │  │                                                  │        └─ Filter est. ? rows
                        │  │  │                                                  │           │     (d_year_23 <= cast(2001, 'UInt32')) AND (d_year_23 >= 1999)
                        │  │  │                                                  │           └─ TableScan tpcds.date_dim est. ? rows
                        │  │  │                                                  ├─ Projection est. ? rows
                        │  │  │                                                  │  └─ Inner Join est. ? rows
                        │  │  │                                                  │     │     Condition: cs_sold_date_sk_7 == d_date_sk_24
                        │  │  │                                                  │     ├─ Repartition Exchange est. ? rows
                        │  │  │                                                  │     │  │     Partition by: {cs_sold_date_sk_7}
                        │  │  │                                                  │     │  └─ Inner Join est. ? rows
                        │  │  │                                                  │     │     │     Condition: cs_item_sk_7 == i_item_sk_18
                        │  │  │                                                  │     │     ├─ Repartition Exchange est. ? rows
                        │  │  │                                                  │     │     │  │     Partition by: {cs_item_sk_7}
                        │  │  │                                                  │     │     │  └─ TableScan tpcds.catalog_sales est. ? rows
                        │  │  │                                                  │     │     └─ Repartition Exchange est. ? rows
                        │  │  │                                                  │     │        │     Partition by: {i_item_sk_18}
                        │  │  │                                                  │     │        └─ TableScan tpcds.item est. ? rows
                        │  │  │                                                  │     └─ Repartition Exchange est. ? rows
                        │  │  │                                                  │        │     Partition by: {d_date_sk_24}
                        │  │  │                                                  │        └─ Filter est. ? rows
                        │  │  │                                                  │           │     (d_year_24 <= cast(2001, 'UInt32')) AND (d_year_24 >= 1999)
                        │  │  │                                                  │           └─ TableScan tpcds.date_dim est. ? rows
                        │  │  │                                                  └─ Projection est. ? rows
                        │  │  │                                                     └─ Inner Join est. ? rows
                        │  │  │                                                        │     Condition: ws_sold_date_sk_7 == d_date_sk_25
                        │  │  │                                                        ├─ Repartition Exchange est. ? rows
                        │  │  │                                                        │  │     Partition by: {ws_sold_date_sk_7}
                        │  │  │                                                        │  └─ Inner Join est. ? rows
                        │  │  │                                                        │     │     Condition: ws_item_sk_7 == i_item_sk_19
                        │  │  │                                                        │     ├─ Repartition Exchange est. ? rows
                        │  │  │                                                        │     │  │     Partition by: {ws_item_sk_7}
                        │  │  │                                                        │     │  └─ TableScan tpcds.web_sales est. ? rows
                        │  │  │                                                        │     └─ Repartition Exchange est. ? rows
                        │  │  │                                                        │        │     Partition by: {i_item_sk_19}
                        │  │  │                                                        │        └─ TableScan tpcds.item est. ? rows
                        │  │  │                                                        └─ Repartition Exchange est. ? rows
                        │  │  │                                                           │     Partition by: {d_date_sk_25}
                        │  │  │                                                           └─ Filter est. ? rows
                        │  │  │                                                              │     (d_year_25 >= 1999) AND (d_year_25 <= cast(2001, 'UInt32'))
                        │  │  │                                                              └─ TableScan tpcds.date_dim est. ? rows
                        │  │  └─ Repartition Exchange est. ? rows
                        │  │     │     Partition by: {i_brand_id_29, i_category_id_29, i_class_id_29}
                        │  │     └─ Projection est. ? rows
                        │  │        └─ MergingAggregated est. ? rows
                        │  │           └─ Repartition Exchange est. ? rows
                        │  │              │     Partition by: {i_brand_id_29, i_category_id_29, i_class_id_29}
                        │  │              └─ Aggregating est. ? rows
                        │  │                 │     Group by: {i_brand_id_29, i_category_id_29, i_class_id_29}
                        │  │                 └─ Projection est. ? rows
                        │  │                    └─ Inner Join est. ? rows
                        │  │                       │     Condition: i_item_sk_20 == i_item_sk_21
                        │  │                       ├─ Repartition Exchange est. ? rows
                        │  │                       │  │     Partition by: {i_item_sk_20}
                        │  │                       │  └─ Inner Join est. ? rows
                        │  │                       │     │     Condition: d_week_seq_29 == d_week_seq_30
                        │  │                       │     ├─ Repartition Exchange est. ? rows
                        │  │                       │     │  │     Partition by: {d_week_seq_29}
                        │  │                       │     │  └─ Inner Join est. ? rows
                        │  │                       │     │     │     Condition: ss_sold_date_sk_10 == d_date_sk_29
                        │  │                       │     │     ├─ Repartition Exchange est. ? rows
                        │  │                       │     │     │  │     Partition by: {ss_sold_date_sk_10}
                        │  │                       │     │     │  └─ Inner Join est. ? rows
                        │  │                       │     │     │     │     Condition: ss_item_sk_10 == i_item_sk_20
                        │  │                       │     │     │     ├─ Repartition Exchange est. ? rows
                        │  │                       │     │     │     │  │     Partition by: {ss_item_sk_10}
                        │  │                       │     │     │     │  └─ Filter est. ? rows
                        │  │                       │     │     │     │     │     isNotNull(ss_item_sk_10)
                        │  │                       │     │     │     │     └─ TableScan tpcds.store_sales est. ? rows
                        │  │                       │     │     │     └─ Repartition Exchange est. ? rows
                        │  │                       │     │     │        │     Partition by: {i_item_sk_20}
                        │  │                       │     │     │        └─ Filter est. ? rows
                        │  │                       │     │     │           │     isNotNull(i_item_sk_20)
                        │  │                       │     │     │           └─ TableScan tpcds.item est. ? rows
                        │  │                       │     │     └─ Repartition Exchange est. ? rows
                        │  │                       │     │        │     Partition by: {d_date_sk_29}
                        │  │                       │     │        └─ TableScan tpcds.date_dim est. ? rows
                        │  │                       │     └─ Repartition Exchange est. ? rows
                        │  │                       │        │     Partition by: {d_week_seq_30}
                        │  │                       │        └─ EnforceSingleRow est. ? rows
                        │  │                       │           └─ Union est. ? rows
                        │  │                       │              └─ Gather Exchange est. ? rows
                        │  │                       │                 └─ Projection est. ? rows
                        │  │                       │                    └─ Filter est. ? rows
                        │  │                       │                       │     (d_dom_30 = 11) AND (d_moy_30 = 12) AND (d_year_30 = 1999)
                        │  │                       │                       └─ TableScan tpcds.date_dim est. ? rows
                        │  │                       └─ MergingAggregated est. ? rows
                        │  │                          └─ Repartition Exchange est. ? rows
                        │  │                             │     Partition by: {i_item_sk_21}
                        │  │                             └─ Aggregating est. ? rows
                        │  │                                │     Group by: {i_item_sk_21}
                        │  │                                └─ Inner Join est. ? rows
                        │  │                                   │     Condition: i_brand_id_30 == i_brand_id_35, i_category_id_30 == i_category_id_35, i_class_id_30 == i_class_id_35
                        │  │                                   ├─ Repartition Exchange est. ? rows
                        │  │                                   │  │     Partition by: {i_brand_id_30, i_category_id_30, i_class_id_30}
                        │  │                                   │  └─ Filter est. ? rows
                        │  │                                   │     │     isNotNull(i_item_sk_21)
                        │  │                                   │     └─ TableScan tpcds.item est. ? rows
                        │  │                                   └─ Repartition Exchange est. ? rows
                        │  │                                      │     Partition by: {i_brand_id_35, i_category_id_35, i_class_id_35}
                        │  │                                      └─ Filter est. ? rows
                        │  │                                         │     (sum_13 >= 1) AND (sum_14 >= 1) AND (sum_12 >= 1)
                        │  │                                         └─ MergingAggregated est. ? rows
                        │  │                                            └─ Repartition Exchange est. ? rows
                        │  │                                               │     Partition by: {i_brand_id_35, i_category_id_35, i_class_id_35}
                        │  │                                               └─ Aggregating est. ? rows
                        │  │                                                  │     Group by: {i_brand_id_35, i_category_id_35, i_class_id_35}
                        │  │                                                  └─ Union est. ? rows
                        │  │                                                     ├─ Projection est. ? rows
                        │  │                                                     │  └─ Inner Join est. ? rows
                        │  │                                                     │     │     Condition: ss_sold_date_sk_11 == d_date_sk_31
                        │  │                                                     │     ├─ Repartition Exchange est. ? rows
                        │  │                                                     │     │  │     Partition by: {ss_sold_date_sk_11}
                        │  │                                                     │     │  └─ Inner Join est. ? rows
                        │  │                                                     │     │     │     Condition: ss_item_sk_11 == i_item_sk_22
                        │  │                                                     │     │     ├─ Repartition Exchange est. ? rows
                        │  │                                                     │     │     │  │     Partition by: {ss_item_sk_11}
                        │  │                                                     │     │     │  └─ TableScan tpcds.store_sales est. ? rows
                        │  │                                                     │     │     └─ Repartition Exchange est. ? rows
                        │  │                                                     │     │        │     Partition by: {i_item_sk_22}
                        │  │                                                     │     │        └─ TableScan tpcds.item est. ? rows
                        │  │                                                     │     └─ Repartition Exchange est. ? rows
                        │  │                                                     │        │     Partition by: {d_date_sk_31}
                        │  │                                                     │        └─ Filter est. ? rows
                        │  │                                                     │           │     (d_year_31 >= 1999) AND (d_year_31 <= cast(2001, 'UInt32'))
                        │  │                                                     │           └─ TableScan tpcds.date_dim est. ? rows
                        │  │                                                     ├─ Projection est. ? rows
                        │  │                                                     │  └─ Inner Join est. ? rows
                        │  │                                                     │     │     Condition: cs_sold_date_sk_9 == d_date_sk_32
                        │  │                                                     │     ├─ Repartition Exchange est. ? rows
                        │  │                                                     │     │  │     Partition by: {cs_sold_date_sk_9}
                        │  │                                                     │     │  └─ Inner Join est. ? rows
                        │  │                                                     │     │     │     Condition: cs_item_sk_9 == i_item_sk_23
                        │  │                                                     │     │     ├─ Repartition Exchange est. ? rows
                        │  │                                                     │     │     │  │     Partition by: {cs_item_sk_9}
                        │  │                                                     │     │     │  └─ TableScan tpcds.catalog_sales est. ? rows
                        │  │                                                     │     │     └─ Repartition Exchange est. ? rows
                        │  │                                                     │     │        │     Partition by: {i_item_sk_23}
                        │  │                                                     │     │        └─ TableScan tpcds.item est. ? rows
                        │  │                                                     │     └─ Repartition Exchange est. ? rows
                        │  │                                                     │        │     Partition by: {d_date_sk_32}
                        │  │                                                     │        └─ Filter est. ? rows
                        │  │                                                     │           │     (d_year_32 >= 1999) AND (d_year_32 <= cast(2001, 'UInt32'))
                        │  │                                                     │           └─ TableScan tpcds.date_dim est. ? rows
                        │  │                                                     └─ Projection est. ? rows
                        │  │                                                        └─ Inner Join est. ? rows
                        │  │                                                           │     Condition: ws_sold_date_sk_9 == d_date_sk_33
                        │  │                                                           ├─ Repartition Exchange est. ? rows
                        │  │                                                           │  │     Partition by: {ws_sold_date_sk_9}
                        │  │                                                           │  └─ Inner Join est. ? rows
                        │  │                                                           │     │     Condition: ws_item_sk_9 == i_item_sk_24
                        │  │                                                           │     ├─ Repartition Exchange est. ? rows
                        │  │                                                           │     │  │     Partition by: {ws_item_sk_9}
                        │  │                                                           │     │  └─ TableScan tpcds.web_sales est. ? rows
                        │  │                                                           │     └─ Repartition Exchange est. ? rows
                        │  │                                                           │        │     Partition by: {i_item_sk_24}
                        │  │                                                           │        └─ TableScan tpcds.item est. ? rows
                        │  │                                                           └─ Repartition Exchange est. ? rows
                        │  │                                                              │     Partition by: {d_date_sk_33}
                        │  │                                                              └─ Filter est. ? rows
                        │  │                                                                 │     (d_year_33 <= cast(2001, 'UInt32')) AND (d_year_33 >= 1999)
                        │  │                                                                 └─ TableScan tpcds.date_dim est. ? rows
                        │  └─ Broadcast Exchange est. ? rows
                        │     └─ MergingAggregated est. ? rows
                        │        └─ Gather Exchange est. ? rows
                        │           └─ Aggregating est. ? rows
                        │              │     Group by: {}
                        │              └─ Projection est. ? rows
                        │                 └─ Union est. ? rows
                        │                    ├─ Inner Join est. ? rows
                        │                    │  │     Condition: ss_sold_date_sk_9 == d_date_sk_26
                        │                    │  ├─ Repartition Exchange est. ? rows
                        │                    │  │  │     Partition by: {ss_sold_date_sk_9}
                        │                    │  │  └─ TableScan tpcds.store_sales est. ? rows
                        │                    │  └─ Repartition Exchange est. ? rows
                        │                    │     │     Partition by: {d_date_sk_26}
                        │                    │     └─ Filter est. ? rows
                        │                    │        │     (d_year_26 <= cast(2001, 'UInt32')) AND (d_year_26 >= 1999)
                        │                    │        └─ TableScan tpcds.date_dim est. ? rows
                        │                    ├─ Inner Join est. ? rows
                        │                    │  │     Condition: cs_sold_date_sk_8 == d_date_sk_27
                        │                    │  ├─ Repartition Exchange est. ? rows
                        │                    │  │  │     Partition by: {cs_sold_date_sk_8}
                        │                    │  │  └─ TableScan tpcds.catalog_sales est. ? rows
                        │                    │  └─ Repartition Exchange est. ? rows
                        │                    │     │     Partition by: {d_date_sk_27}
                        │                    │     └─ Filter est. ? rows
                        │                    │        │     (d_year_27 >= 1999) AND (d_year_27 <= cast(2001, 'UInt32'))
                        │                    │        └─ TableScan tpcds.date_dim est. ? rows
                        │                    └─ Inner Join est. ? rows
                        │                       │     Condition: ws_sold_date_sk_8 == d_date_sk_28
                        │                       ├─ Repartition Exchange est. ? rows
                        │                       │  │     Partition by: {ws_sold_date_sk_8}
                        │                       │  └─ TableScan tpcds.web_sales est. ? rows
                        │                       └─ Repartition Exchange est. ? rows
                        │                          │     Partition by: {d_date_sk_28}
                        │                          └─ Filter est. ? rows
                        │                             │     (d_year_28 <= cast(2001, 'UInt32')) AND (d_year_28 >= 1999)
                        │                             └─ TableScan tpcds.date_dim est. ? rows
                        └─ Broadcast Exchange est. ? rows
                           └─ MergingAggregated est. ? rows
                              └─ Gather Exchange est. ? rows
                                 └─ Aggregating est. ? rows
                                    │     Group by: {}
                                    └─ Projection est. ? rows
                                       └─ Union est. ? rows
                                          ├─ Inner Join est. ? rows
                                          │  │     Condition: ss_sold_date_sk_12 == d_date_sk_34
                                          │  ├─ Repartition Exchange est. ? rows
                                          │  │  │     Partition by: {ss_sold_date_sk_12}
                                          │  │  └─ TableScan tpcds.store_sales est. ? rows
                                          │  └─ Repartition Exchange est. ? rows
                                          │     │     Partition by: {d_date_sk_34}
                                          │     └─ Filter est. ? rows
                                          │        │     (d_year_34 >= 1999) AND (d_year_34 <= cast(2001, 'UInt32'))
                                          │        └─ TableScan tpcds.date_dim est. ? rows
                                          ├─ Inner Join est. ? rows
                                          │  │     Condition: cs_sold_date_sk_10 == d_date_sk_35
                                          │  ├─ Repartition Exchange est. ? rows
                                          │  │  │     Partition by: {cs_sold_date_sk_10}
                                          │  │  └─ TableScan tpcds.catalog_sales est. ? rows
                                          │  └─ Repartition Exchange est. ? rows
                                          │     │     Partition by: {d_date_sk_35}
                                          │     └─ Filter est. ? rows
                                          │        │     (d_year_35 >= 1999) AND (d_year_35 <= cast(2001, 'UInt32'))
                                          │        └─ TableScan tpcds.date_dim est. ? rows
                                          └─ Inner Join est. ? rows
                                             │     Condition: ws_sold_date_sk_10 == d_date_sk_36
                                             ├─ Repartition Exchange est. ? rows
                                             │  │     Partition by: {ws_sold_date_sk_10}
                                             │  └─ TableScan tpcds.web_sales est. ? rows
                                             └─ Repartition Exchange est. ? rows
                                                │     Partition by: {d_date_sk_36}
                                                └─ Filter est. ? rows
                                                   │     (d_year_36 <= cast(2001, 'UInt32')) AND (d_year_36 >= 1999)
                                                   └─ TableScan tpcds.date_dim est. ? rows
