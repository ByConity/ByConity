Projection est. 100 rows
└─ Limit est. 100 rows
   └─ MergingSorted est. ? rows
      └─ MergeSorting est. ? rows
         └─ PartialSorting est. ? rows
            └─ Distinct est. ? rows
               └─ Union est. ? rows
                  └─ Union est. ? rows
                     ├─ Projection est. ? rows
                     │  └─ Filter est. ? rows
                     │     │     (`expr#rank() OVER (ORDER BY currency_ratio ASC)` <= 10) OR (`expr#rank() OVER (ORDER BY return_ratio ASC)` <= 10)
                     │     └─ Window est. ? rows
                     │        └─ Window est. ? rows
                     │           └─ Gather Exchange est. ? rows
                     │              └─ Projection est. ? rows
                     │                 └─ MergingAggregated est. ? rows
                     │                    └─ Repartition Exchange est. ? rows
                     │                       │     Partition by: {ws_item_sk}
                     │                       └─ Aggregating est. ? rows
                     │                          │     Group by: {ws_item_sk}
                     │                          └─ Projection est. ? rows
                     │                             └─ Inner Join est. ? rows
                     │                                │     Condition: ws_sold_date_sk == d_date_sk
                     │                                ├─ Repartition Exchange est. ? rows
                     │                                │  │     Partition by: {ws_sold_date_sk}
                     │                                │  └─ Inner Join est. ? rows
                     │                                │     │     Condition: ws_item_sk == wr_item_sk, ws_order_number == wr_order_number
                     │                                │     ├─ Repartition Exchange est. ? rows
                     │                                │     │  │     Partition by: {ws_item_sk, ws_order_number}
                     │                                │     │  └─ Filter est. ? rows
                     │                                │     │     │     (ws_net_profit > 1) AND (ws_net_paid > 0) AND (ws_quantity > 0)
                     │                                │     │     └─ TableScan tpcds.web_sales est. ? rows
                     │                                │     └─ Repartition Exchange est. ? rows
                     │                                │        │     Partition by: {wr_item_sk, wr_order_number}
                     │                                │        └─ Filter est. ? rows
                     │                                │           │     wr_return_amt > 10000
                     │                                │           └─ TableScan tpcds.web_returns est. ? rows
                     │                                └─ Repartition Exchange est. ? rows
                     │                                   │     Partition by: {d_date_sk}
                     │                                   └─ Filter est. ? rows
                     │                                      │     (d_year = 2001) AND (d_moy = 12)
                     │                                      └─ TableScan tpcds.date_dim est. ? rows
                     ├─ Projection est. ? rows
                     │  └─ Filter est. ? rows
                     │     │     (`expr#rank() OVER (ORDER BY return_ratio ASC)_1` <= 10) OR (`expr#rank() OVER (ORDER BY currency_ratio ASC)_1` <= 10)
                     │     └─ Window est. ? rows
                     │        └─ Window est. ? rows
                     │           └─ Gather Exchange est. ? rows
                     │              └─ Projection est. ? rows
                     │                 └─ MergingAggregated est. ? rows
                     │                    └─ Repartition Exchange est. ? rows
                     │                       │     Partition by: {cs_item_sk}
                     │                       └─ Aggregating est. ? rows
                     │                          │     Group by: {cs_item_sk}
                     │                          └─ Projection est. ? rows
                     │                             └─ Inner Join est. ? rows
                     │                                │     Condition: cs_sold_date_sk == d_date_sk_1
                     │                                ├─ Repartition Exchange est. ? rows
                     │                                │  │     Partition by: {cs_sold_date_sk}
                     │                                │  └─ Inner Join est. ? rows
                     │                                │     │     Condition: cs_item_sk == cr_item_sk, cs_order_number == cr_order_number
                     │                                │     ├─ Repartition Exchange est. ? rows
                     │                                │     │  │     Partition by: {cs_item_sk, cs_order_number}
                     │                                │     │  └─ Filter est. ? rows
                     │                                │     │     │     (cs_net_paid > 0) AND (cs_quantity > 0) AND (cs_net_profit > 1)
                     │                                │     │     └─ TableScan tpcds.catalog_sales est. ? rows
                     │                                │     └─ Repartition Exchange est. ? rows
                     │                                │        │     Partition by: {cr_item_sk, cr_order_number}
                     │                                │        └─ Filter est. ? rows
                     │                                │           │     cr_return_amount > 10000
                     │                                │           └─ TableScan tpcds.catalog_returns est. ? rows
                     │                                └─ Repartition Exchange est. ? rows
                     │                                   │     Partition by: {d_date_sk_1}
                     │                                   └─ Filter est. ? rows
                     │                                      │     (d_moy_1 = 12) AND (d_year_1 = 2001)
                     │                                      └─ TableScan tpcds.date_dim est. ? rows
                     └─ Projection est. ? rows
                        └─ Filter est. ? rows
                           │     (`expr#rank() OVER (ORDER BY return_ratio ASC)_2` <= 10) OR (`expr#rank() OVER (ORDER BY currency_ratio ASC)_2` <= 10)
                           └─ Window est. ? rows
                              └─ Window est. ? rows
                                 └─ Gather Exchange est. ? rows
                                    └─ Projection est. ? rows
                                       └─ MergingAggregated est. ? rows
                                          └─ Repartition Exchange est. ? rows
                                             │     Partition by: {ss_item_sk}
                                             └─ Aggregating est. ? rows
                                                │     Group by: {ss_item_sk}
                                                └─ Projection est. ? rows
                                                   └─ Inner Join est. ? rows
                                                      │     Condition: ss_sold_date_sk == d_date_sk_2
                                                      ├─ Repartition Exchange est. ? rows
                                                      │  │     Partition by: {ss_sold_date_sk}
                                                      │  └─ Inner Join est. ? rows
                                                      │     │     Condition: ss_item_sk == sr_item_sk, ss_ticket_number == sr_ticket_number
                                                      │     ├─ Repartition Exchange est. ? rows
                                                      │     │  │     Partition by: {ss_item_sk, ss_ticket_number}
                                                      │     │  └─ Filter est. ? rows
                                                      │     │     │     (ss_net_paid > 0) AND (ss_net_profit > 1) AND (ss_quantity > 0)
                                                      │     │     └─ TableScan tpcds.store_sales est. ? rows
                                                      │     └─ Repartition Exchange est. ? rows
                                                      │        │     Partition by: {sr_item_sk, sr_ticket_number}
                                                      │        └─ Filter est. ? rows
                                                      │           │     sr_return_amt > 10000
                                                      │           └─ TableScan tpcds.store_returns est. ? rows
                                                      └─ Repartition Exchange est. ? rows
                                                         │     Partition by: {d_date_sk_2}
                                                         └─ Filter est. ? rows
                                                            │     (d_year_2 = 2001) AND (d_moy_2 = 12)
                                                            └─ TableScan tpcds.date_dim est. ? rows
