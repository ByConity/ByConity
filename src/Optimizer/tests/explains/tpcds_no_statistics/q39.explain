Projection est. ? rows
└─ MergingSorted est. ? rows
   └─ MergeSorting est. ? rows
      └─ PartialSorting est. ? rows
         └─ Gather Exchange est. ? rows
            └─ MergeSorting est. ? rows
               └─ PartialSorting est. ? rows
                  └─ Inner Join est. ? rows
                     │     Condition: i_item_sk == i_item_sk_1, w_warehouse_sk == w_warehouse_sk_1
                     ├─ Repartition Exchange est. ? rows
                     │  │     Partition by: {i_item_sk, w_warehouse_sk}
                     │  └─ Projection est. ? rows
                     │     └─ Filter est. ? rows
                     │        │     if(`expr#avg(inv_quantity_on_hand)` = 0, 0, `expr#stddevSamp(inv_quantity_on_hand)` / `expr#avg(inv_quantity_on_hand)`) > 1
                     │        └─ MergingAggregated est. ? rows
                     │           └─ Repartition Exchange est. ? rows
                     │              │     Partition by: {d_moy, i_item_sk, w_warehouse_name, w_warehouse_sk}
                     │              └─ Aggregating est. ? rows
                     │                 │     Group by: {d_moy, i_item_sk, w_warehouse_name, w_warehouse_sk}
                     │                 └─ Inner Join est. ? rows
                     │                    │     Condition: inv_date_sk == d_date_sk
                     │                    ├─ Repartition Exchange est. ? rows
                     │                    │  │     Partition by: {inv_date_sk}
                     │                    │  └─ Inner Join est. ? rows
                     │                    │     │     Condition: inv_warehouse_sk == w_warehouse_sk
                     │                    │     ├─ Repartition Exchange est. ? rows
                     │                    │     │  │     Partition by: {inv_warehouse_sk}
                     │                    │     │  └─ Inner Join est. ? rows
                     │                    │     │     │     Condition: inv_item_sk == i_item_sk
                     │                    │     │     ├─ Repartition Exchange est. ? rows
                     │                    │     │     │  │     Partition by: {inv_item_sk}
                     │                    │     │     │  └─ TableScan tpcds.inventory est. ? rows
                     │                    │     │     └─ Repartition Exchange est. ? rows
                     │                    │     │        │     Partition by: {i_item_sk}
                     │                    │     │        └─ TableScan tpcds.item est. ? rows
                     │                    │     └─ Repartition Exchange est. ? rows
                     │                    │        │     Partition by: {w_warehouse_sk}
                     │                    │        └─ TableScan tpcds.warehouse est. ? rows
                     │                    └─ Repartition Exchange est. ? rows
                     │                       │     Partition by: {d_date_sk}
                     │                       └─ Filter est. ? rows
                     │                          │     (d_year = 2001) AND (d_moy = 1)
                     │                          └─ TableScan tpcds.date_dim est. ? rows
                     └─ Repartition Exchange est. ? rows
                        │     Partition by: {i_item_sk_1, w_warehouse_sk_1}
                        └─ Projection est. ? rows
                           └─ Filter est. ? rows
                              │     if(`expr#avg(inv_quantity_on_hand)_1` = 0, 0, `expr#stddevSamp(inv_quantity_on_hand)_1` / `expr#avg(inv_quantity_on_hand)_1`) > 1
                              └─ MergingAggregated est. ? rows
                                 └─ Repartition Exchange est. ? rows
                                    │     Partition by: {d_moy_1, i_item_sk_1, w_warehouse_name_1, w_warehouse_sk_1}
                                    └─ Aggregating est. ? rows
                                       │     Group by: {d_moy_1, i_item_sk_1, w_warehouse_name_1, w_warehouse_sk_1}
                                       └─ Inner Join est. ? rows
                                          │     Condition: inv_date_sk_1 == d_date_sk_1
                                          ├─ Repartition Exchange est. ? rows
                                          │  │     Partition by: {inv_date_sk_1}
                                          │  └─ Inner Join est. ? rows
                                          │     │     Condition: inv_warehouse_sk_1 == w_warehouse_sk_1
                                          │     ├─ Repartition Exchange est. ? rows
                                          │     │  │     Partition by: {inv_warehouse_sk_1}
                                          │     │  └─ Inner Join est. ? rows
                                          │     │     │     Condition: inv_item_sk_1 == i_item_sk_1
                                          │     │     ├─ Repartition Exchange est. ? rows
                                          │     │     │  │     Partition by: {inv_item_sk_1}
                                          │     │     │  └─ TableScan tpcds.inventory est. ? rows
                                          │     │     └─ Repartition Exchange est. ? rows
                                          │     │        │     Partition by: {i_item_sk_1}
                                          │     │        └─ TableScan tpcds.item est. ? rows
                                          │     └─ Repartition Exchange est. ? rows
                                          │        │     Partition by: {w_warehouse_sk_1}
                                          │        └─ TableScan tpcds.warehouse est. ? rows
                                          └─ Repartition Exchange est. ? rows
                                             │     Partition by: {d_date_sk_1}
                                             └─ Filter est. ? rows
                                                │     (d_moy_1 = cast(2, 'UInt16')) AND (d_year_1 = 2001)
                                                └─ TableScan tpcds.date_dim est. ? rows
Projection est. ? rows
└─ MergingSorted est. ? rows
   └─ MergeSorting est. ? rows
      └─ PartialSorting est. ? rows
         └─ Gather Exchange est. ? rows
            └─ MergeSorting est. ? rows
               └─ PartialSorting est. ? rows
                  └─ Inner Join est. ? rows
                     │     Condition: i_item_sk_2 == i_item_sk_3, w_warehouse_sk_2 == w_warehouse_sk_3
                     ├─ Repartition Exchange est. ? rows
                     │  │     Partition by: {i_item_sk_2, w_warehouse_sk_2}
                     │  └─ Projection est. ? rows
                     │     └─ Filter est. ? rows
                     │        │     (if(`expr#avg(inv_quantity_on_hand)_2` = 0, 0, `expr#stddevSamp(inv_quantity_on_hand)_2` / `expr#avg(inv_quantity_on_hand)_2`) > 1) AND (if(`expr#avg(inv_quantity_on_hand)_2` = 0, NULL, `expr#stddevSamp(inv_quantity_on_hand)_2` / `expr#avg(inv_quantity_on_hand)_2`) > 1.5)
                     │        └─ MergingAggregated est. ? rows
                     │           └─ Repartition Exchange est. ? rows
                     │              │     Partition by: {d_moy_2, i_item_sk_2, w_warehouse_name_2, w_warehouse_sk_2}
                     │              └─ Aggregating est. ? rows
                     │                 │     Group by: {d_moy_2, i_item_sk_2, w_warehouse_name_2, w_warehouse_sk_2}
                     │                 └─ Inner Join est. ? rows
                     │                    │     Condition: inv_date_sk_2 == d_date_sk_2
                     │                    ├─ Repartition Exchange est. ? rows
                     │                    │  │     Partition by: {inv_date_sk_2}
                     │                    │  └─ Inner Join est. ? rows
                     │                    │     │     Condition: inv_warehouse_sk_2 == w_warehouse_sk_2
                     │                    │     ├─ Repartition Exchange est. ? rows
                     │                    │     │  │     Partition by: {inv_warehouse_sk_2}
                     │                    │     │  └─ Inner Join est. ? rows
                     │                    │     │     │     Condition: inv_item_sk_2 == i_item_sk_2
                     │                    │     │     ├─ Repartition Exchange est. ? rows
                     │                    │     │     │  │     Partition by: {inv_item_sk_2}
                     │                    │     │     │  └─ TableScan tpcds.inventory est. ? rows
                     │                    │     │     └─ Repartition Exchange est. ? rows
                     │                    │     │        │     Partition by: {i_item_sk_2}
                     │                    │     │        └─ TableScan tpcds.item est. ? rows
                     │                    │     └─ Repartition Exchange est. ? rows
                     │                    │        │     Partition by: {w_warehouse_sk_2}
                     │                    │        └─ TableScan tpcds.warehouse est. ? rows
                     │                    └─ Repartition Exchange est. ? rows
                     │                       │     Partition by: {d_date_sk_2}
                     │                       └─ Filter est. ? rows
                     │                          │     (d_moy_2 = 1) AND (d_year_2 = 2001)
                     │                          └─ TableScan tpcds.date_dim est. ? rows
                     └─ Repartition Exchange est. ? rows
                        │     Partition by: {i_item_sk_3, w_warehouse_sk_3}
                        └─ Projection est. ? rows
                           └─ Filter est. ? rows
                              │     if(`expr#avg(inv_quantity_on_hand)_3` = 0, 0, `expr#stddevSamp(inv_quantity_on_hand)_3` / `expr#avg(inv_quantity_on_hand)_3`) > 1
                              └─ MergingAggregated est. ? rows
                                 └─ Repartition Exchange est. ? rows
                                    │     Partition by: {d_moy_3, i_item_sk_3, w_warehouse_name_3, w_warehouse_sk_3}
                                    └─ Aggregating est. ? rows
                                       │     Group by: {d_moy_3, i_item_sk_3, w_warehouse_name_3, w_warehouse_sk_3}
                                       └─ Inner Join est. ? rows
                                          │     Condition: inv_date_sk_3 == d_date_sk_3
                                          ├─ Repartition Exchange est. ? rows
                                          │  │     Partition by: {inv_date_sk_3}
                                          │  └─ Inner Join est. ? rows
                                          │     │     Condition: inv_warehouse_sk_3 == w_warehouse_sk_3
                                          │     ├─ Repartition Exchange est. ? rows
                                          │     │  │     Partition by: {inv_warehouse_sk_3}
                                          │     │  └─ Inner Join est. ? rows
                                          │     │     │     Condition: inv_item_sk_3 == i_item_sk_3
                                          │     │     ├─ Repartition Exchange est. ? rows
                                          │     │     │  │     Partition by: {inv_item_sk_3}
                                          │     │     │  └─ TableScan tpcds.inventory est. ? rows
                                          │     │     └─ Repartition Exchange est. ? rows
                                          │     │        │     Partition by: {i_item_sk_3}
                                          │     │        └─ TableScan tpcds.item est. ? rows
                                          │     └─ Repartition Exchange est. ? rows
                                          │        │     Partition by: {w_warehouse_sk_3}
                                          │        └─ TableScan tpcds.warehouse est. ? rows
                                          └─ Repartition Exchange est. ? rows
                                             │     Partition by: {d_date_sk_3}
                                             └─ Filter est. ? rows
                                                │     (d_moy_3 = cast(2, 'UInt16')) AND (d_year_3 = 2001)
                                                └─ TableScan tpcds.date_dim est. ? rows
