Projection est. 100 rows
└─ Limit est. 100 rows
   └─ MergingSorted est. ? rows
      └─ MergeSorting est. ? rows
         └─ PartialSorting est. ? rows
            └─ Gather Exchange est. ? rows
               └─ MergeSorting est. ? rows
                  └─ PartialSorting est. ? rows
                     └─ MergingAggregated est. ? rows
                        └─ Repartition Exchange est. ? rows
                           │     Partition by: {d_week_seq, i_item_desc, w_warehouse_name}
                           └─ Aggregating est. ? rows
                              │     Group by: {d_week_seq, i_item_desc, w_warehouse_name}
                              └─ Projection est. ? rows
                                 └─ Left Join est. ? rows
                                    │     Condition: cs_item_sk == cr_item_sk, cs_order_number == cr_order_number
                                    ├─ Repartition Exchange est. ? rows
                                    │  │     Partition by: {cs_item_sk, cs_order_number}
                                    │  └─ Left Join est. ? rows
                                    │     │     Condition: cs_promo_sk == p_promo_sk
                                    │     ├─ Repartition Exchange est. ? rows
                                    │     │  │     Partition by: {cs_promo_sk}
                                    │     │  └─ Inner Join est. ? rows
                                    │     │     │     Condition: cs_ship_date_sk == d_date_sk_2
                                    │     │     │     Filter: d_date_2 > (d_date + toIntervalDay(5))
                                    │     │     ├─ Repartition Exchange est. ? rows
                                    │     │     │  │     Partition by: {cs_ship_date_sk}
                                    │     │     │  └─ Inner Join est. ? rows
                                    │     │     │     │     Condition: d_week_seq == d_week_seq_1, inv_date_sk == d_date_sk_1
                                    │     │     │     ├─ Repartition Exchange est. ? rows
                                    │     │     │     │  │     Partition by: {d_week_seq, inv_date_sk}
                                    │     │     │     │  └─ Inner Join est. ? rows
                                    │     │     │     │     │     Condition: cs_sold_date_sk == d_date_sk
                                    │     │     │     │     ├─ Repartition Exchange est. ? rows
                                    │     │     │     │     │  │     Partition by: {cs_sold_date_sk}
                                    │     │     │     │     │  └─ Inner Join est. ? rows
                                    │     │     │     │     │     │     Condition: cs_bill_hdemo_sk == hd_demo_sk
                                    │     │     │     │     │     ├─ Repartition Exchange est. ? rows
                                    │     │     │     │     │     │  │     Partition by: {cs_bill_hdemo_sk}
                                    │     │     │     │     │     │  └─ Inner Join est. ? rows
                                    │     │     │     │     │     │     │     Condition: cs_bill_cdemo_sk == cd_demo_sk
                                    │     │     │     │     │     │     ├─ Repartition Exchange est. ? rows
                                    │     │     │     │     │     │     │  │     Partition by: {cs_bill_cdemo_sk}
                                    │     │     │     │     │     │     │  └─ Inner Join est. ? rows
                                    │     │     │     │     │     │     │     │     Condition: cs_item_sk == i_item_sk
                                    │     │     │     │     │     │     │     ├─ Repartition Exchange est. ? rows
                                    │     │     │     │     │     │     │     │  │     Partition by: {cs_item_sk}
                                    │     │     │     │     │     │     │     │  └─ Inner Join est. ? rows
                                    │     │     │     │     │     │     │     │     │     Condition: inv_warehouse_sk == w_warehouse_sk
                                    │     │     │     │     │     │     │     │     ├─ Repartition Exchange est. ? rows
                                    │     │     │     │     │     │     │     │     │  │     Partition by: {inv_warehouse_sk}
                                    │     │     │     │     │     │     │     │     │  └─ Inner Join est. ? rows
                                    │     │     │     │     │     │     │     │     │     │     Condition: cs_item_sk == inv_item_sk
                                    │     │     │     │     │     │     │     │     │     │     Filter: inv_quantity_on_hand < cs_quantity
                                    │     │     │     │     │     │     │     │     │     ├─ Repartition Exchange est. ? rows
                                    │     │     │     │     │     │     │     │     │     │  │     Partition by: {cs_item_sk}
                                    │     │     │     │     │     │     │     │     │     │  └─ TableScan tpcds.catalog_sales est. ? rows
                                    │     │     │     │     │     │     │     │     │     └─ Repartition Exchange est. ? rows
                                    │     │     │     │     │     │     │     │     │        │     Partition by: {inv_item_sk}
                                    │     │     │     │     │     │     │     │     │        └─ TableScan tpcds.inventory est. ? rows
                                    │     │     │     │     │     │     │     │     └─ Repartition Exchange est. ? rows
                                    │     │     │     │     │     │     │     │        │     Partition by: {w_warehouse_sk}
                                    │     │     │     │     │     │     │     │        └─ TableScan tpcds.warehouse est. ? rows
                                    │     │     │     │     │     │     │     └─ Repartition Exchange est. ? rows
                                    │     │     │     │     │     │     │        │     Partition by: {i_item_sk}
                                    │     │     │     │     │     │     │        └─ TableScan tpcds.item est. ? rows
                                    │     │     │     │     │     │     └─ Repartition Exchange est. ? rows
                                    │     │     │     │     │     │        │     Partition by: {cd_demo_sk}
                                    │     │     │     │     │     │        └─ Filter est. ? rows
                                    │     │     │     │     │     │           │     cd_marital_status = 'D'
                                    │     │     │     │     │     │           └─ TableScan tpcds.customer_demographics est. ? rows
                                    │     │     │     │     │     └─ Repartition Exchange est. ? rows
                                    │     │     │     │     │        │     Partition by: {hd_demo_sk}
                                    │     │     │     │     │        └─ Filter est. ? rows
                                    │     │     │     │     │           │     hd_buy_potential = '>10000'
                                    │     │     │     │     │           └─ TableScan tpcds.household_demographics est. ? rows
                                    │     │     │     │     └─ Repartition Exchange est. ? rows
                                    │     │     │     │        │     Partition by: {d_date_sk}
                                    │     │     │     │        └─ Filter est. ? rows
                                    │     │     │     │           │     d_year = 1999
                                    │     │     │     │           └─ TableScan tpcds.date_dim est. ? rows
                                    │     │     │     └─ Repartition Exchange est. ? rows
                                    │     │     │        │     Partition by: {d_date_sk_1, d_week_seq_1}
                                    │     │     │        └─ TableScan tpcds.date_dim est. ? rows
                                    │     │     └─ Repartition Exchange est. ? rows
                                    │     │        │     Partition by: {d_date_sk_2}
                                    │     │        └─ TableScan tpcds.date_dim est. ? rows
                                    │     └─ Repartition Exchange est. ? rows
                                    │        │     Partition by: {p_promo_sk}
                                    │        └─ TableScan tpcds.promotion est. ? rows
                                    └─ Repartition Exchange est. ? rows
                                       │     Partition by: {cr_item_sk, cr_order_number}
                                       └─ TableScan tpcds.catalog_returns est. ? rows
