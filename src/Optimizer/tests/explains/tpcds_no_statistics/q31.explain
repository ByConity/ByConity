Projection est. ? rows
└─ MergingSorted est. ? rows
   └─ MergeSorting est. ? rows
      └─ PartialSorting est. ? rows
         └─ Gather Exchange est. ? rows
            └─ MergeSorting est. ? rows
               └─ PartialSorting est. ? rows
                  └─ Projection est. ? rows
                     └─ Inner Join est. ? rows
                        │     Condition: ca_county == ca_county_5
                        │     Filter: multiIf(`expr#sum(ws_ext_sales_price)_1` > 0, `expr#sum(ws_ext_sales_price)_2` / `expr#sum(ws_ext_sales_price)_1`, NULL) > multiIf(`expr#sum(ss_ext_sales_price)_1` > 0, `expr#sum(ss_ext_sales_price)_2` / `expr#sum(ss_ext_sales_price)_1`, NULL)
                        ├─ Inner Join est. ? rows
                        │  │     Condition: ca_county == ca_county_4
                        │  │     Filter: multiIf(`expr#sum(ws_ext_sales_price)` > 0, `expr#sum(ws_ext_sales_price)_1` / `expr#sum(ws_ext_sales_price)`, NULL) > multiIf(`expr#sum(ss_ext_sales_price)` > 0, `expr#sum(ss_ext_sales_price)_1` / `expr#sum(ss_ext_sales_price)`, NULL)
                        │  ├─ Inner Join est. ? rows
                        │  │  │     Condition: ca_county == ca_county_3
                        │  │  ├─ Inner Join est. ? rows
                        │  │  │  │     Condition: ca_county == ca_county_2
                        │  │  │  ├─ Inner Join est. ? rows
                        │  │  │  │  │     Condition: ca_county == ca_county_1
                        │  │  │  │  ├─ Repartition Exchange est. ? rows
                        │  │  │  │  │  │     Partition by: {ca_county}
                        │  │  │  │  │  └─ MergingAggregated est. ? rows
                        │  │  │  │  │     └─ Repartition Exchange est. ? rows
                        │  │  │  │  │        │     Partition by: {ca_county, d_qoy, d_year}
                        │  │  │  │  │        └─ Aggregating est. ? rows
                        │  │  │  │  │           │     Group by: {ca_county, d_qoy, d_year}
                        │  │  │  │  │           └─ Inner Join est. ? rows
                        │  │  │  │  │              │     Condition: ss_addr_sk == ca_address_sk
                        │  │  │  │  │              ├─ Repartition Exchange est. ? rows
                        │  │  │  │  │              │  │     Partition by: {ss_addr_sk}
                        │  │  │  │  │              │  └─ Inner Join est. ? rows
                        │  │  │  │  │              │     │     Condition: ss_sold_date_sk == d_date_sk
                        │  │  │  │  │              │     ├─ Repartition Exchange est. ? rows
                        │  │  │  │  │              │     │  │     Partition by: {ss_sold_date_sk}
                        │  │  │  │  │              │     │  └─ TableScan tpcds.store_sales est. ? rows
                        │  │  │  │  │              │     └─ Repartition Exchange est. ? rows
                        │  │  │  │  │              │        │     Partition by: {d_date_sk}
                        │  │  │  │  │              │        └─ Filter est. ? rows
                        │  │  │  │  │              │           │     (d_qoy = 1) AND (d_year = 2000)
                        │  │  │  │  │              │           └─ TableScan tpcds.date_dim est. ? rows
                        │  │  │  │  │              └─ Repartition Exchange est. ? rows
                        │  │  │  │  │                 │     Partition by: {ca_address_sk}
                        │  │  │  │  │                 └─ TableScan tpcds.customer_address est. ? rows
                        │  │  │  │  └─ Repartition Exchange est. ? rows
                        │  │  │  │     │     Partition by: {ca_county_1}
                        │  │  │  │     └─ MergingAggregated est. ? rows
                        │  │  │  │        └─ Repartition Exchange est. ? rows
                        │  │  │  │           │     Partition by: {ca_county_1, d_qoy_1, d_year_1}
                        │  │  │  │           └─ Aggregating est. ? rows
                        │  │  │  │              │     Group by: {ca_county_1, d_qoy_1, d_year_1}
                        │  │  │  │              └─ Inner Join est. ? rows
                        │  │  │  │                 │     Condition: ss_addr_sk_1 == ca_address_sk_1
                        │  │  │  │                 ├─ Repartition Exchange est. ? rows
                        │  │  │  │                 │  │     Partition by: {ss_addr_sk_1}
                        │  │  │  │                 │  └─ Inner Join est. ? rows
                        │  │  │  │                 │     │     Condition: ss_sold_date_sk_1 == d_date_sk_1
                        │  │  │  │                 │     ├─ Repartition Exchange est. ? rows
                        │  │  │  │                 │     │  │     Partition by: {ss_sold_date_sk_1}
                        │  │  │  │                 │     │  └─ TableScan tpcds.store_sales est. ? rows
                        │  │  │  │                 │     └─ Repartition Exchange est. ? rows
                        │  │  │  │                 │        │     Partition by: {d_date_sk_1}
                        │  │  │  │                 │        └─ Filter est. ? rows
                        │  │  │  │                 │           │     (d_qoy_1 = 2) AND (d_year_1 = 2000)
                        │  │  │  │                 │           └─ TableScan tpcds.date_dim est. ? rows
                        │  │  │  │                 └─ Repartition Exchange est. ? rows
                        │  │  │  │                    │     Partition by: {ca_address_sk_1}
                        │  │  │  │                    └─ TableScan tpcds.customer_address est. ? rows
                        │  │  │  └─ Repartition Exchange est. ? rows
                        │  │  │     │     Partition by: {ca_county_2}
                        │  │  │     └─ MergingAggregated est. ? rows
                        │  │  │        └─ Repartition Exchange est. ? rows
                        │  │  │           │     Partition by: {ca_county_2, d_qoy_2, d_year_2}
                        │  │  │           └─ Aggregating est. ? rows
                        │  │  │              │     Group by: {ca_county_2, d_qoy_2, d_year_2}
                        │  │  │              └─ Inner Join est. ? rows
                        │  │  │                 │     Condition: ss_addr_sk_2 == ca_address_sk_2
                        │  │  │                 ├─ Repartition Exchange est. ? rows
                        │  │  │                 │  │     Partition by: {ss_addr_sk_2}
                        │  │  │                 │  └─ Inner Join est. ? rows
                        │  │  │                 │     │     Condition: ss_sold_date_sk_2 == d_date_sk_2
                        │  │  │                 │     ├─ Repartition Exchange est. ? rows
                        │  │  │                 │     │  │     Partition by: {ss_sold_date_sk_2}
                        │  │  │                 │     │  └─ TableScan tpcds.store_sales est. ? rows
                        │  │  │                 │     └─ Repartition Exchange est. ? rows
                        │  │  │                 │        │     Partition by: {d_date_sk_2}
                        │  │  │                 │        └─ Filter est. ? rows
                        │  │  │                 │           │     (d_year_2 = 2000) AND (d_qoy_2 = 3)
                        │  │  │                 │           └─ TableScan tpcds.date_dim est. ? rows
                        │  │  │                 └─ Repartition Exchange est. ? rows
                        │  │  │                    │     Partition by: {ca_address_sk_2}
                        │  │  │                    └─ TableScan tpcds.customer_address est. ? rows
                        │  │  └─ Repartition Exchange est. ? rows
                        │  │     │     Partition by: {ca_county_3}
                        │  │     └─ MergingAggregated est. ? rows
                        │  │        └─ Repartition Exchange est. ? rows
                        │  │           │     Partition by: {ca_county_3, d_qoy_3, d_year_3}
                        │  │           └─ Aggregating est. ? rows
                        │  │              │     Group by: {ca_county_3, d_qoy_3, d_year_3}
                        │  │              └─ Inner Join est. ? rows
                        │  │                 │     Condition: ws_bill_addr_sk == ca_address_sk_3
                        │  │                 ├─ Repartition Exchange est. ? rows
                        │  │                 │  │     Partition by: {ws_bill_addr_sk}
                        │  │                 │  └─ Inner Join est. ? rows
                        │  │                 │     │     Condition: ws_sold_date_sk == d_date_sk_3
                        │  │                 │     ├─ Repartition Exchange est. ? rows
                        │  │                 │     │  │     Partition by: {ws_sold_date_sk}
                        │  │                 │     │  └─ TableScan tpcds.web_sales est. ? rows
                        │  │                 │     └─ Repartition Exchange est. ? rows
                        │  │                 │        │     Partition by: {d_date_sk_3}
                        │  │                 │        └─ Filter est. ? rows
                        │  │                 │           │     (d_qoy_3 = 1) AND (d_year_3 = 2000)
                        │  │                 │           └─ TableScan tpcds.date_dim est. ? rows
                        │  │                 └─ Repartition Exchange est. ? rows
                        │  │                    │     Partition by: {ca_address_sk_3}
                        │  │                    └─ TableScan tpcds.customer_address est. ? rows
                        │  └─ Repartition Exchange est. ? rows
                        │     │     Partition by: {ca_county_4}
                        │     └─ MergingAggregated est. ? rows
                        │        └─ Repartition Exchange est. ? rows
                        │           │     Partition by: {ca_county_4, d_qoy_4, d_year_4}
                        │           └─ Aggregating est. ? rows
                        │              │     Group by: {ca_county_4, d_qoy_4, d_year_4}
                        │              └─ Inner Join est. ? rows
                        │                 │     Condition: ws_bill_addr_sk_1 == ca_address_sk_4
                        │                 ├─ Repartition Exchange est. ? rows
                        │                 │  │     Partition by: {ws_bill_addr_sk_1}
                        │                 │  └─ Inner Join est. ? rows
                        │                 │     │     Condition: ws_sold_date_sk_1 == d_date_sk_4
                        │                 │     ├─ Repartition Exchange est. ? rows
                        │                 │     │  │     Partition by: {ws_sold_date_sk_1}
                        │                 │     │  └─ TableScan tpcds.web_sales est. ? rows
                        │                 │     └─ Repartition Exchange est. ? rows
                        │                 │        │     Partition by: {d_date_sk_4}
                        │                 │        └─ Filter est. ? rows
                        │                 │           │     (d_year_4 = 2000) AND (d_qoy_4 = 2)
                        │                 │           └─ TableScan tpcds.date_dim est. ? rows
                        │                 └─ Repartition Exchange est. ? rows
                        │                    │     Partition by: {ca_address_sk_4}
                        │                    └─ TableScan tpcds.customer_address est. ? rows
                        └─ Repartition Exchange est. ? rows
                           │     Partition by: {ca_county_5}
                           └─ MergingAggregated est. ? rows
                              └─ Repartition Exchange est. ? rows
                                 │     Partition by: {ca_county_5, d_qoy_5, d_year_5}
                                 └─ Aggregating est. ? rows
                                    │     Group by: {ca_county_5, d_qoy_5, d_year_5}
                                    └─ Inner Join est. ? rows
                                       │     Condition: ws_bill_addr_sk_2 == ca_address_sk_5
                                       ├─ Repartition Exchange est. ? rows
                                       │  │     Partition by: {ws_bill_addr_sk_2}
                                       │  └─ Inner Join est. ? rows
                                       │     │     Condition: ws_sold_date_sk_2 == d_date_sk_5
                                       │     ├─ Repartition Exchange est. ? rows
                                       │     │  │     Partition by: {ws_sold_date_sk_2}
                                       │     │  └─ TableScan tpcds.web_sales est. ? rows
                                       │     └─ Repartition Exchange est. ? rows
                                       │        │     Partition by: {d_date_sk_5}
                                       │        └─ Filter est. ? rows
                                       │           │     (d_year_5 = 2000) AND (d_qoy_5 = 3)
                                       │           └─ TableScan tpcds.date_dim est. ? rows
                                       └─ Repartition Exchange est. ? rows
                                          │     Partition by: {ca_address_sk_5}
                                          └─ TableScan tpcds.customer_address est. ? rows
