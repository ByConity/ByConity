Projection est. 22537835082 rows
└─ MergingSorted est. 22537835082 rows
   └─ MergeSorting est. 22537835082 rows
      └─ PartialSorting est. 22537835082 rows
         └─ Gather Exchange est. 22537835082 rows
            └─ MergeSorting est. 22537835082 rows
               └─ PartialSorting est. 22537835082 rows
                  └─ Inner Join est. 22537835082 rows
                     │     Condition: i_item_sk == i_item_sk_1, w_warehouse_sk == w_warehouse_sk_1
                     ├─ Repartition Exchange est. 80690839 rows
                     │  │     Partition by: {i_item_sk, w_warehouse_sk}
                     │  └─ Projection est. 80690839 rows
                     │     └─ Filter est. 80690839 rows
                     │        │     if(`expr#avg(inv_quantity_on_hand)` = 0, 0, `expr#stddevSamp(inv_quantity_on_hand)` / `expr#avg(inv_quantity_on_hand)`) > 1
                     │        └─ MergingAggregated est. 89656488 rows
                     │           └─ Repartition Exchange est. 89656488 rows
                     │              │     Partition by: {d_moy, i_item_sk, w_warehouse_name, w_warehouse_sk}
                     │              └─ Aggregating est. 89656488 rows
                     │                 │     Group by: {d_moy, i_item_sk, w_warehouse_name, w_warehouse_sk}
                     │                 └─ Inner Join est. 89656488 rows
                     │                    │     Condition: inv_warehouse_sk == w_warehouse_sk
                     │                    ├─ Inner Join est. 89656488 rows
                     │                    │  │     Condition: inv_item_sk == i_item_sk
                     │                    │  ├─ Repartition Exchange est. 89656488 rows
                     │                    │  │  │     Partition by: {inv_item_sk}
                     │                    │  │  └─ Inner Join est. 89656488 rows
                     │                    │  │     │     Condition: inv_date_sk == d_date_sk
                     │                    │  │     ├─ Local Exchange est. 783000000 rows
                     │                    │  │     │  └─ Filter est. 783000000 rows
                     │                    │  │     │     │     Dynamic Filters: {inv_date_sk:range}
                     │                    │  │     │     └─ TableScan tpcds.inventory est. 783000000 rows
                     │                    │  │     └─ Projection est. 30 rows
                     │                    │  │        │     Dynamic Filters Builder: {d_date_sk}
                     │                    │  │        └─ Broadcast Exchange est. 30 rows
                     │                    │  │           └─ Filter est. 30 rows
                     │                    │  │              │     (d_year = 2001) AND (d_moy = 1)
                     │                    │  │              └─ TableScan tpcds.date_dim est. 73049 rows
                     │                    │  └─ Repartition Exchange est. 300000 rows
                     │                    │     │     Partition by: {i_item_sk}
                     │                    │     └─ TableScan tpcds.item est. 300000 rows
                     │                    └─ Broadcast Exchange est. 20 rows
                     │                       └─ TableScan tpcds.warehouse est. 20 rows
                     └─ Repartition Exchange est. 75311450 rows
                        │     Partition by: {i_item_sk_1, w_warehouse_sk_1}
                        └─ Projection est. 75311450 rows
                           └─ Filter est. 75311450 rows
                              │     if(`expr#avg(inv_quantity_on_hand)_1` = 0, 0, `expr#stddevSamp(inv_quantity_on_hand)_1` / `expr#avg(inv_quantity_on_hand)_1`) > 1
                              └─ MergingAggregated est. 83679389 rows
                                 └─ Repartition Exchange est. 83679389 rows
                                    │     Partition by: {d_moy_1, i_item_sk_1, w_warehouse_name_1, w_warehouse_sk_1}
                                    └─ Aggregating est. 83679389 rows
                                       │     Group by: {d_moy_1, i_item_sk_1, w_warehouse_name_1, w_warehouse_sk_1}
                                       └─ Inner Join est. 83679389 rows
                                          │     Condition: inv_warehouse_sk_1 == w_warehouse_sk_1
                                          ├─ Inner Join est. 83679389 rows
                                          │  │     Condition: inv_item_sk_1 == i_item_sk_1
                                          │  ├─ Repartition Exchange est. 83679389 rows
                                          │  │  │     Partition by: {inv_item_sk_1}
                                          │  │  └─ Inner Join est. 83679389 rows
                                          │  │     │     Condition: inv_date_sk_1 == d_date_sk_1
                                          │  │     ├─ Local Exchange est. 783000000 rows
                                          │  │     │  └─ Filter est. 783000000 rows
                                          │  │     │     │     Dynamic Filters: {inv_date_sk_1:range}
                                          │  │     │     └─ TableScan tpcds.inventory est. 783000000 rows
                                          │  │     └─ Projection est. 28 rows
                                          │  │        │     Dynamic Filters Builder: {d_date_sk_1}
                                          │  │        └─ Broadcast Exchange est. 28 rows
                                          │  │           └─ Filter est. 28 rows
                                          │  │              │     (d_moy_1 = cast(2, 'UInt16')) AND (d_year_1 = 2001)
                                          │  │              └─ TableScan tpcds.date_dim est. 73049 rows
                                          │  └─ Repartition Exchange est. 300000 rows
                                          │     │     Partition by: {i_item_sk_1}
                                          │     └─ TableScan tpcds.item est. 300000 rows
                                          └─ Broadcast Exchange est. 20 rows
                                             └─ TableScan tpcds.warehouse est. 20 rows
note: Dynamic Filter is applied for 2 times.
Projection est. 22537835082 rows
└─ MergingSorted est. 22537835082 rows
   └─ MergeSorting est. 22537835082 rows
      └─ PartialSorting est. 22537835082 rows
         └─ Gather Exchange est. 22537835082 rows
            └─ MergeSorting est. 22537835082 rows
               └─ PartialSorting est. 22537835082 rows
                  └─ Inner Join est. 22537835082 rows
                     │     Condition: i_item_sk_2 == i_item_sk_3, w_warehouse_sk_2 == w_warehouse_sk_3
                     ├─ Repartition Exchange est. 80690839 rows
                     │  │     Partition by: {i_item_sk_2, w_warehouse_sk_2}
                     │  └─ Projection est. 80690839 rows
                     │     └─ Filter est. 80690839 rows
                     │        │     (if(`expr#avg(inv_quantity_on_hand)_2` = 0, 0, `expr#stddevSamp(inv_quantity_on_hand)_2` / `expr#avg(inv_quantity_on_hand)_2`) > 1) AND (if(`expr#avg(inv_quantity_on_hand)_2` = 0, NULL, `expr#stddevSamp(inv_quantity_on_hand)_2` / `expr#avg(inv_quantity_on_hand)_2`) > 1.5)
                     │        └─ MergingAggregated est. 89656488 rows
                     │           └─ Repartition Exchange est. 89656488 rows
                     │              │     Partition by: {d_moy_2, i_item_sk_2, w_warehouse_name_2, w_warehouse_sk_2}
                     │              └─ Aggregating est. 89656488 rows
                     │                 │     Group by: {d_moy_2, i_item_sk_2, w_warehouse_name_2, w_warehouse_sk_2}
                     │                 └─ Inner Join est. 89656488 rows
                     │                    │     Condition: inv_warehouse_sk_2 == w_warehouse_sk_2
                     │                    ├─ Inner Join est. 89656488 rows
                     │                    │  │     Condition: inv_item_sk_2 == i_item_sk_2
                     │                    │  ├─ Repartition Exchange est. 89656488 rows
                     │                    │  │  │     Partition by: {inv_item_sk_2}
                     │                    │  │  └─ Inner Join est. 89656488 rows
                     │                    │  │     │     Condition: inv_date_sk_2 == d_date_sk_2
                     │                    │  │     ├─ Local Exchange est. 783000000 rows
                     │                    │  │     │  └─ Filter est. 783000000 rows
                     │                    │  │     │     │     Dynamic Filters: {inv_date_sk_2:range}
                     │                    │  │     │     └─ TableScan tpcds.inventory est. 783000000 rows
                     │                    │  │     └─ Projection est. 30 rows
                     │                    │  │        │     Dynamic Filters Builder: {d_date_sk_2}
                     │                    │  │        └─ Broadcast Exchange est. 30 rows
                     │                    │  │           └─ Filter est. 30 rows
                     │                    │  │              │     (d_moy_2 = 1) AND (d_year_2 = 2001)
                     │                    │  │              └─ TableScan tpcds.date_dim est. 73049 rows
                     │                    │  └─ Repartition Exchange est. 300000 rows
                     │                    │     │     Partition by: {i_item_sk_2}
                     │                    │     └─ TableScan tpcds.item est. 300000 rows
                     │                    └─ Broadcast Exchange est. 20 rows
                     │                       └─ TableScan tpcds.warehouse est. 20 rows
                     └─ Repartition Exchange est. 75311450 rows
                        │     Partition by: {i_item_sk_3, w_warehouse_sk_3}
                        └─ Projection est. 75311450 rows
                           └─ Filter est. 75311450 rows
                              │     if(`expr#avg(inv_quantity_on_hand)_3` = 0, 0, `expr#stddevSamp(inv_quantity_on_hand)_3` / `expr#avg(inv_quantity_on_hand)_3`) > 1
                              └─ MergingAggregated est. 83679389 rows
                                 └─ Repartition Exchange est. 83679389 rows
                                    │     Partition by: {d_moy_3, i_item_sk_3, w_warehouse_name_3, w_warehouse_sk_3}
                                    └─ Aggregating est. 83679389 rows
                                       │     Group by: {d_moy_3, i_item_sk_3, w_warehouse_name_3, w_warehouse_sk_3}
                                       └─ Inner Join est. 83679389 rows
                                          │     Condition: inv_warehouse_sk_3 == w_warehouse_sk_3
                                          ├─ Inner Join est. 83679389 rows
                                          │  │     Condition: inv_item_sk_3 == i_item_sk_3
                                          │  ├─ Repartition Exchange est. 83679389 rows
                                          │  │  │     Partition by: {inv_item_sk_3}
                                          │  │  └─ Inner Join est. 83679389 rows
                                          │  │     │     Condition: inv_date_sk_3 == d_date_sk_3
                                          │  │     ├─ Local Exchange est. 783000000 rows
                                          │  │     │  └─ Filter est. 783000000 rows
                                          │  │     │     │     Dynamic Filters: {inv_date_sk_3:range}
                                          │  │     │     └─ TableScan tpcds.inventory est. 783000000 rows
                                          │  │     └─ Projection est. 28 rows
                                          │  │        │     Dynamic Filters Builder: {d_date_sk_3}
                                          │  │        └─ Broadcast Exchange est. 28 rows
                                          │  │           └─ Filter est. 28 rows
                                          │  │              │     (d_moy_3 = cast(2, 'UInt16')) AND (d_year_3 = 2001)
                                          │  │              └─ TableScan tpcds.date_dim est. 73049 rows
                                          │  └─ Repartition Exchange est. 300000 rows
                                          │     │     Partition by: {i_item_sk_3}
                                          │     └─ TableScan tpcds.item est. 300000 rows
                                          └─ Broadcast Exchange est. 20 rows
                                             └─ TableScan tpcds.warehouse est. 20 rows
note: Dynamic Filter is applied for 2 times.
