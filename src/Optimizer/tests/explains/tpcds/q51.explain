Projection est. 100 rows
└─ Limit est. 100 rows
   └─ MergingSorted est. 13209016729 rows
      └─ MergeSorting est. 13209016729 rows
         └─ PartialSorting est. 13209016729 rows
            └─ Gather Exchange est. 13209016729 rows
               └─ MergeSorting est. 13209016729 rows
                  └─ PartialSorting est. 13209016729 rows
                     └─ Filter est. 13209016729 rows
                        │     `expr#max(web_sales) OVER (PARTITION BY item_sk ORDER BY d_date ASC ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)` > `expr#max(store_sales) OVER (PARTITION BY item_sk ORDER BY d_date ASC ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)`
                        └─ Window est. 14676685255 rows
                           └─ Repartition Exchange est. 14676685255 rows
                              │     Partition by: {expr#multiIf(isNotNull(web.item_sk), web.item_sk, store.item_sk)}
                              └─ Projection est. 14676685255 rows
                                 └─ Full Join est. 14676685255 rows
                                    │     Condition: d_date == d_date_1, ws_item_sk == ss_item_sk
                                    ├─ Repartition Exchange est. 66509646 rows
                                    │  │     Partition by: {d_date, ws_item_sk}
                                    │  └─ Window est. 66509646 rows
                                    │     └─ Repartition Exchange est. 66509646 rows
                                    │        │     Partition by: {ws_item_sk}
                                    │        └─ MergingAggregated est. 66509646 rows
                                    │           └─ Repartition Exchange est. 66509646 rows
                                    │              │     Partition by: {d_date, ws_item_sk}
                                    │              └─ Aggregating est. 66509646 rows
                                    │                 │     Group by: {d_date, ws_item_sk}
                                    │                 └─ Inner Join est. 130308009 rows
                                    │                    │     Condition: ws_sold_date_sk == d_date_sk
                                    │                    ├─ Local Exchange est. 720000376 rows
                                    │                    │  └─ Filter est. 720000376 rows
                                    │                    │     │     isNotNull(ws_item_sk)
                                    │                    │     │     Dynamic Filters: {ws_sold_date_sk:range}
                                    │                    │     └─ TableScan tpcds.web_sales est. 720000376 rows
                                    │                    └─ Projection est. 335 rows
                                    │                       │     Dynamic Filters Builder: {d_date_sk}
                                    │                       └─ Broadcast Exchange est. 335 rows
                                    │                          └─ Filter est. 335 rows
                                    │                             │     (d_month_seq <= cast(1211, 'UInt32')) AND (d_month_seq >= 1200)
                                    │                             └─ TableScan tpcds.date_dim est. 73049 rows
                                    └─ Repartition Exchange est. 66509646 rows
                                       │     Partition by: {d_date_1, ss_item_sk}
                                       └─ Window est. 66509646 rows
                                          └─ Repartition Exchange est. 66509646 rows
                                             │     Partition by: {ss_item_sk}
                                             └─ MergingAggregated est. 66509646 rows
                                                └─ Repartition Exchange est. 66509646 rows
                                                   │     Partition by: {d_date_1, ss_item_sk}
                                                   └─ Aggregating est. 66509646 rows
                                                      │     Group by: {d_date_1, ss_item_sk}
                                                      └─ Inner Join est. 521229594 rows
                                                         │     Condition: ss_sold_date_sk == d_date_sk_1
                                                         ├─ Local Exchange est. 2879987999 rows
                                                         │  └─ Filter est. 2879987999 rows
                                                         │     │     isNotNull(ss_item_sk)
                                                         │     │     Dynamic Filters: {ss_sold_date_sk:range}
                                                         │     └─ TableScan tpcds.store_sales est. 2879987999 rows
                                                         └─ Projection est. 335 rows
                                                            │     Dynamic Filters Builder: {d_date_sk_1}
                                                            └─ Broadcast Exchange est. 335 rows
                                                               └─ Filter est. 335 rows
                                                                  │     (d_month_seq_1 >= 1200) AND (d_month_seq_1 <= cast(1211, 'UInt32'))
                                                                  └─ TableScan tpcds.date_dim est. 73049 rows
note: Dynamic Filter is applied for 2 times.
