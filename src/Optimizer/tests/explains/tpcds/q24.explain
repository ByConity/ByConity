Projection Est. 12321 rows
│     Expressions: c_first_name:=c_first_name_1, c_last_name:=c_last_name_1, paid:=`expr#sum(netpaid)`, s_store_name:=s_store_name_1
└─ Sorting Est. 12321 rows
   │     Order by: {c_last_name_1 asc, c_first_name_1 asc, s_store_name_1 asc}
   └─ Gather Exchange Est. 12321 rows
      └─ Sorting Est. 12321 rows
         │     Order by: {c_last_name_1 asc, c_first_name_1 asc, s_store_name_1 asc}
         └─ Inner Join Est. 12321 rows
            │     Condition: 
            │     Filter: `expr#sum(netpaid)` > `expr#multiply('0.05', avg(netpaid))`
            ├─ MergingAggregated Est. 12321 rows
            │  └─ Repartition Exchange Est. 12321 rows
            │     │     Partition by: {c_first_name_1, c_last_name_1, s_store_name_1}
            │     └─ Aggregating Est. 12321 rows
            │        │     Group by: {c_first_name_1, c_last_name_1, s_store_name_1}
            │        │     Aggregates: expr#sum(netpaid):=AggNull(sum)(expr#sum(ss_net_paid)_1)
            │        └─ Projection Est. 12731550 rows
            │           │     Expressions: c_first_name_1:=c_first_name_3, c_last_name_1:=c_last_name_3, expr#sum(ss_net_paid)_1:=`expr#sum(ss_net_paid)_3`, s_store_name_1:=s_store_name_3
            │           └─ MergingAggregated Est. 4422235 rows
            │              └─ Repartition Exchange Est. 4422235 rows
            │                 │     Partition by: {c_first_name_3, c_last_name_3, ca_state_3, i_color_3, i_current_price_3, i_manager_id_3, i_size_3, i_units_3, s_state_3, s_store_name_3}
            │                 └─ Aggregating Est. 4422235 rows
            │                    │     Group by: {c_first_name_3, c_last_name_3, ca_state_3, i_color_3, i_current_price_3, i_manager_id_3, i_size_3, i_units_3, s_state_3, s_store_name_3}
            │                    │     Aggregates: expr#sum(ss_net_paid)_3:=AggNull(sum)(ss_net_paid_1)
            │                    └─ Inner Join Est. 4422235 rows
            │                       │     Condition: sr_item_sk_1 == i_item_sk_1
            │                       ├─ Inner Join Est. 200373678 rows
            │                       │  │     Condition: sr_item_sk_1 == ss_item_sk_1, sr_ticket_number_1 == ss_ticket_number_1
            │                       │  ├─ Repartition Exchange Est. 287999764 rows
            │                       │  │  │     Partition by: {sr_item_sk_1, sr_ticket_number_1}
            │                       │  │  └─ TableScan tpcds.store_returns Est. 287999764 rows
            │                       │  │           Outputs: sr_item_sk_1:=sr_item_sk, sr_ticket_number_1:=sr_ticket_number
            │                       │  └─ Repartition Exchange Est. 120060946 rows
            │                       │     │     Partition by: {ss_item_sk_1, ss_ticket_number_1}
            │                       │     └─ Inner Join Est. 120060946 rows
            │                       │        │     Condition: ss_customer_sk_1 == c_customer_sk_1, ss_store_sk_1 == s_store_sk_1
            │                       │        ├─ Repartition Exchange Est. 2879987999 rows
            │                       │        │  │     Partition by: {ss_customer_sk_1, ss_store_sk_1}
            │                       │        │  └─ TableScan tpcds.store_sales Est. 2879987999 rows
            │                       │        │           Outputs: ss_customer_sk_1:=ss_customer_sk, ss_item_sk_1:=ss_item_sk, ss_net_paid_1:=ss_net_paid, ss_store_sk_1:=ss_store_sk, ss_ticket_number_1:=ss_ticket_number
            │                       │        └─ Repartition Exchange Est. 507363 rows
            │                       │           │     Partition by: {c_customer_sk_1, s_store_sk_1}
            │                       │           └─ Inner Join Est. 507363 rows
            │                       │              │     Condition: c_current_addr_sk_1 == ca_address_sk_1
            │                       │              │     Filter: c_birth_country_1 != upper(ca_country_1)
            │                       │              ├─ Repartition Exchange Est. 12000000 rows
            │                       │              │  │     Partition by: {c_current_addr_sk_1}
            │                       │              │  └─ TableScan tpcds.customer Est. 12000000 rows
            │                       │              │           Outputs: c_birth_country_1:=c_birth_country, c_current_addr_sk_1:=c_current_addr_sk, c_customer_sk_1:=c_customer_sk, c_first_name_3:=c_first_name, c_last_name_3:=c_last_name
            │                       │              └─ Repartition Exchange Est. 222816 rows
            │                       │                 │     Partition by: {ca_address_sk_1}
            │                       │                 └─ Inner Join Est. 222816 rows
            │                       │                    │     Condition: ca_zip_1 == s_zip_1
            │                       │                    ├─ TableScan tpcds.customer_address Est. 6000000 rows
            │                       │                    │        Outputs: ca_address_sk_1:=ca_address_sk, ca_country_1:=ca_country, ca_state_3:=ca_state, ca_zip_1:=ca_zip
            │                       │                    └─ Broadcast Exchange Est. 84 rows
            │                       │                       └─ Filter Est. 84 rows
            │                       │                          │     Condition: s_market_id_1 = 8
            │                       │                          └─ TableScan tpcds.store Est. 1002 rows
            │                       │                                   Condition : s_market_id = 8.
            │                       │                                   Outputs: s_market_id_1:=s_market_id, s_state_3:=s_state, s_store_name_3:=s_store_name, s_store_sk_1:=s_store_sk, s_zip_1:=s_zip
            │                       └─ Broadcast Exchange Est. 6621 rows
            │                          └─ Filter Est. 6621 rows
            │                             │     Condition: i_color_3 = 'peach'
            │                             └─ TableScan tpcds.item Est. 300000 rows
            │                                      Condition : i_color = 'peach'.
            │                                      Outputs: i_color_3:=i_color, i_current_price_3:=i_current_price, i_item_sk_1:=i_item_sk, i_manager_id_3:=i_manager_id, i_size_3:=i_size, i_units_3:=i_units
            └─ Broadcast Exchange Est. 1 rows
               └─ Projection Est. 1 rows
                  │     Expressions: expr#multiply('0.05', avg(netpaid)):='0.05' * `expr#avg(netpaid)`
                  └─ MergingAggregated Est. 1 rows
                     └─ Gather Exchange Est. 1 rows
                        └─ Aggregating Est. 1 rows
                           │     Group by: {}
                           │     Aggregates: expr#avg(netpaid):=AggNull(avg)(expr#sum(ss_net_paid)_2)
                           └─ Projection Est. 200373678 rows
                              │     Expressions: expr#sum(ss_net_paid)_2:=`expr#sum(ss_net_paid)_4`
                              └─ MergingAggregated Est. 200373678 rows
                                 └─ Repartition Exchange Est. 200373678 rows
                                    │     Partition by: {c_first_name_4, c_last_name_4, ca_state_4, i_color_4, i_current_price_4, i_manager_id_4, i_size_4, i_units_4, s_state_4, s_store_name_4}
                                    └─ Aggregating Est. 200373678 rows
                                       │     Group by: {c_first_name_4, c_last_name_4, ca_state_4, i_color_4, i_current_price_4, i_manager_id_4, i_size_4, i_units_4, s_state_4, s_store_name_4}
                                       │     Aggregates: expr#sum(ss_net_paid)_4:=AggNull(sum)(ss_net_paid_2)
                                       └─ Inner Join Est. 200373678 rows
                                          │     Condition: sr_item_sk_2 == i_item_sk_2
                                          ├─ Repartition Exchange Est. 200373678 rows
                                          │  │     Partition by: {sr_item_sk_2}
                                          │  └─ Inner Join Est. 200373678 rows
                                          │     │     Condition: sr_item_sk_2 == ss_item_sk_2, sr_ticket_number_2 == ss_ticket_number_2
                                          │     ├─ Repartition Exchange Est. 287999764 rows
                                          │     │  │     Partition by: {sr_item_sk_2, sr_ticket_number_2}
                                          │     │  └─ TableScan tpcds.store_returns Est. 287999764 rows
                                          │     │           Outputs: sr_item_sk_2:=sr_item_sk, sr_ticket_number_2:=sr_ticket_number
                                          │     └─ Repartition Exchange Est. 120060946 rows
                                          │        │     Partition by: {ss_item_sk_2, ss_ticket_number_2}
                                          │        └─ Inner Join Est. 120060946 rows
                                          │           │     Condition: ss_customer_sk_2 == c_customer_sk_2, ss_store_sk_2 == s_store_sk_2
                                          │           ├─ Repartition Exchange Est. 2879987999 rows
                                          │           │  │     Partition by: {ss_customer_sk_2, ss_store_sk_2}
                                          │           │  └─ TableScan tpcds.store_sales Est. 2879987999 rows
                                          │           │           Outputs: ss_customer_sk_2:=ss_customer_sk, ss_item_sk_2:=ss_item_sk, ss_net_paid_2:=ss_net_paid, ss_store_sk_2:=ss_store_sk, ss_ticket_number_2:=ss_ticket_number
                                          │           └─ Repartition Exchange Est. 507363 rows
                                          │              │     Partition by: {c_customer_sk_2, s_store_sk_2}
                                          │              └─ Inner Join Est. 507363 rows
                                          │                 │     Condition: c_current_addr_sk_2 == ca_address_sk_2
                                          │                 │     Filter: c_birth_country_2 != upper(ca_country_2)
                                          │                 ├─ Repartition Exchange Est. 12000000 rows
                                          │                 │  │     Partition by: {c_current_addr_sk_2}
                                          │                 │  └─ TableScan tpcds.customer Est. 12000000 rows
                                          │                 │           Outputs: c_birth_country_2:=c_birth_country, c_current_addr_sk_2:=c_current_addr_sk, c_customer_sk_2:=c_customer_sk, c_first_name_4:=c_first_name, c_last_name_4:=c_last_name
                                          │                 └─ Repartition Exchange Est. 222816 rows
                                          │                    │     Partition by: {ca_address_sk_2}
                                          │                    └─ Inner Join Est. 222816 rows
                                          │                       │     Condition: ca_zip_2 == s_zip_2
                                          │                       ├─ TableScan tpcds.customer_address Est. 6000000 rows
                                          │                       │        Outputs: ca_address_sk_2:=ca_address_sk, ca_country_2:=ca_country, ca_state_4:=ca_state, ca_zip_2:=ca_zip
                                          │                       └─ Broadcast Exchange Est. 84 rows
                                          │                          └─ Projection Est. 84 rows
                                          │                             │     Expressions: [s_state_4, s_store_name_4, s_store_sk_2, s_zip_2]
                                          │                             └─ Filter Est. 84 rows
                                          │                                │     Condition: s_market_id_2 = 8
                                          │                                └─ TableScan tpcds.store Est. 1002 rows
                                          │                                         Condition : s_market_id = 8.
                                          │                                         Outputs: s_market_id_2:=s_market_id, s_state_4:=s_state, s_store_name_4:=s_store_name, s_store_sk_2:=s_store_sk, s_zip_2:=s_zip
                                          └─ Repartition Exchange Est. 300000 rows
                                             │     Partition by: {i_item_sk_2}
                                             └─ TableScan tpcds.item Est. 300000 rows
                                                      Outputs: i_color_4:=i_color, i_current_price_4:=i_current_price, i_item_sk_2:=i_item_sk, i_manager_id_4:=i_manager_id, i_size_4:=i_size, i_units_4:=i_units
Projection Est. 12432 rows
│     Expressions: c_first_name:=c_first_name_6, c_last_name:=c_last_name_6, paid:=`expr#sum(netpaid)_1`, s_store_name:=s_store_name_6
└─ Sorting Est. 12432 rows
   │     Order by: {c_last_name_6 asc, c_first_name_6 asc, s_store_name_6 asc}
   └─ Gather Exchange Est. 12432 rows
      └─ Sorting Est. 12432 rows
         │     Order by: {c_last_name_6 asc, c_first_name_6 asc, s_store_name_6 asc}
         └─ Inner Join Est. 12432 rows
            │     Condition: 
            │     Filter: `expr#sum(netpaid)_1` > `expr#multiply('0.05', avg(netpaid))_1`
            ├─ MergingAggregated Est. 12432 rows
            │  └─ Repartition Exchange Est. 12432 rows
            │     │     Partition by: {c_first_name_6, c_last_name_6, s_store_name_6}
            │     └─ Aggregating Est. 12432 rows
            │        │     Group by: {c_first_name_6, c_last_name_6, s_store_name_6}
            │        │     Aggregates: expr#sum(netpaid)_1:=AggNull(sum)(expr#sum(ss_net_paid)_6)
            │        └─ Projection Est. 12779746 rows
            │           │     Expressions: c_first_name_6:=c_first_name_8, c_last_name_6:=c_last_name_8, expr#sum(ss_net_paid)_6:=`expr#sum(ss_net_paid)_8`, s_store_name_6:=s_store_name_8
            │           └─ MergingAggregated Est. 4438955 rows
            │              └─ Repartition Exchange Est. 4438955 rows
            │                 │     Partition by: {c_first_name_8, c_last_name_8, ca_state_8, i_color_8, i_current_price_8, i_manager_id_8, i_size_8, i_units_8, s_state_8, s_store_name_8}
            │                 └─ Aggregating Est. 4438955 rows
            │                    │     Group by: {c_first_name_8, c_last_name_8, ca_state_8, i_color_8, i_current_price_8, i_manager_id_8, i_size_8, i_units_8, s_state_8, s_store_name_8}
            │                    │     Aggregates: expr#sum(ss_net_paid)_8:=AggNull(sum)(ss_net_paid_4)
            │                    └─ Inner Join Est. 4438955 rows
            │                       │     Condition: sr_item_sk_4 == i_item_sk_4
            │                       ├─ Inner Join Est. 200373678 rows
            │                       │  │     Condition: sr_item_sk_4 == ss_item_sk_4, sr_ticket_number_4 == ss_ticket_number_4
            │                       │  ├─ Repartition Exchange Est. 287999764 rows
            │                       │  │  │     Partition by: {sr_item_sk_4, sr_ticket_number_4}
            │                       │  │  └─ TableScan tpcds.store_returns Est. 287999764 rows
            │                       │  │           Outputs: sr_item_sk_4:=sr_item_sk, sr_ticket_number_4:=sr_ticket_number
            │                       │  └─ Repartition Exchange Est. 120060946 rows
            │                       │     │     Partition by: {ss_item_sk_4, ss_ticket_number_4}
            │                       │     └─ Inner Join Est. 120060946 rows
            │                       │        │     Condition: ss_customer_sk_4 == c_customer_sk_4, ss_store_sk_4 == s_store_sk_4
            │                       │        ├─ Repartition Exchange Est. 2879987999 rows
            │                       │        │  │     Partition by: {ss_customer_sk_4, ss_store_sk_4}
            │                       │        │  └─ TableScan tpcds.store_sales Est. 2879987999 rows
            │                       │        │           Outputs: ss_customer_sk_4:=ss_customer_sk, ss_item_sk_4:=ss_item_sk, ss_net_paid_4:=ss_net_paid, ss_store_sk_4:=ss_store_sk, ss_ticket_number_4:=ss_ticket_number
            │                       │        └─ Repartition Exchange Est. 507363 rows
            │                       │           │     Partition by: {c_customer_sk_4, s_store_sk_4}
            │                       │           └─ Inner Join Est. 507363 rows
            │                       │              │     Condition: c_current_addr_sk_4 == ca_address_sk_4
            │                       │              │     Filter: c_birth_country_4 != upper(ca_country_4)
            │                       │              ├─ Repartition Exchange Est. 12000000 rows
            │                       │              │  │     Partition by: {c_current_addr_sk_4}
            │                       │              │  └─ TableScan tpcds.customer Est. 12000000 rows
            │                       │              │           Outputs: c_birth_country_4:=c_birth_country, c_current_addr_sk_4:=c_current_addr_sk, c_customer_sk_4:=c_customer_sk, c_first_name_8:=c_first_name, c_last_name_8:=c_last_name
            │                       │              └─ Repartition Exchange Est. 222816 rows
            │                       │                 │     Partition by: {ca_address_sk_4}
            │                       │                 └─ Inner Join Est. 222816 rows
            │                       │                    │     Condition: ca_zip_4 == s_zip_4
            │                       │                    ├─ TableScan tpcds.customer_address Est. 6000000 rows
            │                       │                    │        Outputs: ca_address_sk_4:=ca_address_sk, ca_country_4:=ca_country, ca_state_8:=ca_state, ca_zip_4:=ca_zip
            │                       │                    └─ Broadcast Exchange Est. 84 rows
            │                       │                       └─ Filter Est. 84 rows
            │                       │                          │     Condition: s_market_id_4 = 8
            │                       │                          └─ TableScan tpcds.store Est. 1002 rows
            │                       │                                   Condition : s_market_id = 8.
            │                       │                                   Outputs: s_market_id_4:=s_market_id, s_state_8:=s_state, s_store_name_8:=s_store_name, s_store_sk_4:=s_store_sk, s_zip_4:=s_zip
            │                       └─ Broadcast Exchange Est. 6646 rows
            │                          └─ Filter Est. 6646 rows
            │                             │     Condition: i_color_8 = 'saddle'
            │                             └─ TableScan tpcds.item Est. 300000 rows
            │                                      Condition : i_color = 'saddle'.
            │                                      Outputs: i_color_8:=i_color, i_current_price_8:=i_current_price, i_item_sk_4:=i_item_sk, i_manager_id_8:=i_manager_id, i_size_8:=i_size, i_units_8:=i_units
            └─ Broadcast Exchange Est. 1 rows
               └─ Projection Est. 1 rows
                  │     Expressions: expr#multiply('0.05', avg(netpaid))_1:='0.05' * `expr#avg(netpaid)_1`
                  └─ MergingAggregated Est. 1 rows
                     └─ Gather Exchange Est. 1 rows
                        └─ Aggregating Est. 1 rows
                           │     Group by: {}
                           │     Aggregates: expr#avg(netpaid)_1:=AggNull(avg)(expr#sum(ss_net_paid)_7)
                           └─ Projection Est. 200373678 rows
                              │     Expressions: expr#sum(ss_net_paid)_7:=`expr#sum(ss_net_paid)_9`
                              └─ MergingAggregated Est. 200373678 rows
                                 └─ Repartition Exchange Est. 200373678 rows
                                    │     Partition by: {c_first_name_9, c_last_name_9, ca_state_9, i_color_9, i_current_price_9, i_manager_id_9, i_size_9, i_units_9, s_state_9, s_store_name_9}
                                    └─ Aggregating Est. 200373678 rows
                                       │     Group by: {c_first_name_9, c_last_name_9, ca_state_9, i_color_9, i_current_price_9, i_manager_id_9, i_size_9, i_units_9, s_state_9, s_store_name_9}
                                       │     Aggregates: expr#sum(ss_net_paid)_9:=AggNull(sum)(ss_net_paid_5)
                                       └─ Inner Join Est. 200373678 rows
                                          │     Condition: sr_item_sk_5 == i_item_sk_5
                                          ├─ Repartition Exchange Est. 200373678 rows
                                          │  │     Partition by: {sr_item_sk_5}
                                          │  └─ Inner Join Est. 200373678 rows
                                          │     │     Condition: sr_item_sk_5 == ss_item_sk_5, sr_ticket_number_5 == ss_ticket_number_5
                                          │     ├─ Repartition Exchange Est. 287999764 rows
                                          │     │  │     Partition by: {sr_item_sk_5, sr_ticket_number_5}
                                          │     │  └─ TableScan tpcds.store_returns Est. 287999764 rows
                                          │     │           Outputs: sr_item_sk_5:=sr_item_sk, sr_ticket_number_5:=sr_ticket_number
                                          │     └─ Repartition Exchange Est. 120060946 rows
                                          │        │     Partition by: {ss_item_sk_5, ss_ticket_number_5}
                                          │        └─ Inner Join Est. 120060946 rows
                                          │           │     Condition: ss_customer_sk_5 == c_customer_sk_5, ss_store_sk_5 == s_store_sk_5
                                          │           ├─ Repartition Exchange Est. 2879987999 rows
                                          │           │  │     Partition by: {ss_customer_sk_5, ss_store_sk_5}
                                          │           │  └─ TableScan tpcds.store_sales Est. 2879987999 rows
                                          │           │           Outputs: ss_customer_sk_5:=ss_customer_sk, ss_item_sk_5:=ss_item_sk, ss_net_paid_5:=ss_net_paid, ss_store_sk_5:=ss_store_sk, ss_ticket_number_5:=ss_ticket_number
                                          │           └─ Repartition Exchange Est. 507363 rows
                                          │              │     Partition by: {c_customer_sk_5, s_store_sk_5}
                                          │              └─ Inner Join Est. 507363 rows
                                          │                 │     Condition: c_current_addr_sk_5 == ca_address_sk_5
                                          │                 │     Filter: c_birth_country_5 != upper(ca_country_5)
                                          │                 ├─ Repartition Exchange Est. 12000000 rows
                                          │                 │  │     Partition by: {c_current_addr_sk_5}
                                          │                 │  └─ TableScan tpcds.customer Est. 12000000 rows
                                          │                 │           Outputs: c_birth_country_5:=c_birth_country, c_current_addr_sk_5:=c_current_addr_sk, c_customer_sk_5:=c_customer_sk, c_first_name_9:=c_first_name, c_last_name_9:=c_last_name
                                          │                 └─ Repartition Exchange Est. 222816 rows
                                          │                    │     Partition by: {ca_address_sk_5}
                                          │                    └─ Inner Join Est. 222816 rows
                                          │                       │     Condition: ca_zip_5 == s_zip_5
                                          │                       ├─ TableScan tpcds.customer_address Est. 6000000 rows
                                          │                       │        Outputs: ca_address_sk_5:=ca_address_sk, ca_country_5:=ca_country, ca_state_9:=ca_state, ca_zip_5:=ca_zip
                                          │                       └─ Broadcast Exchange Est. 84 rows
                                          │                          └─ Projection Est. 84 rows
                                          │                             │     Expressions: [s_state_9, s_store_name_9, s_store_sk_5, s_zip_5]
                                          │                             └─ Filter Est. 84 rows
                                          │                                │     Condition: s_market_id_5 = 8
                                          │                                └─ TableScan tpcds.store Est. 1002 rows
                                          │                                         Condition : s_market_id = 8.
                                          │                                         Outputs: s_market_id_5:=s_market_id, s_state_9:=s_state, s_store_name_9:=s_store_name, s_store_sk_5:=s_store_sk, s_zip_5:=s_zip
                                          └─ Repartition Exchange Est. 300000 rows
                                             │     Partition by: {i_item_sk_5}
                                             └─ TableScan tpcds.item Est. 300000 rows
                                                      Outputs: i_color_9:=i_color, i_current_price_9:=i_current_price, i_item_sk_5:=i_item_sk, i_manager_id_9:=i_manager_id, i_size_9:=i_size, i_units_9:=i_units
