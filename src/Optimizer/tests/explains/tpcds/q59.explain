Projection est. 100 rows
└─ Limit est. 100 rows
   └─ MergingSorted est. 50475623 rows
      └─ MergeSorting est. 50475623 rows
         └─ PartialSorting est. 50475623 rows
            └─ Gather Exchange est. 50475623 rows
               └─ MergeSorting est. 50475623 rows
                  └─ PartialSorting est. 50475623 rows
                     └─ Projection est. 50475623 rows
                        └─ Inner Join est. 50475623 rows
                           │     Condition: minus(d_week_seq_2, 52) == d_week_seq, s_store_id_1 == s_store_id
                           ├─ Repartition Exchange est. 168483 rows
                           │  │     Partition by: {minus(d_week_seq_2, 52), s_store_id_1}
                           │  └─ Projection est. 168483 rows
                           │     └─ Inner Join est. 168144 rows
                           │        │     Condition: ss_store_sk_1 == s_store_sk_1
                           │        ├─ Inner Join est. 168144 rows
                           │        │  │     Condition: d_week_seq_2 == d_week_seq_3
                           │        │  ├─ Repartition Exchange est. 23808 rows
                           │        │  │  │     Partition by: {d_week_seq_2}
                           │        │  │  └─ MergingAggregated est. 23808 rows
                           │        │  │     └─ Repartition Exchange est. 23808 rows
                           │        │  │        │     Partition by: {d_week_seq_2, ss_store_sk_1}
                           │        │  │        └─ Aggregating est. 23808 rows
                           │        │  │           │     Group by: {d_week_seq_2, ss_store_sk_1}
                           │        │  │           └─ Projection est. 13280759 rows
                           │        │  │              └─ Inner Join est. 522785503 rows
                           │        │  │                 │     Condition: ss_sold_date_sk_1 == d_date_sk_2
                           │        │  │                 ├─ Local Exchange est. 2879987999 rows
                           │        │  │                 │  └─ Filter est. 2879987999 rows
                           │        │  │                 │     │     Dynamic Filters: {ss_sold_date_sk_1:range}
                           │        │  │                 │     └─ TableScan tpcds.store_sales est. 2879987999 rows
                           │        │  │                 └─ Projection est. 336 rows
                           │        │  │                    │     Dynamic Filters Builder: {d_date_sk_2}
                           │        │  │                    └─ Broadcast Exchange est. 336 rows
                           │        │  │                       └─ Inner Join est. 336 rows
                           │        │  │                          │     Condition: d_week_seq_2 == d_week_seq_5
                           │        │  │                          ├─ TableScan tpcds.date_dim est. 73049 rows
                           │        │  │                          └─ Broadcast Exchange est. 48 rows
                           │        │  │                             └─ MergingAggregated est. 48 rows
                           │        │  │                                └─ Repartition Exchange est. 48 rows
                           │        │  │                                   │     Partition by: {d_week_seq_5}
                           │        │  │                                   └─ Aggregating est. 48 rows
                           │        │  │                                      │     Group by: {d_week_seq_5}
                           │        │  │                                      └─ Projection est. 339 rows
                           │        │  │                                         └─ Filter est. 339 rows
                           │        │  │                                            │     (d_month_seq_3 >= cast(1224, 'UInt32')) AND (d_month_seq_3 <= cast(1235, 'UInt32'))
                           │        │  │                                            └─ TableScan tpcds.date_dim est. 73049 rows
                           │        │  └─ Repartition Exchange est. 339 rows
                           │        │     │     Partition by: {d_week_seq_3}
                           │        │     └─ Filter est. 339 rows
                           │        │        │     (d_month_seq_3 >= cast(1224, 'UInt32')) AND (d_month_seq_3 <= cast(1235, 'UInt32'))
                           │        │        └─ TableScan tpcds.date_dim est. 73049 rows
                           │        └─ Broadcast Exchange est. 1002 rows
                           │           └─ TableScan tpcds.store est. 1002 rows
                           └─ Repartition Exchange est. 150094 rows
                              │     Partition by: {d_week_seq, s_store_id}
                              └─ Inner Join est. 149792 rows
                                 │     Condition: ss_store_sk == s_store_sk
                                 ├─ Inner Join est. 149792 rows
                                 │  │     Condition: d_week_seq == d_week_seq_1
                                 │  ├─ Repartition Exchange est. 21328 rows
                                 │  │  │     Partition by: {d_week_seq}
                                 │  │  └─ MergingAggregated est. 21328 rows
                                 │  │     └─ Repartition Exchange est. 21328 rows
                                 │  │        │     Partition by: {d_week_seq, ss_store_sk}
                                 │  │        └─ Aggregating est. 21328 rows
                                 │  │           │     Group by: {d_week_seq, ss_store_sk}
                                 │  │           └─ Projection est. 11897346 rows
                                 │  │              └─ Inner Join est. 468328680 rows
                                 │  │                 │     Condition: ss_sold_date_sk == d_date_sk
                                 │  │                 ├─ Local Exchange est. 2879987999 rows
                                 │  │                 │  └─ Filter est. 2879987999 rows
                                 │  │                 │     │     Dynamic Filters: {ss_sold_date_sk:range}
                                 │  │                 │     └─ TableScan tpcds.store_sales est. 2879987999 rows
                                 │  │                 └─ Projection est. 301 rows
                                 │  │                    │     Dynamic Filters Builder: {d_date_sk}
                                 │  │                    └─ Broadcast Exchange est. 301 rows
                                 │  │                       └─ Inner Join est. 301 rows
                                 │  │                          │     Condition: d_week_seq == d_week_seq_4
                                 │  │                          ├─ TableScan tpcds.date_dim est. 73049 rows
                                 │  │                          └─ Broadcast Exchange est. 43 rows
                                 │  │                             └─ MergingAggregated est. 43 rows
                                 │  │                                └─ Repartition Exchange est. 43 rows
                                 │  │                                   │     Partition by: {d_week_seq_4}
                                 │  │                                   └─ Aggregating est. 43 rows
                                 │  │                                      │     Group by: {d_week_seq_4}
                                 │  │                                      └─ Projection est. 302 rows
                                 │  │                                         └─ Filter est. 302 rows
                                 │  │                                            │     (d_month_seq_1 <= cast(1223, 'UInt32')) AND (d_month_seq_1 >= 1212)
                                 │  │                                            └─ TableScan tpcds.date_dim est. 73049 rows
                                 │  └─ Repartition Exchange est. 302 rows
                                 │     │     Partition by: {d_week_seq_1}
                                 │     └─ Filter est. 302 rows
                                 │        │     (d_month_seq_1 <= cast(1223, 'UInt32')) AND (d_month_seq_1 >= 1212)
                                 │        └─ TableScan tpcds.date_dim est. 73049 rows
                                 └─ Broadcast Exchange est. 1002 rows
                                    └─ TableScan tpcds.store est. 1002 rows
note: Magic Set is applied for 2 parts.
note: Dynamic Filter is applied for 2 times.
