Projection est. 100 rows
└─ Limit est. 100 rows
   └─ MergingSorted est. 4196808 rows
      └─ MergeSorting est. 4196808 rows
         └─ PartialSorting est. 4196808 rows
            └─ Gather Exchange est. 4196808 rows
               └─ MergeSorting est. 4196808 rows
                  └─ PartialSorting est. 4196808 rows
                     └─ Inner Join est. 1893016 rows
                        │     Condition: c_customer_sk == sr_customer_sk
                        ├─ Repartition Exchange est. 12000000 rows
                        │  │     Partition by: {c_customer_sk}
                        │  └─ TableScan tpcds.customer est. 12000000 rows
                        └─ Repartition Exchange est. 1948518 rows
                           │     Partition by: {sr_customer_sk}
                           └─ Inner Join est. 1948518 rows
                              │     Condition: sr_store_sk == s_store_sk
                              │     Filter: `expr#sum(sr_return_amt)` > (`expr#avg(ctr_total_return)` * 1.2)
                              ├─ MergingAggregated est. 4319858 rows
                              │  └─ Repartition Exchange est. 4319858 rows
                              │     │     Partition by: {sr_customer_sk, sr_store_sk}
                              │     └─ Aggregating est. 4319858 rows
                              │        │     Group by: {sr_customer_sk, sr_store_sk}
                              │        └─ Inner Join est. 4319858 rows
                              │           │     Condition: sr_returned_date_sk == d_date_sk
                              │           ├─ Inner Join est. 23806432 rows
                              │           │  │     Condition: sr_store_sk == s_store_sk_1
                              │           │  ├─ Local Exchange est. 287999764 rows
                              │           │  │  └─ Filter est. 287999764 rows
                              │           │  │     │     Dynamic Filters: {sr_returned_date_sk:range,sr_store_sk:bloomfilter,sr_store_sk:range,sr_store_sk:range}
                              │           │  │     └─ TableScan tpcds.store_returns est. 287999764 rows
                              │           │  └─ Projection est. 41 rows
                              │           │     │     Dynamic Filters Builder: {s_store_sk_1}
                              │           │     └─ Broadcast Exchange est. 41 rows
                              │           │        └─ MergingAggregated est. 41 rows
                              │           │           └─ Repartition Exchange est. 41 rows
                              │           │              │     Partition by: {s_store_sk_1}
                              │           │              └─ Aggregating est. 41 rows
                              │           │                 │     Group by: {s_store_sk_1}
                              │           │                 └─ Projection est. 41 rows
                              │           │                    └─ Filter est. 41 rows
                              │           │                       │     s_state = 'TN'
                              │           │                       └─ TableScan tpcds.store est. 1002 rows
                              │           └─ Projection est. 366 rows
                              │              │     Dynamic Filters Builder: {d_date_sk}
                              │              └─ Broadcast Exchange est. 366 rows
                              │                 └─ Filter est. 366 rows
                              │                    │     d_year = 2000
                              │                    └─ TableScan tpcds.date_dim est. 73049 rows
                              └─ Broadcast Exchange est. 48 rows
                                 └─ Inner Join est. 42 rows
                                    │     Condition: sr_store_sk_1 == s_store_sk
                                    ├─ MergingAggregated est. 41 rows
                                    │  └─ Repartition Exchange est. 41 rows
                                    │     │     Partition by: {sr_store_sk_1}
                                    │     └─ Aggregating est. 41 rows
                                    │        │     Group by: {sr_store_sk_1}
                                    │        └─ Projection est. 4319858 rows
                                    │           └─ MergingAggregated est. 4319858 rows
                                    │              └─ Repartition Exchange est. 4319858 rows
                                    │                 │     Partition by: {sr_customer_sk_1, sr_store_sk_1}
                                    │                 └─ Aggregating est. 4319858 rows
                                    │                    │     Group by: {sr_customer_sk_1, sr_store_sk_1}
                                    │                    └─ Inner Join est. 4319858 rows
                                    │                       │     Condition: sr_returned_date_sk_1 == d_date_sk_1
                                    │                       ├─ Inner Join est. 23806432 rows
                                    │                       │  │     Condition: sr_store_sk_1 == s_store_sk_2
                                    │                       │  ├─ Local Exchange est. 287999764 rows
                                    │                       │  │  └─ Filter est. 287999764 rows
                                    │                       │  │     │     Dynamic Filters: {sr_returned_date_sk_1:range,sr_store_sk_1:bloomfilter,sr_store_sk_1:range,sr_store_sk_1:range}
                                    │                       │  │     └─ TableScan tpcds.store_returns est. 287999764 rows
                                    │                       │  └─ Projection est. 41 rows
                                    │                       │     │     Dynamic Filters Builder: {s_store_sk_2}
                                    │                       │     └─ Broadcast Exchange est. 41 rows
                                    │                       │        └─ MergingAggregated est. 41 rows
                                    │                       │           └─ Repartition Exchange est. 41 rows
                                    │                       │              │     Partition by: {s_store_sk_2}
                                    │                       │              └─ Aggregating est. 41 rows
                                    │                       │                 │     Group by: {s_store_sk_2}
                                    │                       │                 └─ Projection est. 41 rows
                                    │                       │                    └─ Filter est. 41 rows
                                    │                       │                       │     s_state = 'TN'
                                    │                       │                       └─ TableScan tpcds.store est. 1002 rows
                                    │                       └─ Projection est. 366 rows
                                    │                          │     Dynamic Filters Builder: {d_date_sk_1}
                                    │                          └─ Broadcast Exchange est. 366 rows
                                    │                             └─ Filter est. 366 rows
                                    │                                │     d_year_1 = 2000
                                    │                                └─ TableScan tpcds.date_dim est. 73049 rows
                                    └─ Projection est. 41 rows
                                       │     Dynamic Filters Builder: {s_store_sk}
                                       └─ Repartition Exchange est. 41 rows
                                          │     Partition by: {s_store_sk}
                                          └─ Filter est. 41 rows
                                             │     s_state = 'TN'
                                             └─ TableScan tpcds.store est. 1002 rows
note: Magic Set is applied for 2 parts.
note: Dynamic Filter is applied for 8 times.
